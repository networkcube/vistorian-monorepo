var be=new Date,Oe=new Date;function Z(n,e,t,i){function r(s){return n(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=function(s){return n(s=new Date(+s)),s},r.ceil=function(s){return n(s=new Date(s-1)),e(s,1),n(s),s},r.round=function(s){var c=r(s),h=r.ceil(s);return s-c<h-s?c:h},r.offset=function(s,c){return e(s=new Date(+s),c==null?1:Math.floor(c)),s},r.range=function(s,c,h){var o=[],f;if(s=r.ceil(s),h=h==null?1:Math.floor(h),!(s<c)||!(h>0))return o;do o.push(f=new Date(+s)),e(s,h),n(s);while(f<s&&s<c);return o},r.filter=function(s){return Z(function(c){if(c>=c)for(;n(c),!s(c);)c.setTime(c-1)},function(c,h){if(c>=c)if(h<0)for(;++h<=0;)for(;e(c,-1),!s(c););else for(;--h>=0;)for(;e(c,1),!s(c););})},t&&(r.count=function(s,c){return be.setTime(+s),Oe.setTime(+c),n(be),n(Oe),Math.floor(t(be,Oe))},r.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?function(c){return i(c)%s===0}:function(c){return r.count(0,c)%s===0}):r}),r}const Et=1e3,Le=Et*60,Nt=Le*60,We=Nt*24,nt=We*7;var rt=Z(n=>n.setHours(0,0,0,0),(n,e)=>n.setDate(n.getDate()+e),(n,e)=>(e-n-(e.getTimezoneOffset()-n.getTimezoneOffset())*Le)/We,n=>n.getDate()-1);const st=rt;rt.range;function $(n){return Z(function(e){e.setDate(e.getDate()-(e.getDay()+7-n)%7),e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t*7)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Le)/nt})}var ot=$(0),Se=$(1),Ct=$(2),Lt=$(3),ne=$(4),Wt=$(5),Yt=$(6);ot.range;Se.range;Ct.range;Lt.range;ne.range;Wt.range;Yt.range;var Ye=Z(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e)},function(n,e){return e.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});Ye.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:Z(function(e){e.setFullYear(Math.floor(e.getFullYear()/n)*n),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t*n)})};const ue=Ye;Ye.range;var ht=Z(function(n){n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCDate(n.getUTCDate()+e)},function(n,e){return(e-n)/We},function(n){return n.getUTCDate()-1});const lt=ht;ht.range;function Q(n){return Z(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-n)%7),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t*7)},function(e,t){return(t-e)/nt})}var at=Q(0),ve=Q(1),Rt=Q(2),Ht=Q(3),re=Q(4),Gt=Q(5),zt=Q(6);at.range;ve.range;Rt.range;Ht.range;re.range;Gt.range;zt.range;var Re=Z(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e)},function(n,e){return e.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});Re.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:Z(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/n)*n),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t*n)})};const fe=Re;Re.range;function Me(n){if(0<=n.y&&n.y<100){var e=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return e.setFullYear(n.y),e}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function De(n){if(0<=n.y&&n.y<100){var e=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function se(n,e,t){return{y:n,m:e,d:t,H:0,M:0,S:0,L:0}}function jt(n){var e=n.dateTime,t=n.date,i=n.time,r=n.periods,s=n.days,c=n.shortDays,h=n.months,o=n.shortMonths,f=oe(r),p=he(r),m=oe(s),g=he(s),S=oe(c),E=he(c),F=oe(h),v=he(h),w=oe(o),I=he(o),x={a:St,A:vt,b:wt,B:xt,c:null,d:Je,e:Je,f:gi,g:vi,G:xi,H:ci,I:ui,j:fi,L:ct,m:di,M:mi,p:bt,q:Ot,Q:$e,s:Qe,S:yi,u:pi,U:Ai,V:_i,w:Ti,W:ki,x:null,X:null,y:Si,Y:wi,Z:bi,"%":Ve},T={a:Mt,A:Dt,b:Ft,B:Pt,c:null,d:Ke,e:Ke,f:Fi,g:Ri,G:Gi,H:Oi,I:Mi,j:Di,L:ft,m:Pi,M:Ui,p:Ut,q:It,Q:$e,s:Qe,S:Ii,u:Ei,U:Ni,V:Ci,w:Li,W:Wi,x:null,X:null,y:Yi,Y:Hi,Z:zi,"%":Ve},M={a:pe,A:l,b:_,B:Y,c:_t,d:Ze,e:Ze,f:oi,g:qe,G:Be,H:Xe,I:Xe,j:ii,L:si,m:ti,M:ni,p:ye,q:ei,Q:li,s:ai,S:ri,u:Jt,U:Kt,V:Vt,w:Xt,W:$t,x:Tt,X:kt,y:qe,Y:Be,Z:Qt,"%":hi};x.x=u(t,x),x.X=u(i,x),x.c=u(e,x),T.x=u(t,T),T.X=u(i,T),T.c=u(e,T);function u(d,k){return function(b){var a=[],W=-1,P=0,R=d.length,H,J,ze;for(b instanceof Date||(b=new Date(+b));++W<R;)d.charCodeAt(W)===37&&(a.push(d.slice(P,W)),(J=je[H=d.charAt(++W)])!=null?H=d.charAt(++W):J=H==="e"?" ":"0",(ze=k[H])&&(H=ze(b,J)),a.push(H),P=W+1);return a.push(d.slice(P,W)),a.join("")}}function A(d,k){return function(b){var a=se(1900,void 0,1),W=y(a,d,b+="",0),P,R;if(W!=b.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(a.s*1e3+("L"in a?a.L:0));if(k&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+a.p*12),a.m===void 0&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(P=De(se(a.y,0,1)),R=P.getUTCDay(),P=R>4||R===0?ve.ceil(P):ve(P),P=lt.offset(P,(a.V-1)*7),a.y=P.getUTCFullYear(),a.m=P.getUTCMonth(),a.d=P.getUTCDate()+(a.w+6)%7):(P=Me(se(a.y,0,1)),R=P.getDay(),P=R>4||R===0?Se.ceil(P):Se(P),P=st.offset(P,(a.V-1)*7),a.y=P.getFullYear(),a.m=P.getMonth(),a.d=P.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),R="Z"in a?De(se(a.y,0,1)).getUTCDay():Me(se(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+a.W*7-(R+5)%7:a.w+a.U*7-(R+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,De(a)):Me(a)}}function y(d,k,b,a){for(var W=0,P=k.length,R=b.length,H,J;W<P;){if(a>=R)return-1;if(H=k.charCodeAt(W++),H===37){if(H=k.charAt(W++),J=M[H in je?k.charAt(W++):H],!J||(a=J(d,b,a))<0)return-1}else if(H!=b.charCodeAt(a++))return-1}return a}function ye(d,k,b){var a=f.exec(k.slice(b));return a?(d.p=p.get(a[0].toLowerCase()),b+a[0].length):-1}function pe(d,k,b){var a=S.exec(k.slice(b));return a?(d.w=E.get(a[0].toLowerCase()),b+a[0].length):-1}function l(d,k,b){var a=m.exec(k.slice(b));return a?(d.w=g.get(a[0].toLowerCase()),b+a[0].length):-1}function _(d,k,b){var a=w.exec(k.slice(b));return a?(d.m=I.get(a[0].toLowerCase()),b+a[0].length):-1}function Y(d,k,b){var a=F.exec(k.slice(b));return a?(d.m=v.get(a[0].toLowerCase()),b+a[0].length):-1}function _t(d,k,b){return y(d,e,k,b)}function Tt(d,k,b){return y(d,t,k,b)}function kt(d,k,b){return y(d,i,k,b)}function St(d){return c[d.getDay()]}function vt(d){return s[d.getDay()]}function wt(d){return o[d.getMonth()]}function xt(d){return h[d.getMonth()]}function bt(d){return r[+(d.getHours()>=12)]}function Ot(d){return 1+~~(d.getMonth()/3)}function Mt(d){return c[d.getUTCDay()]}function Dt(d){return s[d.getUTCDay()]}function Ft(d){return o[d.getUTCMonth()]}function Pt(d){return h[d.getUTCMonth()]}function Ut(d){return r[+(d.getUTCHours()>=12)]}function It(d){return 1+~~(d.getUTCMonth()/3)}return{format:function(d){var k=u(d+="",x);return k.toString=function(){return d},k},parse:function(d){var k=A(d+="",!1);return k.toString=function(){return d},k},utcFormat:function(d){var k=u(d+="",T);return k.toString=function(){return d},k},utcParse:function(d){var k=A(d+="",!0);return k.toString=function(){return d},k}}}var je={"-":"",_:" ",0:"0"},L=/^\s*\d+/,Bt=/^%/,qt=/[\\^$*+?|[\]().{}]/g;function O(n,e,t){var i=n<0?"-":"",r=(i?-n:n)+"",s=r.length;return i+(s<t?new Array(t-s+1).join(e)+r:r)}function Zt(n){return n.replace(qt,"\\$&")}function oe(n){return new RegExp("^(?:"+n.map(Zt).join("|")+")","i")}function he(n){return new Map(n.map((e,t)=>[e.toLowerCase(),t]))}function Xt(n,e,t){var i=L.exec(e.slice(t,t+1));return i?(n.w=+i[0],t+i[0].length):-1}function Jt(n,e,t){var i=L.exec(e.slice(t,t+1));return i?(n.u=+i[0],t+i[0].length):-1}function Kt(n,e,t){var i=L.exec(e.slice(t,t+2));return i?(n.U=+i[0],t+i[0].length):-1}function Vt(n,e,t){var i=L.exec(e.slice(t,t+2));return i?(n.V=+i[0],t+i[0].length):-1}function $t(n,e,t){var i=L.exec(e.slice(t,t+2));return i?(n.W=+i[0],t+i[0].length):-1}function Be(n,e,t){var i=L.exec(e.slice(t,t+4));return i?(n.y=+i[0],t+i[0].length):-1}function qe(n,e,t){var i=L.exec(e.slice(t,t+2));return i?(n.y=+i[0]+(+i[0]>68?1900:2e3),t+i[0].length):-1}function Qt(n,e,t){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(t,t+6));return i?(n.Z=i[1]?0:-(i[2]+(i[3]||"00")),t+i[0].length):-1}function ei(n,e,t){var i=L.exec(e.slice(t,t+1));return i?(n.q=i[0]*3-3,t+i[0].length):-1}function ti(n,e,t){var i=L.exec(e.slice(t,t+2));return i?(n.m=i[0]-1,t+i[0].length):-1}function Ze(n,e,t){var i=L.exec(e.slice(t,t+2));return i?(n.d=+i[0],t+i[0].length):-1}function ii(n,e,t){var i=L.exec(e.slice(t,t+3));return i?(n.m=0,n.d=+i[0],t+i[0].length):-1}function Xe(n,e,t){var i=L.exec(e.slice(t,t+2));return i?(n.H=+i[0],t+i[0].length):-1}function ni(n,e,t){var i=L.exec(e.slice(t,t+2));return i?(n.M=+i[0],t+i[0].length):-1}function ri(n,e,t){var i=L.exec(e.slice(t,t+2));return i?(n.S=+i[0],t+i[0].length):-1}function si(n,e,t){var i=L.exec(e.slice(t,t+3));return i?(n.L=+i[0],t+i[0].length):-1}function oi(n,e,t){var i=L.exec(e.slice(t,t+6));return i?(n.L=Math.floor(i[0]/1e3),t+i[0].length):-1}function hi(n,e,t){var i=Bt.exec(e.slice(t,t+1));return i?t+i[0].length:-1}function li(n,e,t){var i=L.exec(e.slice(t));return i?(n.Q=+i[0],t+i[0].length):-1}function ai(n,e,t){var i=L.exec(e.slice(t));return i?(n.s=+i[0],t+i[0].length):-1}function Je(n,e){return O(n.getDate(),e,2)}function ci(n,e){return O(n.getHours(),e,2)}function ui(n,e){return O(n.getHours()%12||12,e,2)}function fi(n,e){return O(1+st.count(ue(n),n),e,3)}function ct(n,e){return O(n.getMilliseconds(),e,3)}function gi(n,e){return ct(n,e)+"000"}function di(n,e){return O(n.getMonth()+1,e,2)}function mi(n,e){return O(n.getMinutes(),e,2)}function yi(n,e){return O(n.getSeconds(),e,2)}function pi(n){var e=n.getDay();return e===0?7:e}function Ai(n,e){return O(ot.count(ue(n)-1,n),e,2)}function ut(n){var e=n.getDay();return e>=4||e===0?ne(n):ne.ceil(n)}function _i(n,e){return n=ut(n),O(ne.count(ue(n),n)+(ue(n).getDay()===4),e,2)}function Ti(n){return n.getDay()}function ki(n,e){return O(Se.count(ue(n)-1,n),e,2)}function Si(n,e){return O(n.getFullYear()%100,e,2)}function vi(n,e){return n=ut(n),O(n.getFullYear()%100,e,2)}function wi(n,e){return O(n.getFullYear()%1e4,e,4)}function xi(n,e){var t=n.getDay();return n=t>=4||t===0?ne(n):ne.ceil(n),O(n.getFullYear()%1e4,e,4)}function bi(n){var e=n.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+O(e/60|0,"0",2)+O(e%60,"0",2)}function Ke(n,e){return O(n.getUTCDate(),e,2)}function Oi(n,e){return O(n.getUTCHours(),e,2)}function Mi(n,e){return O(n.getUTCHours()%12||12,e,2)}function Di(n,e){return O(1+lt.count(fe(n),n),e,3)}function ft(n,e){return O(n.getUTCMilliseconds(),e,3)}function Fi(n,e){return ft(n,e)+"000"}function Pi(n,e){return O(n.getUTCMonth()+1,e,2)}function Ui(n,e){return O(n.getUTCMinutes(),e,2)}function Ii(n,e){return O(n.getUTCSeconds(),e,2)}function Ei(n){var e=n.getUTCDay();return e===0?7:e}function Ni(n,e){return O(at.count(fe(n)-1,n),e,2)}function gt(n){var e=n.getUTCDay();return e>=4||e===0?re(n):re.ceil(n)}function Ci(n,e){return n=gt(n),O(re.count(fe(n),n)+(fe(n).getUTCDay()===4),e,2)}function Li(n){return n.getUTCDay()}function Wi(n,e){return O(ve.count(fe(n)-1,n),e,2)}function Yi(n,e){return O(n.getUTCFullYear()%100,e,2)}function Ri(n,e){return n=gt(n),O(n.getUTCFullYear()%100,e,2)}function Hi(n,e){return O(n.getUTCFullYear()%1e4,e,4)}function Gi(n,e){var t=n.getUTCDay();return n=t>=4||t===0?re(n):re.ceil(n),O(n.getUTCFullYear()%1e4,e,4)}function zi(){return"+0000"}function Ve(){return"%"}function $e(n){return+n}function Qe(n){return Math.floor(+n/1e3)}var te,V,dt;ji({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ji(n){return te=jt(n),V=te.format,dt=te.parse,te.utcFormat,te.utcParse,te}function ie(n,e,t){this.k=n,this.x=e,this.y=t}ie.prototype={constructor:ie,scale:function(n){return n===1?this:new ie(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new ie(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new ie(1,0,0);ie.prototype;function D(n){return n!=null&&n>-1}class Bi{constructor(e,t){this.color="#3366cc",this.showColor=!0,this.filter=!1,this.priority=0,this.id=e,this.name="Selection-"+this.id,this.elementIds=[],this.acceptedType=t,this.priority=e}acceptsType(e){return this.acceptedType==e}}class an{constructor(e){this.locationTable=[],this.selections=[],this.timeFormat="",this.name=e.name,this.nodeTable=e.nodeTable,this.linkTable=e.linkTable,this.directed=e.directed,e.nodeSchema==null?this.nodeSchema=qi():this.nodeSchema=e.nodeSchema,e.linkSchema==null?this.linkSchema=Zi():this.linkSchema=e.linkSchema,e.locationTable!=null&&(this.locationTable=e.locationTable),e.locationSchema==null?this.locationSchema=Xi():this.locationSchema=e.locationSchema,console.log("[n3] data set created",this)}}function qi(){return new Ji(0)}function Zi(){return new Ki(0,1,2)}function Xi(){return new Vi(0,1,2,3,4,5,6,7,8)}class He{constructor(e){this.name=e}}class Ji extends He{constructor(e){super("nodeSchema"),this.label=-1,this.time=-1,this.location=-1,this.nodeType=-1,this.shape=-1,this.color=-1,this.id=e}}class Ki extends He{constructor(e,t,i){super("linkSchema"),this.weight=-1,this.linkType=-1,this.directed=-1,this.time=-1,this.source=t,this.target=i,this.id=e}}class Vi extends He{constructor(e,t,i,r,s,c,h,o,f){super("locationSchema"),this.geoname=-1,this.longitude=-1,this.latitude=-1,this.x=-1,this.y=-1,this.z=-1,this.radius=-1,this.id=e,this.label=t,D(i)&&(this.geoname=i!=null?i:-1),D(r)&&(this.longitude=r!=null?r:-1),D(s)&&(this.latitude=s!=null?s:-1),D(c)&&(this.x=c!=null?c:-1),D(h)&&(this.y=h!=null?h:-1),D(o)&&(this.z=o!=null?o:-1),D(f)&&(this.radius=f!=null?f:-1)}}V("%m/%d/%Y");V("%d/%m/%Y");const we="%Y-%m-%d %H:%M:%S",le=dt(we),$i=V(we);V("%w");const Fe=["millisecond","second","minute","hour","day","week","month","year","decade","century","millenium"],Ge="[*dgraph*]";function Qi(n,e,t){return t==Ge?n:t}function cn(n,e){return e instanceof z?(console.log("dgraphReplacer found a DynamicGraph property",n),Ge):e}class z{constructor(){this.BOOKMARK_COLORS=this.default_colors,this.selectionColor_pointer=0,this.name="",this.gran_min=0,this.gran_max=Number.MAX_VALUE,this.minWeight=1e7,this.maxWeight=-1e7,this._nodes=[],this._links=[],this.directed=!1,this._nodePairs=[],this._locations=[],this._times=[],this.timeObjects=[],this.nodeOrders=[],this.matrix=[],this.selections=[],this.nodeArrays=new Pe,this.linkArrays=new Ue,this.nodePairArrays=new Ie,this.timeArrays=new Ae,this.linkTypeArrays=new et,this.nodeTypeArrays=new tt,this.locationArrays=new Ee,this.attributeArrays={node:this.nodeArrays,link:this.linkArrays,time:this.timeArrays,nodePair:this.nodePairArrays,linkType:this.linkTypeArrays,nodeType:this.nodeTypeArrays,location:this.locationArrays},this.highlightArrays=new ce,this.highlightFreezeArrays=new ce,this.currentSelection_id=0,this.defaultLinkSelection=this.createSelection("link"),this.defaultNodeSelection=this.createSelection("node"),this.gran_min_NAME="gran_min",this.gran_max_NAME="gran_max_NAME",this.directed_NAME="directed_NAME",this.minWeight_NAME="minWeight_NAME",this.maxWeight_NAME="maxWeight_NAME",this.matrix_NAME="matrix_NAME",this.nodeArrays_NAME="nodeArrays_NAME",this.linkArrays_NAME="linkArrays_NAME",this.nodePairArrays_NAME="nodePairArrays_NAME",this.timeArrays_NAME="timeArrays_NAME",this.linkTypeArrays_NAME="linkTypeArrays_NAME",this.nodeTypeArrays_NAME="nodeTypeArrays_NAME",this.locationArrays_NAME="locationArrays_NAME"}default_colors(e){const t=["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac"];return t[e%t.length]}attr(e,t,i){let r;try{r=this.attributeArrays[i][e][t]}catch{r=void 0}return r}standardArrayReplacer(e,t){return t instanceof z?(console.log("standardReplacer found a DynamicGraph property",e),Ge):e=="selections"?void 0:t}static timeReviver(e,t,i){return e==""?X(t,new ae(t.id,i)):Qi(i,e,t)}static nodeArrayReviver(e,t,i){switch(e){case"":return X(t,new Pe);case"outLinks":case"inLinks":case"links":return _e(t,function(){return new j});case"outNeighbors":case"inNeighbors":case"neighbors":return _e(t,function(){return new j});case"locations":return _e(t,function(){return new K});default:return t}}static linkArrayReviver(e,t,i){switch(e){case"":return X(t,new Ue);case"weights":return _e(t,function(){return new K});default:return t}}static nodePairArrayReviver(e,t,i){switch(e){case"":return X(t,new Ie);default:return t}}static timeArrayReviver(e,t,i){switch(e){case"":return X(t,new Ae);case"time":return t.map(function(r,s){return new Date(r)});default:return t}}static linkTypeArrayReviver(e,t,i){switch(e){case"":return X(t,new et);default:return t}}static nodeTypeArrayReviver(e,t,i){switch(e){case"":return X(t,new tt);default:return t}}static locationArrayReviver(e,t,i){switch(e){case"":return X(t,new Ee);default:return t}}loadDynamicGraph(e,t){this.clearSelections(),this.name=t;const i=e.getFromStorage(this.name,this.gran_min_NAME);i!=null&&(this.gran_min=i);const r=e.getFromStorage(this.name,this.gran_max_NAME);r!=null&&(this.gran_max=r);const s=e.getFromStorage(this.name,this.directed_NAME);s!=null&&(this.directed=s);const c=e.getFromStorage(this.name,this.minWeight_NAME);c!=null&&(this.minWeight=c);const h=e.getFromStorage(this.name,this.maxWeight_NAME);h!=null&&(this.maxWeight=h);const o=e.getFromStorage(this.name,this.matrix_NAME);o!=null&&(this.matrix=o);const f=e.getFromStorage(this.name,this.nodeArrays_NAME,z.nodeArrayReviver);f!=null&&(this.nodeArrays=f);const p=e.getFromStorage(this.name,this.linkArrays_NAME,z.linkArrayReviver);p!=null&&(this.linkArrays=p);const m=e.getFromStorage(this.name,this.nodePairArrays_NAME,z.nodePairArrayReviver);m!=null&&(this.nodePairArrays=m);const g=e.getFromStorage(this.name,this.timeArrays_NAME,z.timeArrayReviver);if(g!=null&&(this.timeArrays=g),!("timeArrays"in this)||!this.timeArrays)console.log("No timeArrays"),this.timeArrays=new Ae;else if("momentTime"in this.timeArrays&&"unixTime"in this.timeArrays){const v=this.timeArrays.momentTime;for(let w=0;w<v.length;w++)v[w]=new Date(this.timeArrays.unixTime[w])}else"unixTime"in this.timeArrays?(console.log("No time in timeArrays"),this.timeArrays.momentTime=this.timeArrays.unixTime.map(new Date)):(console.log("No time or unixTime in timeArrays"),this.timeArrays.momentTime=[]);const S=e.getFromStorage(this.name,this.linkTypeArrays_NAME,z.linkTypeArrayReviver);S!=null&&(this.linkTypeArrays=S);const E=e.getFromStorage(this.name,this.nodeTypeArrays_NAME,z.nodeTypeArrayReviver);E!=null&&(this.nodeTypeArrays=E);const F=e.getFromStorage(this.name,this.locationArrays_NAME,z.locationArrayReviver);F!=null&&(this.locationArrays=F),this.attributeArrays={node:this.nodeArrays,link:this.linkArrays,time:this.timeArrays,nodePair:this.nodePairArrays,linkType:this.linkTypeArrays,nodeType:this.nodeTypeArrays,location:this.locationArrays},this.createGraphObjects(!0,!0),this.createSelections(!0)}saveDynamicGraph(e){e.saveToStorage(this.name,this.gran_min_NAME,this.gran_min),e.saveToStorage(this.name,this.gran_max_NAME,this.gran_max),e.saveToStorage(this.name,this.directed_NAME,this.directed),e.saveToStorage(this.name,this.minWeight_NAME,this.minWeight),e.saveToStorage(this.name,this.maxWeight_NAME,this.maxWeight),e.saveToStorage(this.name,this.matrix_NAME,this.matrix),e.saveToStorage(this.name,this.nodeArrays_NAME,this.nodeArrays,this.standardArrayReplacer),e.saveToStorage(this.name,this.linkArrays_NAME,this.linkArrays,this.standardArrayReplacer),e.saveToStorage(this.name,this.nodePairArrays_NAME,this.nodePairArrays,this.standardArrayReplacer),e.saveToStorage(this.name,this.timeArrays_NAME,this.timeArrays,this.standardArrayReplacer),e.saveToStorage(this.name,this.linkTypeArrays_NAME,this.linkTypeArrays,this.standardArrayReplacer),e.saveToStorage(this.name,this.nodeTypeArrays_NAME,this.nodeTypeArrays,this.standardArrayReplacer),e.saveToStorage(this.name,this.locationArrays_NAME,this.locationArrays,this.standardArrayReplacer)}delete(e){e.removeFromStorage(this.name,this.gran_min_NAME),e.removeFromStorage(this.name,this.gran_max_NAME),e.removeFromStorage(this.name,this.directed_NAME),e.removeFromStorage(this.name,this.minWeight_NAME),e.removeFromStorage(this.name,this.maxWeight_NAME),e.removeFromStorage(this.name,this.matrix_NAME),e.removeFromStorage(this.name,this.nodeArrays_NAME),e.removeFromStorage(this.name,this.linkArrays_NAME),e.removeFromStorage(this.name,this.nodePairArrays_NAME),e.removeFromStorage(this.name,this.timeArrays_NAME),e.removeFromStorage(this.name,this.linkTypeArrays_NAME),e.removeFromStorage(this.name,this.nodeTypeArrays_NAME),e.removeFromStorage(this.name,this.locationArrays_NAME)}debugCompareTo(e){let t=!0;return this.name!=e.name&&(console.log("name different"),t=!1),this.gran_min!=e.gran_min&&(console.log("gran_min different",this.gran_min,e.gran_min),t=!1),this.gran_max!=e.gran_max&&(console.log("gran_max different",this.gran_max,e.gran_max),t=!1),this.directed!=e.directed&&(console.log("directed different",this.directed,e.directed),t=!1),(this._nodes.length!=e._nodes.length||!C(this._nodes,e._nodes,2))&&(console.log("nodes different"),t=!1),(this._links.length!=e._links.length||!C(this._links,e._links,2))&&(console.log("links different"),t=!1),(this._nodePairs.length!=e._nodePairs.length||!C(this._nodePairs,e._nodePairs,2))&&(console.log("nodePairs different"),t=!1),(this._locations.length!=e._locations.length||!C(this._locations,e._locations,2))&&(console.log("locations different"),t=!1),(this._times.length!=e._times.length||!C(this._times,e._times,2))&&(console.log("times different"),t=!1),(this.nodeOrders&&this.nodeOrders.length!=e.nodeOrders.length||!C(this.nodeOrders,e.nodeOrders,2))&&(console.log("nodeOrders different",this.nodeOrders,e.nodeOrders),t=!1),(this.matrix.length!=e.matrix.length||!C(this.matrix,e.matrix,2))&&(console.log("matrix different",this.matrix,e.matrix),t=!1),(this.nodeArrays.length!=e.nodeArrays.length||!C(this.nodeArrays,e.nodeArrays,2))&&(console.log("nodeArrays different",this.nodeArrays,e.nodeArrays),t=!1),(this.linkArrays.length!=e.linkArrays.length||!C(this.linkArrays,e.linkArrays,2))&&(console.log("linkArrays different",this.linkArrays,e.linkArrays),t=!1),(this.nodePairArrays.length!=e.nodePairArrays.length||!C(this.nodePairArrays,e.nodePairArrays,2))&&(console.log("nodePairArrays different",this.nodePairArrays,e.nodePairArrays),t=!1),(this.timeArrays.length!=e.timeArrays.length||!C(this.timeArrays,e.timeArrays,2))&&(console.log("timeArrays different",this.timeArrays,e.timeArrays),t=!1),(this.linkTypeArrays.length!=e.linkTypeArrays.length||!C(this.linkTypeArrays,e.linkTypeArrays,2))&&(console.log("linkTypeArrays different",this.linkTypeArrays,e.linkTypeArrays),t=!1),(this.nodeTypeArrays.length!=e.nodeTypeArrays.length||!C(this.nodeTypeArrays,e.nodeTypeArrays,2))&&(console.log("nodeTypeArrays different",this.nodeTypeArrays,e.nodeTypeArrays),t=!1),(this.locationArrays.length!=e.locationArrays.length||!C(this.locationArrays,e.locationArrays,2))&&(console.log("locationArrays different",this.locationArrays,e.locationArrays),t=!1),(this.defaultLinkSelection.elementIds.length!=e.defaultLinkSelection.elementIds.length||!C(this.defaultLinkSelection,e.defaultLinkSelection,2))&&(console.log("defaultLinkSelection different",this.defaultLinkSelection,e.defaultLinkSelection),t=!1),(this.defaultNodeSelection.elementIds.length!=e.defaultNodeSelection.elementIds.length||!C(this.defaultNodeSelection,e.defaultNodeSelection,2))&&(console.log("defaultNodeSelection different",this.defaultNodeSelection,e.defaultNodeSelection),t=!1),(this.selections.length!=e.selections.length||!C(this.selections,e.selections,2))&&(console.log("selections different",this.selections,e.selections),t=!1),t}initDynamicGraph(e){var u,A,y,ye,pe;this.clearSelections(),console.log("[dynamicgraph.ts] Create dynamic graph for ",e.name,e),this.name=e.name,this.directed=e.directed,this.gran_min=0,this.gran_max=0;let t;const i=[];let r;if(D(e.linkSchema.time)){console.log("GEtting unix times for all times - linktable"),console.log(e.linkTable);for(let _=0;_<e.linkTable.length;_++)t=e.linkTable[_][e.linkSchema.time],console.log(e.linkTable[_]),r=(u=le(t))==null?void 0:u.getTime(),r!=null&&i.indexOf(r)==-1&&i.push(r);i.sort(rn);let l=99999999999999;for(let _=0;_<i.length-2;_++)l=Math.min(l,i[_+1]-i[_]);l>=1e3&&(this.gran_min=1),l>=1e3*60&&(this.gran_min=2),l>=1e3*60*60&&(this.gran_min=3),l>=1e3*60*60*24&&(this.gran_min=4),l>=1e3*60*60*24*7&&(this.gran_min=5),l>=1e3*60*60*24*30&&(this.gran_min=6),l>=1e3*60*60*24*30*12&&(this.gran_min=7),l>=1e3*60*60*24*30*12*10&&(this.gran_min=8),l>=1e3*60*60*24*30*12*100&&(this.gran_min=9),l>=1e3*60*60*24*30*12*1e3&&(this.gran_min=10),l=i[i.length-1]-i[0],this.gran_max=0,l>=1e3&&(this.gran_max=1),l>=1e3*60&&(this.gran_max=2),l>=1e3*60*60&&(this.gran_max=3),l>=1e3*60*60*24&&(this.gran_max=4),l>=1e3*60*60*24*7&&(this.gran_max=5),l>=1e3*60*60*24*30&&(this.gran_max=6),l>=1e3*60*60*24*30*12&&(this.gran_max=7),l>=1e3*60*60*24*30*12*10&&(this.gran_max=8),l>=1e3*60*60*24*30*12*100&&(this.gran_max=9),l>=1e3*60*60*24*30*12*1e3&&(this.gran_max=10),console.log("[Dynamic Graph] Minimal granularity",Fe[this.gran_min]),console.log("[Dynamic Graph] Maximal granularity",Fe[this.gran_max]);for(let _=0;_<i.length;_++)this.timeArrays.id.push(_),this.timeArrays.momentTime.push(new Date(i[_])),this.timeArrays.label.push($i(this.timeArrays.momentTime[_])),this.timeArrays.unixTime.push(i[_]),this.timeArrays.selections.push([]),this.timeArrays.filter.push(!1),this.timeArrays.links.push([]),this._times.push(new ae(_,this));for(let _=0;_<=Fe.length;_++)this.timeObjects.push([])}if(this.timeArrays.length==0&&(this.timeArrays.id.push(0),this.timeArrays.momentTime.push(new Date(0)),this.timeArrays.unixTime.push(0),this.timeArrays.selections.push([]),this.timeArrays.filter.push(!1),this.timeArrays.links.push([]),this._times.push(new ae(0,this))),console.assert(!e.locationTable||D(e.locationSchema.id)),e.locationTable)for(let l=0;l<e.locationTable.length;l++)this.locationArrays.id.push(e.locationTable[l][e.locationSchema.id]),this.locationArrays.label.push(e.locationTable[l][e.locationSchema.label]),this.locationArrays.longitude.push(e.locationTable[l][e.locationSchema.longitude]),this.locationArrays.latitude.push(e.locationTable[l][e.locationSchema.latitude]),this.locationArrays.x.push(e.locationTable[l][e.locationSchema.x]),this.locationArrays.y.push(e.locationTable[l][e.locationSchema.y]),this.locationArrays.z.push(e.locationTable[l][e.locationSchema.z]),this.locationArrays.radius.push(e.locationTable[l][e.locationSchema.radius]);"id"in this.locationArrays&&console.log("locations",this.locationArrays.id.length);let s,c,h,o;console.assert(e.nodeTable.length==0||D(e.nodeSchema.id),"either there is no nodeTable data, or we have a schema for the nodetable");let f,p;const m=[];for(const l in e.nodeSchema)Object.prototype.hasOwnProperty.call(e.nodeSchema,l)&&l!="id"&&l!="label"&&l!="time"&&l!="name"&&l!="nodeType"&&l!="location"&&l!="constructor"&&(m.push(l),this.nodeArrays[l]=[]);for(let l=0;l<e.nodeTable.length;l++){if(s=e.nodeTable[l],c=s[e.nodeSchema.id],h=this.nodeArrays.id.indexOf(c),h==-1&&(h=this.nodeArrays.id.length,this.nodeArrays.id.push(c),this.nodeArrays.nodeType.push(""),this.nodeArrays.outLinks.push(new j),this.nodeArrays.inLinks.push(new j),this.nodeArrays.links.push(new j),this.nodeArrays.outNeighbors.push(new j),this.nodeArrays.inNeighbors.push(new j),this.nodeArrays.neighbors.push(new j),this.nodeArrays.selections.push([]),this.nodeArrays.filter.push(!1),this.nodeArrays.locations.push(new K),this.nodeArrays.attributes.push(new Object),this.nodeArrays.color.push(""),this.nodeArrays.shape.push(""),D(e.nodeSchema.label)?this.nodeArrays.label.push(s[e.nodeSchema.label]):this.nodeArrays.label.push(s[e.nodeSchema.id])),D(e.nodeSchema.time)){t=s[e.nodeSchema.time],console.log("params"),console.log(t),console.log(we),console.log((A=le(t))==null?void 0:A.toUTCString()),console.log((y=le(t))==null?void 0:y.getTime());const _=this.getTimeIdForUnixTime((ye=le(t))==null?void 0:ye.getTime());t==null||_==null?o=this._times[0]:o=this._times[_]}else o=this._times[0];if(o==null&&(o=this._times[0]),D(e.nodeSchema.location)){const _=s[e.nodeSchema.location];if(_==null||_==null)continue;this.nodeArrays.locations[c].set(o,_)}if(D(e.nodeSchema.shape)){const _=s[e.nodeSchema.shape];this.nodeArrays.shape.push(_)}D(e.nodeSchema.nodeType)&&(f=e.nodeTable[l][e.nodeSchema.nodeType],p=this.nodeTypeArrays.name.indexOf(f),p<0&&(p=this.nodeTypeArrays.length,this.nodeTypeArrays.id.push(p),this.nodeTypeArrays.name.push(f)),this.nodeArrays.nodeType[h]=f,e.nodeTable[l][e.nodeSchema.nodeType]=p);for(let _=0;_<m.length;_++){const Y=m[_];this.nodeArrays[Y].push(s[e.nodeSchema[Y]])}}if("id"in this.nodeArrays)for(let l=0;l<this.nodeArrays.id.length;l++)this.matrix.push(sn(void 0,this.nodeArrays.id.length));let g,S,E,F,v;const w=[];for(const l in e.linkSchema)Object.prototype.hasOwnProperty.call(e.linkSchema,l)&&l!="id"&&l!="linkType"&&l!="time"&&l!="name"&&l!="source"&&l!="target"&&l!="weight"&&l!="directed"&&(w.push(l),this.linkArrays[l]=[]);console.log("linkUserProperties",w),console.assert(e.linkTable.length==0||D(e.linkSchema.id)&&D(e.linkSchema.source)&&D(e.linkSchema.target),"either there are no links, or the linkschema is defined");for(let l=0;l<e.linkTable.length;l++){if(s=e.linkTable[l],v=s[e.linkSchema.id],this.linkArrays.directed.push(!1),this.linkArrays.id.indexOf(v)==-1&&(this.linkArrays.id[v]=v,this.linkArrays.source[v]=s[e.linkSchema.source],this.linkArrays.target[v]=s[e.linkSchema.target],this.linkArrays.linkType[v]=s[e.linkSchema.linkType],this.linkArrays.directed[v]=s[e.linkSchema.directed],this.linkArrays.weights[v]=new K,this.linkArrays.presence[v]=[],this.linkArrays.selections.push([]),this.linkArrays.nodePair.push(void 0),this.linkArrays.filter.push(!1)),D(e.linkSchema.time)){t=e.linkTable[l][e.linkSchema.time],r=(pe=le(t))==null?void 0:pe.getTime();const _=r?this.getTimeIdForUnixTime(r):void 0;_!=null?E=_:E=0}else E=0;o=this._times[E],this.linkArrays.presence[v].push(E),D(e.linkSchema.weight)&&e.linkTable[l][e.linkSchema.weight]!=null?(this.linkArrays.weights[v].set(o,e.linkTable[l][e.linkSchema.weight]),this.minWeight=Math.min(this.minWeight,e.linkTable[l][e.linkSchema.weight]),this.maxWeight=Math.max(this.maxWeight,e.linkTable[l][e.linkSchema.weight])):(this.minWeight=0,this.maxWeight=1,this.linkArrays.weights[v].set(o,1)),g=this.nodeArrays.id.indexOf(s[e.linkSchema.source]),S=this.nodeArrays.id.indexOf(s[e.linkSchema.target]),this.nodeArrays.neighbors[g].add(o,S),this.nodeArrays.neighbors[S].add(o,g),this.nodeArrays.links[g].add(o,v),this.nodeArrays.links[S].add(o,v),this.linkArrays.directed[l]&&(this.nodeArrays.outNeighbors[g].add(o,S),this.nodeArrays.inNeighbors[S].add(o,g),this.nodeArrays.outLinks[g].add(o,v),this.nodeArrays.inLinks[S].add(o,v)),F=this.matrix[g][S],D(F)||(F=this.nodePairArrays.length,this.matrix[g][S]=F,this.nodePairArrays.id.push(F),this.nodePairArrays.source.push(g),this.nodePairArrays.target.push(S),this.nodePairArrays.links.push([]),this.nodePairArrays.selections.push([]),this.nodePairArrays.filter.push(!1)),this.nodePairArrays.links[F].indexOf(v)==-1&&(this.nodePairArrays.links[F].push(v),this.linkArrays.nodePair[v]=F),D(e.linkSchema.linkType)&&(f=e.linkTable[l][e.linkSchema.linkType],p=this.linkTypeArrays.name.indexOf(f),p<0&&(p=this.linkTypeArrays.length,this.linkTypeArrays.id.push(p),this.linkTypeArrays.name.push(f)),e.linkTable[l][e.linkSchema.linkType]=p);for(let _=0;_<w.length;_++){const Y=w[_];this.linkArrays[Y].push(s[e.linkSchema[Y]])}}for(let l=0;l<this.linkArrays.length;l++)for(let _=0;_<this.timeArrays.length;_++)this.linkArrays.weights[l]&&Object.prototype.hasOwnProperty.call(this.linkArrays.weights[l].toArray(),this.timeArrays.id[_].toString())&&this.timeArrays.links[_].push(this.linkArrays.id[l]);const I=new Set(["#e4549b","#a33a36","#bd6221","#dfba47","#b5b867","#479b7f","#335b8e","#78387d"]),x={};this.nodeArrays.color.forEach(function(l){if(!x[l]){const _=Array.from(I),Y=_[Math.floor(Math.random()*_.length)];x[l]=Y,I.delete(Y)}});const T=new Set(["cross","diamond","square","triangle"]),M={};this.nodeArrays.shape.forEach(function(l){if(!M[l]){const _=Array.from(T),Y=_[Math.floor(Math.random()*_.length)];M[l]=Y,T.delete(Y)}}),console.log("[Dynamic Graph] Dynamic Graph created: ",this.nodeArrays.length),console.log("[Dynamic Graph]    - Nodes: ",this.nodeArrays.length),console.log("[Dynamic Graph]    - Edges: ",this.linkArrays.length),console.log("[Dynamic Graph]    - Times: ",this.timeArrays.length),console.log("[Dynamic Graph]    - Link types: ",this.linkTypeArrays.length),console.log("[Dynamic Graph]    - Node Pairs: ",this.nodePairArrays.length),console.log('>>>this.nodeArrays["neighbors"][0]',this.nodeArrays.neighbors[0]),this.createGraphObjects(!0,!0),this.createSelections(!1)}createSelections(e){if(e){"nodeArrays"in this&&this.nodeArrays||(this.nodeArrays=new Pe,this.linkArrays=new Ue,this.timeArrays=new Ae,this.nodePairArrays=new Ie),this.nodeArrays.selections=new Array(this.nodeArrays.length);for(let o=0;o<this.nodeArrays.selections.length;o++)this.nodeArrays.selections[o]=[];this.linkArrays.selections=new Array(this.linkArrays.length);for(let o=0;o<this.linkArrays.selections.length;o++)this.linkArrays.selections[o]=[];this.timeArrays.selections=new Array(this.timeArrays.length);for(let o=0;o<this.timeArrays.selections.length;o++)this.timeArrays.selections[o]=[];this.nodePairArrays.selections=new Array(this.nodePairArrays.length);for(let o=0;o<this.nodePairArrays.selections.length;o++)this.nodePairArrays.selections[o]=[]}this.defaultNodeSelection=this.createSelection("node"),this.defaultNodeSelection.name="Unselected";for(let o=0;o<this._nodes.length;o++)this.defaultNodeSelection.elementIds.push(o),this.addToAttributeArraysSelection(this.defaultNodeSelection,"node",this._nodes[o].id());this.defaultNodeSelection.color="#000000",this.defaultNodeSelection.showColor=!1,this.defaultNodeSelection.priority=1e4,this.selectionColor_pointer--,this.defaultLinkSelection=this.createSelection("link"),this.defaultLinkSelection.name="Unselected";for(let o=0;o<this._links.length;o++)this.defaultLinkSelection.elementIds.push(o),this.addToAttributeArraysSelection(this.defaultLinkSelection,"link",this._links[o].id());this.defaultLinkSelection.color="#000000",this.defaultLinkSelection.showColor=!1,this.defaultLinkSelection.priority=1e4,this.selectionColor_pointer--;let t=[],i,r,s;const c=[];for(let o=0;o<this.nodeArrays.nodeType.length;o++)i=this.nodeArrays.nodeType[o],!(i==null||i.length==0||i=="undefined")&&(r=t.indexOf(i),r==-1?(s=this.createSelection("node"),s.name=i,c.push(s),t.push(i)):s=c[r],this.addElementToSelection(s,this._nodes[o]));c.length==1&&(console.log("nodeSelections[0]:",c[0]),c[0].color="#444"),t=[];const h=[];for(let o=0;o<this.linkArrays.linkType.length;o++)i=this.linkArrays.linkType[o],!(!i||i=="undefined")&&(r=t.indexOf(i),r==-1?(s=this.createSelection("link"),s.name=i,h.push(s),t.push(i)):s=h[r],this.addElementToSelection(s,this._links[o]));h.length==1&&(h[0].color="#444"),this.currentSelection_id=0}createGraphObjects(e,t){console.log("[DynamicNetwork:createGraph()] >>> ");const i=Date.now();if(this.locationArrays&&"id"in this.locationArrays)for(let h=0;h<this.locationArrays.id.length;h++)this._locations.push(new mt(this.locationArrays.id[h],this));else this.locationArrays=new Ee;const r=[];if("nodeArrays"in this&&this.nodeArrays)for(let h=0;h<this.nodeArrays.id.length;h++)r.push(new pt(h,this));const s=[];let c;if("linkArrays"in this&&this.linkArrays)for(let h=0;h<this.linkArrays.source.length;h++)c=new At(h,this),s.push(c);if("nodePairArrays"in this&&this.nodePairArrays)for(let h=0;h<this.nodePairArrays.length;h++)this.nodePairArrays.links[h],this._nodePairs.push(new yt(h,this));if(this._nodes=r,this._links=s,e){this._times=[];for(let h=0;h<this.timeArrays.length;h++)this._times.push(new ae(h,this))}console.log("[DynamicNetwork:getGraph()] <<< ",Date.now()-i,"msec")}nodeAttr(e,t){return this.attr(e,t,"node")}linkAttr(e,t){return this.attr(e,t,"link")}pairAttr(e,t){return this.attr(e,t,"nodePair")}timeAttr(e,t){return this.attr(e,t,"time")}get startTime(){return this._times[0]}get endTime(){return this._times[this._times.length-1]}highlight(e,t){if(e=="freeze"){this.highlight("resetFreeze"),this.highlight("addFreeze",t);return}if(e=="resetFreeze"){this.highlightFreezeArrays.nodeIds=[],this.highlightFreezeArrays.linkIds=[],this.highlightFreezeArrays.nodePairIds=[],this.highlightFreezeArrays.timeIds=[];return}if(e=="reset"){this.highlightArrays.nodeIds=[],this.highlightArrays.linkIds=[],this.highlightArrays.nodePairIds=[],this.highlightArrays.timeIds=[];return}if(!t){console.error("[DynamicGraph] highlight: idCompound not set!");return}if(e=="set"){this.highlight("reset"),this.highlight("add",t);return}if(e=="add")for(const i in t)for(let r=0;r<t[i].length;r++)this.highlightArrays[i].push(t[i][r]);else if(e=="remove"){let i;for(const r in t)for(let s=0;s<t[r].length;s++)i=this.highlightArrays[r].indexOf(t[r][s]),i>=0&&this.highlightArrays[r].splice(i,1)}if(e=="addFreeze")for(const i in t)for(let r=0;r<t[i].length;r++)this.highlightFreezeArrays[i].push(t[i][r]);else if(e=="removeFreeze"){let i;for(const r in t)for(let s=0;s<t[r].length;s++)i=this.highlightFreezeArrays[r].indexOf(t[r][s]),i>=0&&this.highlightFreezeArrays[r].splice(i,1)}}selection(e,t,i){i==null&&(i=this.currentSelection_id);const r=this.getSelection(i);if(!r){console.error("[DynamicGraph] Selection with ",i,"not found in ",this.selections);return}if(e=="set"){const s=new ce;s[r.acceptedType+"s"]=r.elementIds,this.selection("remove",s,i),this.selection("add",t,i)}else e=="add"?(t.linkIds.forEach(s=>this.addToSelectionByTypeAndId(r,"link",s)),t.nodeIds.forEach(s=>this.addToSelectionByTypeAndId(r,"node",s)),t.timeIds.forEach(s=>this.addToSelectionByTypeAndId(r,"time",s)),t.nodePairIds.forEach(s=>this.addToSelectionByTypeAndId(r,"nodePair",s))):e=="remove"&&(t.linkIds.forEach(s=>this.removeFromSelectionByTypeAndId(r,"link",s)),t.nodeIds.forEach(s=>this.removeFromSelectionByTypeAndId(r,"node",s)),t.timeIds.forEach(s=>this.removeFromSelectionByTypeAndId(r,"time",s)),t.nodePairIds.forEach(s=>this.removeFromSelectionByTypeAndId(r,"nodePair",s)))}addToAttributeArraysSelection(e,t,i){const r=this.attributeArrays[t].selections[i];for(let s=0;s<r.length;s++)if(r[s].priority>e.priority){this.attributeArrays[t].selections[i].splice(s,0,e);return}this.attributeArrays[t].selections[i].push(e)}removeFromAttributeArraysSelection(e,t,i){const r=this.attributeArrays[t].selections[i];for(let s=0;s<r.length;s++)r[s]==e&&this.attributeArrays[t].selections[i].splice(s,1)}addElementToSelection(e,t){this.addToSelectionByTypeAndId(e,t.type,t.id())}addToSelectionByTypeAndId(e,t,i){if(t!=e.acceptedType){console.log("attempting to put object of the wrong type into a selection. "+t+" !="+e.acceptedType);return}e.elementIds.push(i),this.addToAttributeArraysSelection(e,t,i);let r;t=="node"?(r=this.defaultNodeSelection.elementIds.indexOf(i),r>-1&&(this.removeFromAttributeArraysSelection(this.defaultNodeSelection,t,i),this.defaultNodeSelection.elementIds.splice(r,1))):t=="link"&&(r=this.defaultLinkSelection.elementIds.indexOf(i),r>-1&&(this.removeFromAttributeArraysSelection(this.defaultLinkSelection,t,i),this.defaultLinkSelection.elementIds.splice(r,1)))}removeElementFromSelection(e,t){this.removeFromSelectionByTypeAndId(e,t.type,t.id())}removeFromSelectionByTypeAndId(e,t,i){const r=e.elementIds.indexOf(i);r!=-1&&(e.elementIds.splice(r,1),this.removeFromAttributeArraysSelection(e,t,i),this.getSelectionsByTypeAndId(t,i).length==0&&(t=="node"?(this.defaultNodeSelection.elementIds.push(i),this.addToAttributeArraysSelection(this.defaultNodeSelection,t,i)):t=="link"&&(this.defaultLinkSelection.elementIds.push(i),this.addToAttributeArraysSelection(this.defaultLinkSelection,t,i))))}getSelectionsByTypeAndId(e,t){return this.attributeArrays[e].selections[t]}filterSelection(e,t){const i=this.getSelection(e);i!=null&&(i.filter=t)}isFiltered(e,t){return this.attributeArrays[t+"s"].filter}isHighlighted(e,t){return this.highlightArrays[t+"Ids"].indexOf(e)>-1||this.highlightFreezeArrays[t+"Ids"].indexOf(e)>-1}isFrozen(e,t){return this.highlightFreezeArrays[t+"Ids"].indexOf(e)>-1}getHighlightedIds(e){return this.highlightArrays[e+"Ids"]}setCurrentSelection(e){console.log("[DynamicGraph] setCurrentSelectionId ",e),this.currentSelection_id=e}getCurrentSelection(){return this.getSelection(this.currentSelection_id)}addSelection(e,t,i,r){const s=this.createSelection(i);s.id=e,s.color=t,s.priority=r}createSelection(e){const t=new Bi(this.selections.length,e);return t.color=this.BOOKMARK_COLORS(this.selectionColor_pointer%10),this.selectionColor_pointer++,this.selections.push(t),t}deleteSelection(e){const t=this.getSelection(e);if(t!=null){const i=new ce;i[t.acceptedType+"Ids"]=t.elementIds.slice(0),console.log("Delete selection->remove elemeents",t.elementIds.slice(0)),this.selection("remove",i,t.id),this.selections.splice(this.selections.indexOf(t),1)}}setSelectionColor(e,t){const i=this.getSelection(e);!i||(i.color=t)}getSelections(e){const t=[];if(e){for(let i=0;i<this.selections.length;i++)this.selections[i].acceptsType(e)&&t.push(this.selections[i]);return t}else return this.selections}getSelection(e){for(let t=0;t<this.selections.length;t++)if(e==this.selections[t].id)return this.selections[t];console.error("[DynamicGraph] No selection with id ",e,"found!")}clearSelections(){this.selections=[]}getTimeIdForUnixTime(e){let t;for(console.log("unixTime: "),console.log(e),t=0;t<this.timeArrays.length;t++)if(e==this.timeArrays.unixTime[t])return t;console.error("Time object for unix time",e,"not found!")}addNodeOrdering(e,t){for(let r=0;r<this.nodeOrders.length;r++)if(this.nodeOrders[r].name==e){console.error("Ordering",e,"already exists");return}const i=new en(e,t);this.nodeOrders.push(i)}setNodeOrdering(e,t){for(let i=0;i<this.nodeOrders.length;i++)if(this.nodeOrders[i].name==e){this.nodeOrders[i].order=t;return}console.error("Ordering",e,"does not exist")}removeNodeOrdering(e,t){for(let i=0;i<this.nodeOrders.length;i++)this.nodeOrders[i].name==e&&this.nodeOrders.splice(i,1)}getNodeOrder(e){for(let t=0;t<this.nodeOrders.length;t++)if(this.nodeOrders[t].name==e)return this.nodeOrders[t];console.error("Ordering",e,"not found!")}nodes(){return new N(this.nodeArrays.id,this)}links(){return new U(this.linkArrays.id,this)}times(){return new q(this.timeArrays.id,this)}locations(){return new G(this.locationArrays.id,this)}nodePairs(){return new B(this.nodePairArrays.id,this)}linksBetween(e,t){let i=this.matrix[e.id()][t.id()];if(i==null&&(i=this.matrix[t.id()][e.id()]),i==null)return new U([],this);const r=this.nodePair(i);return r!=null?new U(r.links().toArray(),this):new U([],this)}get(e,t){if(e.indexOf("nodePair")>-1)return this.nodePair(t);if(e.indexOf("node")>-1)return this.node(t);if(e.indexOf("link")>-1)return this.link(t);if(e.indexOf("time")>-1)return this.time(t);if(e.indexOf("locations")>-1)return this.location(t)}getAll(e){return e=="nodes"?this.nodes():e=="links"?this.links():e=="times"?this.times():e=="nodePairs"?this.nodePairs():this.locations()}node(e){for(let t=0;t<this._nodes.length;t++)if(this._nodes[t].id()==e)return this._nodes[t]}link(e){for(let t=0;t<this._links.length;t++)if(this._links[t].id()==e)return this._links[t]}time(e){for(let t=0;t<this._times.length;t++)if(this._times[t].id()==e)return this._times[t]}location(e){for(let t=0;t<this._locations.length;t++)if(this._locations[t].id()==e)return this._locations[t]}nodePair(e){for(let t=0;t<this._nodePairs.length;t++)if(this._nodePairs[t].id()==e)return this._nodePairs[t]}getMinGranularity(){return this.gran_min}getMaxGranularity(){return this.gran_max}}class ee{constructor(){this.id=[]}get length(){return this.id.length}}class Pe extends ee{constructor(){super(...arguments),this.id=[],this.label=[],this.outLinks=[],this.inLinks=[],this.links=[],this.outNeighbors=[],this.inNeighbors=[],this.neighbors=[],this.selections=[],this.attributes=[],this.locations=[],this.filter=[],this.nodeType=[],this.color=[],this.shape=[]}}class Ue extends ee{constructor(){super(...arguments),this.source=[],this.target=[],this.linkType=[],this.directed=[],this.nodePair=[],this.presence=[],this.weights=[],this.selections=[],this.filter=[],this.attributes=new Object}}class Ie extends ee{constructor(){super(...arguments),this.source=[],this.target=[],this.links=[],this.selections=[],this.filter=[]}}class Ae extends ee{constructor(){super(...arguments),this.id=[],this.momentTime=[],this.label=[],this.unixTime=[],this.selections=[],this.filter=[],this.links=[]}}class et extends ee{constructor(){super(...arguments),this.name=[],this.count=[],this.color=[],this.filter=[]}}class tt extends ee{constructor(){super(...arguments),this.name=[],this.count=[],this.color=[],this.filter=[]}}class Ee extends ee{constructor(){super(...arguments),this.id=[],this.label=[],this.longitude=[],this.latitude=[],this.x=[],this.y=[],this.z=[],this.radius=[]}}class en{constructor(e,t){this.order=[],this.name=e,this.order=t}}class xe{constructor(e){if(this._elements=[],e)for(let t=0;t<e.length;t++)e[t]!=null&&this._elements.push(e[t])}addUnique(e){this._elements.indexOf(e)==-1&&this._elements.push(e)}add(e){this._elements.push(e)}addAll(e){for(let t=0;t<e.length;t++)e[t]!=null&&this._elements.push(e[t])}addAllUnique(e){for(let t=0;t<e.length;t++)this.addUnique(e[t])}get length(){return this._elements.length}size(){return this._elements.length}ids(){return this._elements}removeDuplicates(){const e=this._elements.slice(0);this._elements=[];for(let t=0;t<e.length;t++)this._elements.indexOf(e[t])==-1&&this._elements.push(e[t]);return this}generic_intersection(e){const t=[];for(let i=0;i<this._elements.length;i++)for(let r=0;r<e._elements.length;r++)this._elements[i]==e._elements[r]&&t.push(this._elements[i]);return new xe(t)}}class ge extends xe{constructor(e,t,i){super(e),this.g=t,this.elementType=i}generic_filter(e){const t=[];for(let i=0;i<this._elements.length;i++)try{e(this.g.get(this.elementType,this._elements[i]))&&t.push(this._elements[i])}catch{}return t}generic_selected(){const e=[];for(let t=0;t<this._elements.length;t++){const i=this.g.get(this.elementType,this._elements[t]);i!=null&&i.isSelected()&&e.push(this._elements[t])}return e}generic_visible(){const e=[];for(let t=0;t<this._elements.length;t++){const i=this.g.get(this.elementType,this._elements[t]);i!=null&&i.isVisible()&&e.push(this._elements[t])}return e}generic_highlighted(){const e=[];for(let t=0;t<this._elements.length;t++){const i=this.g.get(this.elementType,this._elements[t]);i!=null&&i.isHighlighted()&&e.push(this._elements[t])}return e}generic_presentIn(e,t){const i=[];for(let r=0;r<this._elements.length;r++){const s=this.g.get(this.elementType,this._elements[r]);s!=null&&s.presentIn(e,t)&&i.push(this._elements[r])}return i}generic_sort(e,t){if(this._elements.length==0)return this;const i=this._elements.slice(0);return i.sort((r,s)=>{const c=this.g.get(this.elementType,r),h=this.g.get(this.elementType,s);return c!=null&&h!=null?tn(c,h,e,t):c==null&&h==null?0:c==null?1:-1}),this._elements=i,this}generic_removeDuplicates(){const e=[];for(let t=0;t<this._elements.length;t++)e.indexOf(this._elements[t])==-1&&e.push(this._elements[t]);return this._elements=e,this}}class de{constructor(e,t,i){this._id=e,this.type=t,this.g=i}id(){return this._id}attr(e){return this.g.attr(e,this._id,this.type)}getSelections(){return this.g.attributeArrays[this.type].selections[this._id]}addToSelection(e){this.g.attributeArrays[this.type].selections[this._id].push(e)}removeFromSelection(e){const t=this.g.attributeArrays[this.type].selections[this._id];for(let i=0;i<t.length;i++)t[i]==e&&this.g.attributeArrays[this.type].selections[this._id].splice(i,1)}inSelection(e){return this.getSelections().indexOf(e)>-1}isSelected(e){if(!e)return this.getSelections().length>0;const t=this.g.attributeArrays[this.type].selections[this._id];for(let i=0;i<t.length;i++)if(!(t[i]==this.g.defaultNodeSelection||t[i]==this.g.defaultLinkSelection)&&t[i]==e)return!0;return!1}isHighlighted(){return this.g.isHighlighted(this._id,this.type)}isFrozen(){return this.g.isFrozen(this._id,this.type)}isFiltered(){return this.g.isFiltered(this._id,this.type)}isVisible(){const e=this.getSelections();if(e.length==0)return!0;for(let t=0;t<e.length;t++)if(e[t].filter)return!1;return!0}presentIn(e,t){const i=this.attr("presence");t||(t=e);for(let r=e._id;r<=t._id;r++)if(i.indexOf(r)>-1)return!0;return!1}}class K{constructor(){this.serie={}}period(e,t){const i=e.id(),r=t.id(),s=new K;for(const c in this.serie)parseInt(c)>=i&&parseInt(c)<=r&&(s.serie[c]=this.serie[c]);return s}set(e,t){this.serie[e.id()]=t}get(e){if(this.serie[e.id()]!=null)return this.serie[e.id()]}size(){return this.toArray().length}getSerie(){return this.serie}toArray(e){e==null&&(e=!1);const t=[];if(e)for(const i in this.serie)t.push(this.serie[i]);else for(const i in this.serie)t.indexOf(this.serie[i])==-1&&t.push(this.serie[i]);return t}}class j{constructor(){this.serie={}}period(e,t){const i=e.id();e.id();const r=new j;for(const s in this.serie)parseInt(s)>=i&&parseInt(s)<=i&&(r.serie[s]=this.serie[s]);return r}add(e,t){e!=null&&(this.serie[e._id]||(this.serie[e._id]=[]),this.serie[e._id].push(t))}get(e){return this.serie[e._id]}toArray(){const e=[];for(const t in this.serie)e.push(this.serie[t]);return e}toFlatArray(e){e==null&&(e=!1);const t=[];for(const i in this.serie)for(let r=0;r<this.serie[i].length;r++)(!e||e&&t.indexOf(this.serie[i])==-1)&&t.push(this.serie[i][r]);return t}}class q extends ge{constructor(e,t){if(super(e,t,"time"),e.length>0&&e[0]instanceof ae){this._elements=[];for(let i=0;i<e.length;i++)this._elements.push(e[i].id())}if(e.length>0&&typeof e[0]=="number"){this._elements=[];for(let i=0;i<e.length;i++)this._elements.push(e[i])}}contains(e){return this._elements.indexOf(e.id())>-1}highlighted(){return new q(super.generic_highlighted(),this.g)}visible(){return new q(super.generic_visible(),this.g)}selected(){return new q(super.generic_selected(),this.g)}filter(e){return new q(super.generic_filter(e),this.g)}presentIn(e,t){return new q(super.generic_presentIn(e,t),this.g)}sort(e){return super.generic_sort(e)}links(){let e=[];for(let t=0;t<this._elements.length;t++)e=e.concat(this.g.attr("links",this._elements[t],"time"));return new U(e,this.g)}get(e){return this.g._times[this._elements[e]]}last(){return this.g._times[this._elements[this._elements.length-1]]}toArray(){const e=[],t=this.g._times;for(let i=0;i<this._elements.length;i++)e.push(t[this._elements[i]]);return e}createAttribute(e,t){if(this.g.timeArrays[e]==null){this.g.timeArrays[e]=[];for(let i=0;i<this.g._times.length;i++)this.g.timeArrays[e].push()}for(let i=0;i<this._elements.length;i++)this.g.timeArrays[e][this._elements[i]]=t(this.g._times[this._elements[i]]);return this}unixTimes(){const e=[];for(let t=0;t<this._elements.length;t++){const i=this.g.time(this._elements[t]);i!=null&&e.push(i.unixTime())}return e}intersection(e){return new q(this.generic_intersection(e)._elements,this.g)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this.g.time(this._elements[t]),t);return this}}class ae extends de{constructor(e,t){super(e,"time",t),this.getWeek=V("%V")}time(){return this.attr("momentTime")}moment(){return this.attr("momentTime")}label(){return this.attr("label")}unixTime(){return this.attr("unixTime")}links(){return new U(this.attr("links"),this.g)}year(){return this.time().getUTCFullYear()}month(){return this.time().getUTCMonth()}week(){return parseInt(this.getWeek(this.time()))}day(){return this.time().getUTCDay()}hour(){return this.time().getUTCHours()}minute(){return this.time().getUTCMinutes()}second(){return this.time().getUTCSeconds()}millisecond(){return this.time().getMilliseconds()}format(e){return V(e)(this.time())}}class G extends ge{constructor(e,t){if(super(e,t,"location"),e.length>0&&e[0]instanceof mt){this._elements=[];for(let i=0;i<e.length;i++)this._elements=e[i].id()}if(e.length>0&&typeof e[0]=="number"){this._elements=[];for(let i=0;i<e.length;i++)this._elements.push(e[i])}}contains(e){return this._elements.indexOf(e.id())>-1}highlighted(){return new G(super.generic_highlighted(),this.g)}visible(){return new G(super.generic_visible(),this.g)}selected(){return new G(super.generic_selected(),this.g)}filter(e){return new G(super.generic_filter(e),this.g)}presentIn(e,t){return new G(super.generic_presentIn(e,t),this.g)}sort(e){return super.generic_sort(e)}get(e){return this.g._locations[this._elements[e]]}last(){return this.g._locations[this._elements[this._elements.length-1]]}toArray(){const e=[];for(let t=0;t<this._elements.length;t++)e.push(this.g._locations[this._elements[t]]);return e}createAttribute(e,t){if(this.g.locationArrays[e]==null){this.g.locationArrays[e]=[];for(let i=0;i<this.g._locations.length;i++)this.g.locationArrays[e].push()}for(let i=0;i<this._elements.length;i++)this.g.locationArrays[e][this._elements[i]]=t(this.g._locations[this._elements[i]]);return this}intersection(e){return new G(this.generic_intersection(e)._elements,this.g)}removeDuplicates(){return new G(this.generic_removeDuplicates()._elements,this.g)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this.g.location(this._elements[t]),t);return this}}class Te extends xe{clone(){return this._elements.slice(0)}min(){this._elements=this.makeNumbers(this._elements);let e=parseInt(this._elements[0]+"");for(let t=1;t<this._elements.length;t++)this._elements[t]!=null&&(e=Math.min(e,parseInt(this._elements[t]+"")));return e}max(){let e=parseInt(this._elements[0]+"");for(let t=1;t<this._elements.length;t++)this._elements[t]!=null&&(e=Math.max(e,parseInt(this._elements[t]+"")));return e}mean(){this._elements=this.makeNumbers(this._elements);let e=0,t=0;for(let i=0;i<this._elements.length;i++)typeof this._elements[i]=="number"&&(e+=parseInt(this._elements[i]+""),t++);return e/t}sum(){let e=0;for(let t=0;t<this._elements.length;t++)typeof this._elements[t]=="number"&&(e+=parseInt(this._elements[t]+""));return e}toArray(){return this._elements.slice(0)}get(e){return this._elements[e]}forEach(e){for(let t=0;t<this._elements.length;t++)e(this._elements[t],t);return this}makeNumbers(e){if(e&&e.length>0&&typeof e[0]=="string"){const i=[];for(let r=0;r<e.length;r++)i.push(parseFloat(e[r]+""));return console.log("string array converted",i),i}return e}}class mt extends de{constructor(e,t){super(e,"location",t)}label(){return this.attr("label")+""}longitude(){return this.attr("longitude")}latitude(){return this.attr("latitude")}x(){return this.attr("x")}y(){return this.attr("y")}z(){return this.attr("z")}radius(){return this.attr("radius")}}class B extends ge{constructor(e,t){if(super(e,t,"nodePair"),e.length>0&&e[0]instanceof yt){this._elements=[];for(let i=0;i<e.length;i++)this._elements.push(e[i].id())}if(e.length>0&&typeof e[0]=="number"){this._elements=[];for(let i=0;i<e.length;i++)this._elements.push(e[i])}}contains(e){return this._elements.indexOf(e.id())>-1}highlighted(){return new B(super.generic_highlighted(),this.g)}visible(){return new B(super.generic_visible(),this.g)}selected(){return new B(super.generic_selected(),this.g)}filter(e){return new B(super.generic_filter(e),this.g)}presentIn(e,t){return new B(super.generic_presentIn(e,t),this.g)}sort(e){return super.generic_sort(e)}get(e){return this.g._nodePairs[this._elements[e]]}last(){return this.g._links[this._elements[this._elements.length-1]]}toArray(){const e=[];for(let t=0;t<this._elements.length;t++)e.push(this.g._nodePairs[this._elements[t]]);return e}createAttribute(e,t){if(this.g.nodePairArrays[e]==null){this.g.nodePairArrays[e]=[];for(let i=0;i<this.g._nodePairs.length;i++)this.g.nodePairArrays[e].push()}for(let i=0;i<this._elements.length;i++)this.g.nodePairArrays[e][this._elements[i]]=t(this.g._nodePairs[this._elements[i]]);return this}intersection(e){return new B(this.generic_intersection(e)._elements,this.g)}removeDuplicates(){return new B(this.generic_removeDuplicates()._elements,this.g)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this.g.nodePair(this._elements[t]),t);return this}}class yt extends de{constructor(e,t){super(e,"nodePair",t)}get source(){return this.g._nodes[this.attr("source")]}get target(){return this.g._nodes[this.attr("target")]}links(){return new U(this.attr("links"),this.g)}nodeType(){return this.attr("nodeType")}presentIn(e,t){for(let i=0;i<this.links.length;i++)if(this.links[i].presentIn(e,t))return!0;return!1}}class it{constructor(e){e?this._elements=e.slice(0):this._elements=[]}contains(e){return this._elements.indexOf(e)>-1}addUnique(e){this._elements.indexOf(e)==-1&&this._elements.push(e)}add(e){this._elements.push(e)}addAll(e){for(let t=0;t<e.length;t++)e[t]!=null&&this._elements.push(e[t])}addAllUnique(e){for(let t=0;t<e.length;t++)this.addUnique(e[t])}get length(){return this._elements.length}size(){return this._elements.length}toArray(){return this._elements.slice(0)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this._elements[t],t);return this}}function Ne(n,e,t,i,r,s){let c=[],h;for(let o=0;o<e.length;o++){s!=null&&r!=null?h=i.attr(n,e[o],t).period(r,s).toArray():r!=null?h=[i.attr(n,e[o],t).get(r)]:h=i.attr(n,e[o],t).toArray();for(let f=0;f<h.length;f++)h[f]instanceof Array?c=c.concat(h[f]):c.indexOf(h[f])==-1&&c.push(h[f])}return c}class N extends ge{constructor(e,t){if(super(e,t,"node"),e.length>0&&e[0]instanceof pt){this._elements=[];for(let i=0;i<e.length;i++)this._elements.push(e[i].id())}else if(e.length>0&&typeof e[0]=="number"){this._elements=[];for(let i=0;i<e.length;i++)this._elements.push(e[i])}}contains(e){return this._elements.indexOf(e.id())>-1}highlighted(){return new N(super.generic_highlighted(),this.g)}visible(){return new N(super.generic_visible(),this.g)}selected(){return new N(super.generic_selected(),this.g)}filter(e){return new N(super.generic_filter(e),this.g)}presentIn(e,t){return new N(super.generic_presentIn(e,t),this.g)}sort(e,t){return super.generic_sort(e,t)}label(){const e=new it;for(let t=0;t<this._elements.length;t++)e.add(""+this.g.attr("label",this._elements[t],"node"));return e}neighbors(e,t){return new N(Ne("neighbors",this._elements,"node",this.g,e,t),this.g)}links(e,t){return new U(Ne("links",this._elements,"node",this.g,e,t),this.g)}locations(e,t){return new G(Ne("locations",this._elements,"node",this.g,e,t),this.g)}nodeTypes(){const e=new it;for(let t=0;t<this._elements.length;t++)e.add(this.g.attr("nodeType",this._elements[t],"node"));return e}get(e){return this.g._nodes[this._elements[e]]}last(){return this.g._nodes[this._elements[this._elements.length-1]]}toArray(){const e=[];for(let t=0;t<this._elements.length;t++)e.push(this.g._nodes[this._elements[t]]);return e}createAttribute(e,t){if(this.g.nodeArrays[e]==null){this.g.nodeArrays[e]=[];for(let i=0;i<this.g._nodes.length;i++)this.g.nodeArrays[e].push()}for(let i=0;i<this._elements.length;i++)this.g.nodeArrays[e][this._elements[i]]=t(this.g._nodes[this._elements[i]]);return this}intersection(e){return new N(this.generic_intersection(e)._elements,this.g)}removeDuplicates(){return new N(this.generic_removeDuplicates()._elements,this.g)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this.g.node(this._elements[t]),t);return this}}class pt extends de{constructor(e,t){super(e,"node",t)}label(){return""+this.attr("label")}shape(){return""+this.attr("shape")}color(){return""+this.attr("color")}nodeType(){return this.attr("nodeType")}neighbors(e,t){return t!=null&&e!=null?new N(this.attr("neighbors").period(e,t).toFlatArray(!0),this.g):e!=null?new N(this.attr("neighbors").get(e),this.g):new N(this.attr("neighbors").toFlatArray(),this.g)}inNeighbors(e,t){return t!=null&&e!=null?new N(this.attr("inNeighbors").period(e,t).toFlatArray(!0),this.g):e!=null?new N(this.attr("inNeighbors").get(e),this.g):new N(this.attr("inNeighbors").toFlatArray(!0),this.g)}outNeighbors(e,t){return t!=null&&e!=null?new N(this.attr("outNeighbors").period(e,t).toFlatArray(!0),this.g):e!=null?new N(this.attr("outNeighbors").get(e),this.g):new N(this.attr("outNeighbors").toFlatArray(),this.g)}links(e,t){return t!=null&&e!=null?new U(this.attr("links").period(e,t).toFlatArray(!0),this.g):e!=null?new U(this.attr("links").get(e),this.g):new U(this.attr("links").toFlatArray(!0),this.g)}inLinks(e,t){return t!=null&&e!=null?new U(this.attr("inLinks").period(e,t).toFlatArray(!0),this.g):e!=null?new U(this.attr("inLinks").get(e),this.g):new U(this.attr("inLinks").toFlatArray(!0),this.g)}outLinks(e,t){return t!=null&&e!=null?new U(this.attr("outLinks").period(e,t).toFlatArray(!0),this.g):e!=null?new U(this.attr("outLinks").get(e),this.g):new U(this.attr("outLinks").toFlatArray(!0),this.g)}locations(e,t){return t!=null&&e!=null?new G(this.attr("locations").period(e,t).toArray(),this.g):e!=null?new G([this.attr("locations").get(e)],this.g):new G(this.attr("locations").toArray(),this.g)}locationSerie(e,t){let i;t!=null&&e!=null?i=this.attr("locations").period(e,t):e!=null?i=this.attr("locations").get(e):i=this.attr("locations");const r=i.getSerie(),s=new K;for(const c in r){const h=this.g.time(parseInt(c)),o=this.g.location(r[c]);h!=null&&o!=null&&s.set(h,o)}return s}linksBetween(e){const t=this.links().toArray(),i=[];let r;for(let s=0;s<t.length;s++)r=t[s],(r.source==e||r.target==e)&&i.push(r);return new U(i,this.g)}}class U extends ge{constructor(e,t){if(super(e,t,"link"),e.length>0&&e[0]instanceof At){this._elements=[];for(let i=0;i<e.length;i++)this._elements.push(e[i].id())}if(e.length>0&&typeof e[0]=="number"){this._elements=[];for(let i=0;i<e.length;i++)this._elements.push(e[i])}}contains(e){return this._elements.indexOf(e.id())>-1}highlighted(){return new U(super.generic_highlighted(),this.g)}visible(){return new U(super.generic_visible(),this.g)}selected(){return new U(super.generic_selected(),this.g)}filter(e){return new U(super.generic_filter(e),this.g)}presentIn(e,t){return new U(super.generic_presentIn(e,t),this.g)}sort(e){return super.generic_sort(e)}get(e){return this.g._links[this._elements[e]]}last(){return this.g._links[this._elements[this._elements.length-1]]}toArray(){const e=[];for(let t=0;t<this._elements.length;t++)e.push(this.g._links[this._elements[t]]);return e}weights(e,t){const i=new Te;for(let r=0;r<this._elements.length;r++){const s=this.g.link(r);s!=null&&i.addAll(s.weights(e,t).toArray())}return i}createAttribute(e,t){if(this.g.linkArrays[e]==null){this.g.linkArrays[e]=[];for(let i=0;i<this.g._links.length;i++)this.g.linkArrays[e].push()}for(let i=0;i<this._elements.length;i++)this.g.linkArrays[e][this._elements[i]]=t(this.g._links[this._elements[i]]);return this}linkTypes(){const e=[];let t;for(let i=0;i<this._elements.length;i++){const r=this.g.link(this._elements[i]);r!=null&&(t=r.linkType(),e.indexOf(t)==-1&&e.push(t))}return e}sources(){const e=[];let t;for(let i=0;i<this._elements.length;i++)t=this.g.link(this._elements[i]),t!=null&&e.indexOf(t.source.id())==-1&&e.push(t.source.id());return new N(e,this.g)}targets(){const e=[];let t;for(let i=0;i<this._elements.length;i++)t=this.g.link(this._elements[i]),t!=null&&e.indexOf(t.target.id())==-1&&e.push(t.target.id());return new N(e,this.g)}intersection(e){return new U(this.generic_intersection(e)._elements,this.g)}removeDuplicates(){return new U(this.generic_removeDuplicates()._elements,this.g)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this.g.link(this._elements[t]),t);return this}}class At extends de{constructor(e,t){super(e,"link",t),this.targetNPO=void 0,this.sourceNPO=void 0}linkType(){return this.attr("linkType")}get source(){return this.g._nodes[this.attr("source")]}get target(){return this.g._nodes[this.attr("target")]}nodePair(){return this.g._nodePairs[this.attr("nodePair")]}directed(){return this.attr("directed")}other(e){return this.source==e?this.target:this.source}weights(e,t){return e==null?new Te(this.attr("weights").toArray()):t==null?new Te([this.attr("weights").get(e)]):new Te(this.attr("weights").period(e,t).toArray())}presentIn(e,t){return this.weights(e,t).toArray().length>0}times(){return new q(this.attr("presence"),this.g)}}function tn(n,e,t,i){const r=n.attr(t);let s;return typeof r=="string"?s=n.attr(t).localeCompare(e.attr(t)):typeof r=="number"?s=e.attr(t)-n.attr(t):s=0,i==!1&&(s=-s),s}class ce{constructor(){this.nodeIds=[],this.linkIds=[],this.timeIds=[],this.nodePairIds=[],this.locationIds=[]}}function X(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}function nn(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))for(const i in n[t])Object.prototype.hasOwnProperty.call(n[t],i)&&(e[t][i]=n[t][i]);return e}function _e(n,e){const t=[];for(const i in n)t.push(nn(n[i],e()));return t}function C(n,e,t){let i=!0;if(n==null||e==null)return n==e;if(typeof n!=typeof e)return!1;if(typeof n!="object")return!0;if(n.constructor!==e.constructor)return!1;if(t>0)for(const r in n)r in e&&Object.prototype.hasOwnProperty.call(n,r)&&Object.prototype.hasOwnProperty.call(e,r)&&!C(n[r],e[r],t-1)&&(console.log("compareFailed for key",r,n[r],e[r]),i=!1);return i}function rn(n,e){return n-e}function sn(n,e){const t=[];for(;e--;)t[e]=n;return t}function un(n,e){return n.priority-e.priority}function on(){const n={},e=window.location.search.replace("?","").split("&");let t,i;return e.forEach(function(r){t=r.split("="),i=decodeURIComponent(t[1]),n[t[0]]=i}),n}function fn(n){const e=new ce;return n!=null&&(n.nodes&&(e.nodeIds=n.nodes.map(t=>t.id())),n.links&&(e.linkIds=n.links.map(t=>t.id())),n.times&&(e.timeIds=n.times.map(t=>t.id())),n.nodePairs&&(e.nodePairIds=n.nodePairs.map(t=>t.id()))),e}var Ce={exports:{}};(function(n){var e=function(){var t=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function c(o,f){if(!s[o]){s[o]={};for(var p=0;p<o.length;p++)s[o][o.charAt(p)]=p}return s[o][f]}var h={compressToBase64:function(o){if(o==null)return"";var f=h._compress(o,6,function(p){return i.charAt(p)});switch(f.length%4){default:case 0:return f;case 1:return f+"===";case 2:return f+"==";case 3:return f+"="}},decompressFromBase64:function(o){return o==null?"":o==""?null:h._decompress(o.length,32,function(f){return c(i,o.charAt(f))})},compressToUTF16:function(o){return o==null?"":h._compress(o,15,function(f){return t(f+32)})+" "},decompressFromUTF16:function(o){return o==null?"":o==""?null:h._decompress(o.length,16384,function(f){return o.charCodeAt(f)-32})},compressToUint8Array:function(o){for(var f=h.compress(o),p=new Uint8Array(f.length*2),m=0,g=f.length;m<g;m++){var S=f.charCodeAt(m);p[m*2]=S>>>8,p[m*2+1]=S%256}return p},decompressFromUint8Array:function(o){if(o==null)return h.decompress(o);for(var f=new Array(o.length/2),p=0,m=f.length;p<m;p++)f[p]=o[p*2]*256+o[p*2+1];var g=[];return f.forEach(function(S){g.push(t(S))}),h.decompress(g.join(""))},compressToEncodedURIComponent:function(o){return o==null?"":h._compress(o,6,function(f){return r.charAt(f)})},decompressFromEncodedURIComponent:function(o){return o==null?"":o==""?null:(o=o.replace(/ /g,"+"),h._decompress(o.length,32,function(f){return c(r,o.charAt(f))}))},compress:function(o){return h._compress(o,16,function(f){return t(f)})},_compress:function(o,f,p){if(o==null)return"";var m,g,S={},E={},F="",v="",w="",I=2,x=3,T=2,M=[],u=0,A=0,y;for(y=0;y<o.length;y+=1)if(F=o.charAt(y),Object.prototype.hasOwnProperty.call(S,F)||(S[F]=x++,E[F]=!0),v=w+F,Object.prototype.hasOwnProperty.call(S,v))w=v;else{if(Object.prototype.hasOwnProperty.call(E,w)){if(w.charCodeAt(0)<256){for(m=0;m<T;m++)u=u<<1,A==f-1?(A=0,M.push(p(u)),u=0):A++;for(g=w.charCodeAt(0),m=0;m<8;m++)u=u<<1|g&1,A==f-1?(A=0,M.push(p(u)),u=0):A++,g=g>>1}else{for(g=1,m=0;m<T;m++)u=u<<1|g,A==f-1?(A=0,M.push(p(u)),u=0):A++,g=0;for(g=w.charCodeAt(0),m=0;m<16;m++)u=u<<1|g&1,A==f-1?(A=0,M.push(p(u)),u=0):A++,g=g>>1}I--,I==0&&(I=Math.pow(2,T),T++),delete E[w]}else for(g=S[w],m=0;m<T;m++)u=u<<1|g&1,A==f-1?(A=0,M.push(p(u)),u=0):A++,g=g>>1;I--,I==0&&(I=Math.pow(2,T),T++),S[v]=x++,w=String(F)}if(w!==""){if(Object.prototype.hasOwnProperty.call(E,w)){if(w.charCodeAt(0)<256){for(m=0;m<T;m++)u=u<<1,A==f-1?(A=0,M.push(p(u)),u=0):A++;for(g=w.charCodeAt(0),m=0;m<8;m++)u=u<<1|g&1,A==f-1?(A=0,M.push(p(u)),u=0):A++,g=g>>1}else{for(g=1,m=0;m<T;m++)u=u<<1|g,A==f-1?(A=0,M.push(p(u)),u=0):A++,g=0;for(g=w.charCodeAt(0),m=0;m<16;m++)u=u<<1|g&1,A==f-1?(A=0,M.push(p(u)),u=0):A++,g=g>>1}I--,I==0&&(I=Math.pow(2,T),T++),delete E[w]}else for(g=S[w],m=0;m<T;m++)u=u<<1|g&1,A==f-1?(A=0,M.push(p(u)),u=0):A++,g=g>>1;I--,I==0&&(I=Math.pow(2,T),T++)}for(g=2,m=0;m<T;m++)u=u<<1|g&1,A==f-1?(A=0,M.push(p(u)),u=0):A++,g=g>>1;for(;;)if(u=u<<1,A==f-1){M.push(p(u));break}else A++;return M.join("")},decompress:function(o){return o==null?"":o==""?null:h._decompress(o.length,32768,function(f){return o.charCodeAt(f)})},_decompress:function(o,f,p){var m=[],g=4,S=4,E=3,F="",v=[],w,I,x,T,M,u,A,y={val:p(0),position:f,index:1};for(w=0;w<3;w+=1)m[w]=w;for(x=0,M=Math.pow(2,2),u=1;u!=M;)T=y.val&y.position,y.position>>=1,y.position==0&&(y.position=f,y.val=p(y.index++)),x|=(T>0?1:0)*u,u<<=1;switch(x){case 0:for(x=0,M=Math.pow(2,8),u=1;u!=M;)T=y.val&y.position,y.position>>=1,y.position==0&&(y.position=f,y.val=p(y.index++)),x|=(T>0?1:0)*u,u<<=1;A=t(x);break;case 1:for(x=0,M=Math.pow(2,16),u=1;u!=M;)T=y.val&y.position,y.position>>=1,y.position==0&&(y.position=f,y.val=p(y.index++)),x|=(T>0?1:0)*u,u<<=1;A=t(x);break;case 2:return""}for(m[3]=A,I=A,v.push(A);;){if(y.index>o)return"";for(x=0,M=Math.pow(2,E),u=1;u!=M;)T=y.val&y.position,y.position>>=1,y.position==0&&(y.position=f,y.val=p(y.index++)),x|=(T>0?1:0)*u,u<<=1;switch(A=x){case 0:for(x=0,M=Math.pow(2,8),u=1;u!=M;)T=y.val&y.position,y.position>>=1,y.position==0&&(y.position=f,y.val=p(y.index++)),x|=(T>0?1:0)*u,u<<=1;m[S++]=t(x),A=S-1,g--;break;case 1:for(x=0,M=Math.pow(2,16),u=1;u!=M;)T=y.val&y.position,y.position>>=1,y.position==0&&(y.position=f,y.val=p(y.index++)),x|=(T>0?1:0)*u,u<<=1;m[S++]=t(x),A=S-1,g--;break;case 2:return v.join("")}if(g==0&&(g=Math.pow(2,E),E++),m[A])F=m[A];else if(A===S)F=I+I.charAt(0);else return null;v.push(F),m[S++]=I+F.charAt(0),g--,I=F,g==0&&(g=Math.pow(2,E),E++)}}};return h}();n!=null&&(n.exports=e)})(Ce);class hn{constructor(e){this.keepOnlyOneSession=!1,this.session="",this.sessionDataPrefix="ncubesession",this.SEP="_",e?e.keepOnlyOneSession&&this.setOptions(e):this.keepOnlyOneSession=!1}setOptions(e){this.keepOnlyOneSession=e.keepOnlyOneSession}clearSessionData(e){const t=this.sessionDataPrefix+this.SEP+e,i=[];for(let r=0;r<localStorage.length;r++){const s=localStorage.key(r);!s||(s.indexOf(t)==0||s.indexOf("connectoscope1")==0)&&i.push(s)}for(let r=0;r<i.length;r++){const s=i[r];localStorage.removeItem(s)}}clearAllSessionData(){this.clearSessionData("")}isSessionCached(e,t){const i=this.sessionDataPrefix+this.SEP+e+this.SEP+t;for(let r=0;r<localStorage.length;r++){const s=localStorage.key(r);if(s&&s.indexOf(i)==0)return!0}return!1}importData(e,t){if(this.session=e,!t.nodeTable&&!t.linkTable){console.log("Empty tables. No data imported.");return}t.nodeTable||console.log("[n3] Node table missing!"),t.linkTable||console.log("[n3] Link table missing!"),t.nodeSchema||console.log("[n3] Node schema missing!"),t.linkSchema||console.log("[n3] Link schema missing!");for(let i=0;i<t.nodeTable.length;i++)for(let r=0;r<t.nodeTable[i].length;r++)typeof t.nodeTable[i][r]=="string"&&(t.nodeTable[i][r]=t.nodeTable[i][r].trim());for(let i=0;i<t.linkTable.length;i++)for(let r=0;r<t.linkTable[i].length;r++)typeof t.linkTable[i][r]=="string"&&(t.linkTable[i][r]=t.linkTable[i][r].trim());if(this.isSchemaWellDefined(t)){console.log("data is well-schematized, caching dynamicGraph"),this.keepOnlyOneSession&&this.clearAllSessionData();const i=new z;i.initDynamicGraph(t),i.saveDynamicGraph(this)}else console.log("data is not well-schematized, so not caching dynamicGraph")}saveToStorage(e,t,i,r){if(i==null){console.log("attempting to save undefined value. aborting",e,t);return}const s=JSON.stringify(i,r);let c;s.length>1024*1024*4?c=Ce.exports.compress(s):c=s,localStorage[this.sessionDataPrefix+this.SEP+this.session+this.SEP+e+this.SEP+t]=c}getFromStorage(e,t,i,r){console.assert(this.session!="");let s;i?s=function(h,o){return i(h,o,r)}:s=void 0;const c=localStorage[this.sessionDataPrefix+this.SEP+this.session+this.SEP+e+this.SEP+t];if(c&&c!="undefined"){let h;return c=="true"?h=!0:c=="false"?h=!1:`"'[{0123456789`.indexOf(c[0])>=0?h=c:h=Ce.exports.decompress(c),JSON.parse(h,s)}else return}removeFromStorage(e,t){localStorage.removeItem(this.sessionDataPrefix+this.SEP+this.session+this.SEP+e+this.SEP+t)}getGraph(e,t){return this.session=e,(!this.dynamicGraph||this.dynamicGraph.name!=t)&&(this.dynamicGraph=new z,this.dynamicGraph.loadDynamicGraph(this,t)),this.dynamicGraph}isSchemaWellDefined(e){return console.log("isSchemaWellDefined"),!(e.locationTable&&!D(e.locationSchema.id)||e.nodeTable.length>0&&!D(e.nodeSchema.id)||e.linkTable.length>0&&!(D(e.linkSchema.id)&&D(e.linkSchema.source)&&D(e.linkSchema.target)))}}function gn(){return we}let me;typeof window<"u"&&(window.dataManager||(window.dataManager=new hn),me=window.dataManager);let ke;function dn(n){me.setOptions(n)}function mn(n,e){console.log("[n3] Import data",e.name),ke=n,me.importData(n,e)}function ln(n,e){const t=on();return n||(n=t.datasetName),e?ke=e:ke=t.session,me.getGraph(ke,n)}function yn(n){ln(n).delete(me)}export{an as D,ce as I,Ki as L,Ji as N,Vi as a,D as b,Xi as c,yn as d,cn as e,$i as f,ln as g,Qi as h,mn as i,un as j,fn as m,dn as s,gn as t};
