!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("reorder.js"),require("netclustering"),require("three")):"function"==typeof define&&define.amd?define(["exports","reorder.js","netclustering","three"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).vc={},t.reorder,t.netClustering,t.THREE)}(this,(function(t,e,n,i){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function s(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var o=s(e),a=r(n),l=s(i);function h(t){return null!=t&&t>-1}class c{constructor(t,e){this.color="#3366cc",this.showColor=!0,this.filter=!1,this.priority=0,this.id=t,this.name="Selection-"+this.id,this.elementIds=[],this.acceptedType=e,this.priority=t}acceptsType(t){return this.acceptedType==t}}class u{constructor(t){this.locationTable=[],this.selections=[],this.timeFormat="",this.name=t.name,this.nodeTable=t.nodeTable,this.linkTable=t.linkTable,this.directed=t.directed,null==t.nodeSchema?this.nodeSchema=d():this.nodeSchema=t.nodeSchema,null==t.linkSchema?this.linkSchema=f():this.linkSchema=t.linkSchema,null!=t.locationTable&&(this.locationTable=t.locationTable),null==t.locationSchema?this.locationSchema=g():this.locationSchema=t.locationSchema,console.log("[n3] data set created",this)}}function d(){return new p(0)}function f(){return new y(0,1,2)}function g(){return new _(0,1,2,3,4,5,6,7,8)}class m{constructor(t){this.name=t}}class p extends m{constructor(t){super("nodeSchema"),this.label=-1,this.time=-1,this.location=-1,this.nodeType=-1,this.shape=-1,this.color=-1,this.id=t}}class y extends m{constructor(t,e,n){super("linkSchema"),this.weight=-1,this.linkType=-1,this.directed=-1,this.time=-1,this.source=e,this.target=n,this.id=t}}class _ extends m{constructor(t,e,n,i,r,s,o,a,l){super("locationSchema"),this.geoname=-1,this.longitude=-1,this.latitude=-1,this.x=-1,this.y=-1,this.z=-1,this.radius=-1,this.id=t,this.label=e,h(n)&&(this.geoname=null!=n?n:-1),h(i)&&(this.longitude=null!=i?i:-1),h(r)&&(this.latitude=null!=r?r:-1),h(s)&&(this.x=null!=s?s:-1),h(o)&&(this.y=null!=o?o:-1),h(a)&&(this.z=null!=a?a:-1),h(l)&&(this.radius=null!=l?l:-1)}}var w=Object.freeze({__proto__:null,isValidIndex:h,Selection:c,DataSet:u,getDefaultNodeSchema:d,getDefaultLinkSchema:f,getDefaultLocationSchema:g,TableSchema:m,NodeSchema:p,LinkSchema:y,LocationSchema:_}),v=new Date,b=new Date;function x(t,e,n,i){function r(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return r.floor=function(e){return t(e=new Date(+e)),e},r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},r.range=function(n,i,s){var o,a=[];if(n=r.ceil(n),s=null==s?1:Math.floor(s),!(n<i&&s>0))return a;do{a.push(o=new Date(+n)),e(n,s),t(n)}while(o<n&&n<i);return a},r.filter=function(n){return x((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,i){if(t>=t)if(i<0)for(;++i<=0;)for(;e(t,-1),!n(t););else for(;--i>=0;)for(;e(t,1),!n(t););}))},n&&(r.count=function(e,i){return v.setTime(+e),b.setTime(+i),t(v),t(b),Math.floor(n(v,b))},r.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?function(e){return i(e)%t==0}:function(e){return r.count(0,e)%t==0}):r:null}),r}var A=x((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));A.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?x((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):A:null};var T=A;const S=1e3,k=6e4,M=36e5,E=864e5,I=6048e5,O=2592e6,N=31536e6;var C=x((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*S)}),(function(t,e){return(e-t)/S}),(function(t){return t.getUTCSeconds()})),L=C,D=x((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*S)}),(function(t,e){t.setTime(+t+e*k)}),(function(t,e){return(e-t)/k}),(function(t){return t.getMinutes()})),P=D,F=x((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*S-t.getMinutes()*k)}),(function(t,e){t.setTime(+t+e*M)}),(function(t,e){return(e-t)/M}),(function(t){return t.getHours()})),R=F,H=x((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*k)/E),(t=>t.getDate()-1)),G=H;function U(t){return x((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*k)/I}))}var B=U(0),j=U(1);U(2),U(3);var z=U(4);U(5),U(6);var W=x((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),X=W,V=x((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));V.every=function(t){return isFinite(t=Math.floor(t))&&t>0?x((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Y=V,q=x((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*k)}),(function(t,e){return(e-t)/k}),(function(t){return t.getUTCMinutes()})),Q=q,$=x((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*M)}),(function(t,e){return(e-t)/M}),(function(t){return t.getUTCHours()})),K=$,Z=x((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/E}),(function(t){return t.getUTCDate()-1})),J=Z;function tt(t){return x((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/I}))}var et=tt(0),nt=tt(1);tt(2),tt(3);var it=tt(4);tt(5),tt(6);var rt=x((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),st=rt,ot=x((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));ot.every=function(t){return isFinite(t=Math.floor(t))&&t>0?x((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var at=ot;function lt(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ht(t){let e=t,n=t,i=t;function r(t,e,r=0,s=t.length){if(r<s){if(0!==n(e,e))return s;do{const n=r+s>>>1;i(t[n],e)<0?r=n+1:s=n}while(r<s)}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=lt,i=(e,n)=>lt(t(e),n)),{left:r,center:function(t,n,i=0,s=t.length){const o=r(t,n,i,s-1);return o>i&&e(t[o-1],n)>-e(t[o],n)?o-1:o},right:function(t,e,r=0,s=t.length){if(r<s){if(0!==n(e,e))return s;do{const n=r+s>>>1;i(t[n],e)<=0?r=n+1:s=n}while(r<s)}return r}}}const ct=ht(lt).right;ht((function(t){return null===t?NaN:+t})).center;var ut=ct,dt=Math.sqrt(50),ft=Math.sqrt(10),gt=Math.sqrt(2);function mt(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=dt?10:s>=ft?5:s>=gt?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=dt?10:s>=ft?5:s>=gt?2:1)}function pt(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=dt?r*=10:s>=ft?r*=5:s>=gt&&(r*=2),e<t?-r:r}function yt(t,e,n,i,r,s){const o=[[L,1,S],[L,5,5e3],[L,15,15e3],[L,30,3e4],[s,1,k],[s,5,3e5],[s,15,9e5],[s,30,18e5],[r,1,M],[r,3,108e5],[r,6,216e5],[r,12,432e5],[i,1,E],[i,2,1728e5],[n,1,I],[e,1,O],[e,3,7776e6],[t,1,N]];function a(e,n,i){const r=Math.abs(n-e)/i,s=ht((([,,t])=>t)).right(o,r);if(s===o.length)return t.every(pt(e/N,n/N,i));if(0===s)return T.every(Math.max(pt(e,n,i),1));const[a,l]=o[r/o[s-1][2]<o[s][2]/r?s-1:s];return a.every(l)}return[function(t,e,n){const i=e<t;i&&([t,e]=[e,t]);const r=n&&"function"==typeof n.range?n:a(t,e,n),s=r?r.range(t,+e+1):[];return i?s.reverse():s},a]}const[_t,wt]=yt(at,st,et,J,K,Q);function vt(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function bt(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function xt(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}yt(Y,X,B,G,R,P);var At,Tt,St,kt,Mt={"-":"",_:" ",0:"0"},Et=/^\s*\d+/,It=/^%/,Ot=/[\\^$*+?|[\]().{}]/g;function Nt(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(e)+r:r)}function Ct(t){return t.replace(Ot,"\\$&")}function Lt(t){return new RegExp("^(?:"+t.map(Ct).join("|")+")","i")}function Dt(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function Pt(t,e,n){var i=Et.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Ft(t,e,n){var i=Et.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function Rt(t,e,n){var i=Et.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function Ht(t,e,n){var i=Et.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function Gt(t,e,n){var i=Et.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function Ut(t,e,n){var i=Et.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Bt(t,e,n){var i=Et.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function jt(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function zt(t,e,n){var i=Et.exec(e.slice(n,n+1));return i?(t.q=3*i[0]-3,n+i[0].length):-1}function Wt(t,e,n){var i=Et.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function Xt(t,e,n){var i=Et.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function Vt(t,e,n){var i=Et.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function Yt(t,e,n){var i=Et.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function qt(t,e,n){var i=Et.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Qt(t,e,n){var i=Et.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function $t(t,e,n){var i=Et.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Kt(t,e,n){var i=Et.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function Zt(t,e,n){var i=It.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function Jt(t,e,n){var i=Et.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function te(t,e,n){var i=Et.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function ee(t,e){return Nt(t.getDate(),e,2)}function ne(t,e){return Nt(t.getHours(),e,2)}function ie(t,e){return Nt(t.getHours()%12||12,e,2)}function re(t,e){return Nt(1+G.count(Y(t),t),e,3)}function se(t,e){return Nt(t.getMilliseconds(),e,3)}function oe(t,e){return se(t,e)+"000"}function ae(t,e){return Nt(t.getMonth()+1,e,2)}function le(t,e){return Nt(t.getMinutes(),e,2)}function he(t,e){return Nt(t.getSeconds(),e,2)}function ce(t){var e=t.getDay();return 0===e?7:e}function ue(t,e){return Nt(B.count(Y(t)-1,t),e,2)}function de(t){var e=t.getDay();return e>=4||0===e?z(t):z.ceil(t)}function fe(t,e){return t=de(t),Nt(z.count(Y(t),t)+(4===Y(t).getDay()),e,2)}function ge(t){return t.getDay()}function me(t,e){return Nt(j.count(Y(t)-1,t),e,2)}function pe(t,e){return Nt(t.getFullYear()%100,e,2)}function ye(t,e){return Nt((t=de(t)).getFullYear()%100,e,2)}function _e(t,e){return Nt(t.getFullYear()%1e4,e,4)}function we(t,e){var n=t.getDay();return Nt((t=n>=4||0===n?z(t):z.ceil(t)).getFullYear()%1e4,e,4)}function ve(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Nt(e/60|0,"0",2)+Nt(e%60,"0",2)}function be(t,e){return Nt(t.getUTCDate(),e,2)}function xe(t,e){return Nt(t.getUTCHours(),e,2)}function Ae(t,e){return Nt(t.getUTCHours()%12||12,e,2)}function Te(t,e){return Nt(1+J.count(at(t),t),e,3)}function Se(t,e){return Nt(t.getUTCMilliseconds(),e,3)}function ke(t,e){return Se(t,e)+"000"}function Me(t,e){return Nt(t.getUTCMonth()+1,e,2)}function Ee(t,e){return Nt(t.getUTCMinutes(),e,2)}function Ie(t,e){return Nt(t.getUTCSeconds(),e,2)}function Oe(t){var e=t.getUTCDay();return 0===e?7:e}function Ne(t,e){return Nt(et.count(at(t)-1,t),e,2)}function Ce(t){var e=t.getUTCDay();return e>=4||0===e?it(t):it.ceil(t)}function Le(t,e){return t=Ce(t),Nt(it.count(at(t),t)+(4===at(t).getUTCDay()),e,2)}function De(t){return t.getUTCDay()}function Pe(t,e){return Nt(nt.count(at(t)-1,t),e,2)}function Fe(t,e){return Nt(t.getUTCFullYear()%100,e,2)}function Re(t,e){return Nt((t=Ce(t)).getUTCFullYear()%100,e,2)}function He(t,e){return Nt(t.getUTCFullYear()%1e4,e,4)}function Ge(t,e){var n=t.getUTCDay();return Nt((t=n>=4||0===n?it(t):it.ceil(t)).getUTCFullYear()%1e4,e,4)}function Ue(){return"+0000"}function Be(){return"%"}function je(t){return+t}function ze(t){return Math.floor(+t/1e3)}function We(t){return t}At=function(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,s=t.days,o=t.shortDays,a=t.months,l=t.shortMonths,h=Lt(r),c=Dt(r),u=Lt(s),d=Dt(s),f=Lt(o),g=Dt(o),m=Lt(a),p=Dt(a),y=Lt(l),_=Dt(l),w={a:function(t){return o[t.getDay()]},A:function(t){return s[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:ee,e:ee,f:oe,g:ye,G:we,H:ne,I:ie,j:re,L:se,m:ae,M:le,p:function(t){return r[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:je,s:ze,S:he,u:ce,U:ue,V:fe,w:ge,W:me,x:null,X:null,y:pe,Y:_e,Z:ve,"%":Be},v={a:function(t){return o[t.getUTCDay()]},A:function(t){return s[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:be,e:be,f:ke,g:Re,G:Ge,H:xe,I:Ae,j:Te,L:Se,m:Me,M:Ee,p:function(t){return r[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:je,s:ze,S:Ie,u:Oe,U:Ne,V:Le,w:De,W:Pe,x:null,X:null,y:Fe,Y:He,Z:Ue,"%":Be},b={a:function(t,e,n){var i=f.exec(e.slice(n));return i?(t.w=g.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){var i=u.exec(e.slice(n));return i?(t.w=d.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){var i=y.exec(e.slice(n));return i?(t.m=_.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){var i=m.exec(e.slice(n));return i?(t.m=p.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,n,i){return T(t,e,n,i)},d:Xt,e:Xt,f:Kt,g:Bt,G:Ut,H:Yt,I:Yt,j:Vt,L:$t,m:Wt,M:qt,p:function(t,e,n){var i=h.exec(e.slice(n));return i?(t.p=c.get(i[0].toLowerCase()),n+i[0].length):-1},q:zt,Q:Jt,s:te,S:Qt,u:Ft,U:Rt,V:Ht,w:Pt,W:Gt,x:function(t,e,i){return T(t,n,e,i)},X:function(t,e,n){return T(t,i,e,n)},y:Bt,Y:Ut,Z:jt,"%":Zt};function x(t,e){return function(n){var i,r,s,o=[],a=-1,l=0,h=t.length;for(n instanceof Date||(n=new Date(+n));++a<h;)37===t.charCodeAt(a)&&(o.push(t.slice(l,a)),null!=(r=Mt[i=t.charAt(++a)])?i=t.charAt(++a):r="e"===i?" ":"0",(s=e[i])&&(i=s(n,r)),o.push(i),l=a+1);return o.push(t.slice(l,a)),o.join("")}}function A(t,e){return function(n){var i,r,s=xt(1900,void 0,1);if(T(s,t,n+="",0)!=n.length)return null;if("Q"in s)return new Date(s.Q);if("s"in s)return new Date(1e3*s.s+("L"in s?s.L:0));if(e&&!("Z"in s)&&(s.Z=0),"p"in s&&(s.H=s.H%12+12*s.p),void 0===s.m&&(s.m="q"in s?s.q:0),"V"in s){if(s.V<1||s.V>53)return null;"w"in s||(s.w=1),"Z"in s?(r=(i=bt(xt(s.y,0,1))).getUTCDay(),i=r>4||0===r?nt.ceil(i):nt(i),i=J.offset(i,7*(s.V-1)),s.y=i.getUTCFullYear(),s.m=i.getUTCMonth(),s.d=i.getUTCDate()+(s.w+6)%7):(r=(i=vt(xt(s.y,0,1))).getDay(),i=r>4||0===r?j.ceil(i):j(i),i=G.offset(i,7*(s.V-1)),s.y=i.getFullYear(),s.m=i.getMonth(),s.d=i.getDate()+(s.w+6)%7)}else("W"in s||"U"in s)&&("w"in s||(s.w="u"in s?s.u%7:"W"in s?1:0),r="Z"in s?bt(xt(s.y,0,1)).getUTCDay():vt(xt(s.y,0,1)).getDay(),s.m=0,s.d="W"in s?(s.w+6)%7+7*s.W-(r+5)%7:s.w+7*s.U-(r+6)%7);return"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,bt(s)):vt(s)}}function T(t,e,n,i){for(var r,s,o=0,a=e.length,l=n.length;o<a;){if(i>=l)return-1;if(37===(r=e.charCodeAt(o++))){if(r=e.charAt(o++),!(s=b[r in Mt?e.charAt(o++):r])||(i=s(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return w.x=x(n,w),w.X=x(i,w),w.c=x(e,w),v.x=x(n,v),v.X=x(i,v),v.c=x(e,v),{format:function(t){var e=x(t+="",w);return e.toString=function(){return t},e},parse:function(t){var e=A(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=x(t+="",v);return e.toString=function(){return t},e},utcParse:function(t){var e=A(t+="",!0);return e.toString=function(){return t},e}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Tt=At.format,St=At.parse,kt=At.utcFormat;var Xe=1e-6;function Ve(t){return"translate("+t+",0)"}function Ye(t){return"translate(0,"+t+")"}function qe(t){return e=>+t(e)}function Qe(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function $e(){return!this.__axis}function Ke(t,e){var n=[],i=null,r=null,s=6,o=6,a=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,h=1===t||4===t?-1:1,c=4===t||2===t?"x":"y",u=1===t||3===t?Ve:Ye;function d(d){var f=null==i?e.ticks?e.ticks.apply(e,n):e.domain():i,g=null==r?e.tickFormat?e.tickFormat.apply(e,n):We:r,m=Math.max(s,0)+a,p=e.range(),y=+p[0]+l,_=+p[p.length-1]+l,w=(e.bandwidth?Qe:qe)(e.copy(),l),v=d.selection?d.selection():d,b=v.selectAll(".domain").data([null]),x=v.selectAll(".tick").data(f,e).order(),A=x.exit(),T=x.enter().append("g").attr("class","tick"),S=x.select("line"),k=x.select("text");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(T),S=S.merge(T.append("line").attr("stroke","currentColor").attr(c+"2",h*s)),k=k.merge(T.append("text").attr("fill","currentColor").attr(c,h*m).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),d!==v&&(b=b.transition(d),x=x.transition(d),S=S.transition(d),k=k.transition(d),A=A.transition(d).attr("opacity",Xe).attr("transform",(function(t){return isFinite(t=w(t))?u(t+l):this.getAttribute("transform")})),T.attr("opacity",Xe).attr("transform",(function(t){var e=this.parentNode.__axis;return u((e&&isFinite(e=e(t))?e:w(t))+l)}))),A.remove(),b.attr("d",4===t||2===t?o?"M"+h*o+","+y+"H"+l+"V"+_+"H"+h*o:"M"+l+","+y+"V"+_:o?"M"+y+","+h*o+"V"+l+"H"+_+"V"+h*o:"M"+y+","+l+"H"+_),x.attr("opacity",1).attr("transform",(function(t){return u(w(t)+l)})),S.attr(c+"2",h*s),k.attr(c,h*m).text(g),v.filter($e).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),v.each((function(){this.__axis=w}))}return d.scale=function(t){return arguments.length?(e=t,d):e},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),d):n.slice()},d.tickValues=function(t){return arguments.length?(i=null==t?null:Array.from(t),d):i&&i.slice()},d.tickFormat=function(t){return arguments.length?(r=t,d):r},d.tickSize=function(t){return arguments.length?(s=o=+t,d):s},d.tickSizeInner=function(t){return arguments.length?(s=+t,d):s},d.tickSizeOuter=function(t){return arguments.length?(o=+t,d):o},d.tickPadding=function(t){return arguments.length?(a=+t,d):a},d.offset=function(t){return arguments.length?(l=+t,d):l},d}var Ze={value:()=>{}};function Je(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new tn(i)}function tn(t){this._=t}function en(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function nn(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function rn(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=Ze,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}tn.prototype=Je.prototype={constructor:tn,on:function(t,e){var n,i=this._,r=en(t+"",i),s=-1,o=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(n=(t=r[s]).type)i[n]=rn(i[n],t.name,e);else if(null==e)for(n in i)i[n]=rn(i[n],t.name,null);return this}for(;++s<o;)if((n=(t=r[s]).type)&&(n=nn(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new tn(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),s=0;s<n;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,n=(i=this._[t]).length;s<n;++s)i[s].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};var sn="http://www.w3.org/1999/xhtml",on={svg:"http://www.w3.org/2000/svg",xhtml:sn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function an(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),on.hasOwnProperty(e)?{space:on[e],local:t}:t}function ln(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===sn&&e.documentElement.namespaceURI===sn?e.createElement(t):e.createElementNS(n,t)}}function hn(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function cn(t){var e=an(t);return(e.local?hn:ln)(e)}function un(){}function dn(t){return null==t?un:function(){return this.querySelector(t)}}function fn(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function gn(){return[]}function mn(t){return null==t?gn:function(){return this.querySelectorAll(t)}}function pn(t){return function(){return this.matches(t)}}function yn(t){return function(e){return e.matches(t)}}var _n=Array.prototype.find;function wn(){return this.firstElementChild}var vn=Array.prototype.filter;function bn(){return Array.from(this.children)}function xn(t){return new Array(t.length)}function An(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Tn(t){return function(){return t}}function Sn(t,e,n,i,r,s){for(var o,a=0,l=e.length,h=s.length;a<h;++a)(o=e[a])?(o.__data__=s[a],i[a]=o):n[a]=new An(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function kn(t,e,n,i,r,s,o){var a,l,h,c=new Map,u=e.length,d=s.length,f=new Array(u);for(a=0;a<u;++a)(l=e[a])&&(f[a]=h=o.call(l,l.__data__,a,e)+"",c.has(h)?r[a]=l:c.set(h,l));for(a=0;a<d;++a)h=o.call(t,s[a],a,s)+"",(l=c.get(h))?(i[a]=l,l.__data__=s[a],c.delete(h)):n[a]=new An(t,s[a]);for(a=0;a<u;++a)(l=e[a])&&c.get(f[a])===l&&(r[a]=l)}function Mn(t){return t.__data__}function En(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function In(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function On(t){return function(){this.removeAttribute(t)}}function Nn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Cn(t,e){return function(){this.setAttribute(t,e)}}function Ln(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Dn(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Pn(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Fn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Rn(t){return function(){this.style.removeProperty(t)}}function Hn(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Gn(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Un(t,e){return t.style.getPropertyValue(e)||Fn(t).getComputedStyle(t,null).getPropertyValue(e)}function Bn(t){return function(){delete this[t]}}function jn(t,e){return function(){this[t]=e}}function zn(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Wn(t){return t.trim().split(/^|\s+/)}function Xn(t){return t.classList||new Vn(t)}function Vn(t){this._node=t,this._names=Wn(t.getAttribute("class")||"")}function Yn(t,e){for(var n=Xn(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function qn(t,e){for(var n=Xn(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Qn(t){return function(){Yn(this,t)}}function $n(t){return function(){qn(this,t)}}function Kn(t,e){return function(){(e.apply(this,arguments)?Yn:qn)(this,t)}}function Zn(){this.textContent=""}function Jn(t){return function(){this.textContent=t}}function ti(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ei(){this.innerHTML=""}function ni(t){return function(){this.innerHTML=t}}function ii(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ri(){this.nextSibling&&this.parentNode.appendChild(this)}function si(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function oi(){return null}function ai(){var t=this.parentNode;t&&t.removeChild(this)}function li(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function hi(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ci(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function ui(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,s=e.length;i<s;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function di(t,e,n){return function(){var i,r=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),void(i.value=e);this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function fi(t,e,n){var i=Fn(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function gi(t,e){return function(){return fi(this,t,e)}}function mi(t,e){return function(){return fi(this,t,e.apply(this,arguments))}}An.prototype={constructor:An,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},Vn.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var pi=[null];function yi(t,e){this._groups=t,this._parents=e}function _i(){return new yi([[document.documentElement]],pi)}function wi(t){return"string"==typeof t?new yi([[document.querySelector(t)]],[document.documentElement]):new yi([[t]],pi)}function vi(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}yi.prototype=_i.prototype={constructor:yi,select:function(t){"function"!=typeof t&&(t=dn(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o,a=e[r],l=a.length,h=i[r]=new Array(l),c=0;c<l;++c)(s=a[c])&&(o=t.call(s,s.__data__,c,a))&&("__data__"in s&&(o.__data__=s.__data__),h[c]=o);return new yi(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return fn(t.apply(this,arguments))}}(t):mn(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var o,a=e[s],l=a.length,h=0;h<l;++h)(o=a[h])&&(i.push(t.call(o,o.__data__,h,a)),r.push(o));return new yi(i,r)},selectChild:function(t){return this.select(null==t?wn:function(t){return function(){return _n.call(this.children,t)}}("function"==typeof t?t:yn(t)))},selectChildren:function(t){return this.selectAll(null==t?bn:function(t){return function(){return vn.call(this.children,t)}}("function"==typeof t?t:yn(t)))},filter:function(t){"function"!=typeof t&&(t=pn(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o=e[r],a=o.length,l=i[r]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new yi(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Mn);var n=e?kn:Sn,i=this._parents,r=this._groups;"function"!=typeof t&&(t=Tn(t));for(var s=r.length,o=new Array(s),a=new Array(s),l=new Array(s),h=0;h<s;++h){var c=i[h],u=r[h],d=u.length,f=En(t.call(c,c&&c.__data__,h,i)),g=f.length,m=a[h]=new Array(g),p=o[h]=new Array(g),y=l[h]=new Array(d);n(c,u,m,p,y,f,e);for(var _,w,v=0,b=0;v<g;++v)if(_=m[v]){for(v>=b&&(b=v+1);!(w=p[b])&&++b<g;);_._next=w||null}}return(o=new yi(o,i))._enter=a,o._exit=l,o},enter:function(){return new yi(this._enter||this._groups.map(xn),this._parents)},exit:function(){return new yi(this._exit||this._groups.map(xn),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,s=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?s.remove():n(s),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var h,c=n[l],u=i[l],d=c.length,f=a[l]=new Array(d),g=0;g<d;++g)(h=c[g]||u[g])&&(f[g]=h);for(;l<r;++l)a[l]=n[l];return new yi(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],s=r.length-1,o=r[s];--s>=0;)(i=r[s])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=In);for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o,a=n[s],l=a.length,h=r[s]=new Array(l),c=0;c<l;++c)(o=a[c])&&(h[c]=o);h.sort(e)}return new yi(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,s=e[n],o=0,a=s.length;o<a;++o)(r=s[o])&&t.call(r,r.__data__,o,s);return this},attr:function(t,e){var n=an(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?Nn:On:"function"==typeof e?n.local?Pn:Dn:n.local?Ln:Cn)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Rn:"function"==typeof e?Gn:Hn)(t,e,null==n?"":n)):Un(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Bn:"function"==typeof e?zn:jn)(t,e)):this.node()[t]},classed:function(t,e){var n=Wn(t+"");if(arguments.length<2){for(var i=Xn(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?Kn:e?Qn:$n)(n,e))},text:function(t){return arguments.length?this.each(null==t?Zn:("function"==typeof t?ti:Jn)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?ei:("function"==typeof t?ii:ni)(t)):this.node().innerHTML},raise:function(){return this.each(ri)},lower:function(){return this.each(si)},append:function(t){var e="function"==typeof t?t:cn(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:cn(t),i=null==e?oi:"function"==typeof e?e:dn(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(ai)},clone:function(t){return this.select(t?hi:li)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,s=ci(t+""),o=s.length;if(!(arguments.length<2)){for(a=e?di:ui,i=0;i<o;++i)this.each(a(s[i],e,n));return this}var a=this.node().__on;if(a)for(var l,h=0,c=a.length;h<c;++h)for(i=0,l=a[h];i<o;++i)if((r=s[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?mi:gi)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],s=0,o=r.length;s<o;++s)(i=r[s])&&(yield i)}};const bi={passive:!1},xi={capture:!0,passive:!1};function Ai(t){t.stopImmediatePropagation()}function Ti(t){t.preventDefault(),t.stopImmediatePropagation()}var Si=t=>()=>t;function ki(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:s,x:o,y:a,dx:l,dy:h,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:c}})}function Mi(t){return!t.ctrlKey&&!t.button}function Ei(){return this.parentNode}function Ii(t,e){return null==e?{x:t.x,y:t.y}:e}function Oi(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ni(){var t,e,n,i,r=Mi,s=Ei,o=Ii,a=Oi,l={},h=Je("start","drag","end"),c=0,u=0;function d(t){t.on("mousedown.drag",f).filter(a).on("touchstart.drag",p).on("touchmove.drag",y,bi).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(o,a){if(!i&&r.call(this,o,a)){var l=w(this,s.call(this,o,a),o,a,"mouse");l&&(wi(o.view).on("mousemove.drag",g,xi).on("mouseup.drag",m,xi),function(t){var e=t.document.documentElement,n=wi(t).on("dragstart.drag",Ti,xi);"onselectstart"in e?n.on("selectstart.drag",Ti,xi):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(o.view),Ai(o),n=!1,t=o.clientX,e=o.clientY,l("start",o))}}function g(i){if(Ti(i),!n){var r=i.clientX-t,s=i.clientY-e;n=r*r+s*s>u}l.mouse("drag",i)}function m(t){wi(t.view).on("mousemove.drag mouseup.drag",null),function(t,e){var n=t.document.documentElement,i=wi(t).on("dragstart.drag",null);e&&(i.on("click.drag",Ti,xi),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,n),Ti(t),l.mouse("end",t)}function p(t,e){if(r.call(this,t,e)){var n,i,o=t.changedTouches,a=s.call(this,t,e),l=o.length;for(n=0;n<l;++n)(i=w(this,a,t,e,o[n].identifier,o[n]))&&(Ai(t),i("start",t,o[n]))}}function y(t){var e,n,i=t.changedTouches,r=i.length;for(e=0;e<r;++e)(n=l[i[e].identifier])&&(Ti(t),n("drag",t,i[e]))}function _(t){var e,n,r=t.changedTouches,s=r.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),e=0;e<s;++e)(n=l[r[e].identifier])&&(Ai(t),n("end",t,r[e]))}function w(t,e,n,i,r,s){var a,u,f,g=h.copy(),m=vi(s||n,e);if(null!=(f=o.call(t,new ki("beforestart",{sourceEvent:n,target:d,identifier:r,active:c,x:m[0],y:m[1],dx:0,dy:0,dispatch:g}),i)))return a=f.x-m[0]||0,u=f.y-m[1]||0,function n(s,o,h){var p,y=m;switch(s){case"start":l[r]=n,p=c++;break;case"end":delete l[r],--c;case"drag":m=vi(h||o,e),p=c}g.call(s,t,new ki(s,{sourceEvent:o,subject:f,target:d,identifier:r,active:p,x:m[0]+a,y:m[1]+u,dx:m[0]-y[0],dy:m[1]-y[1],dispatch:g}),i)}}return d.filter=function(t){return arguments.length?(r="function"==typeof t?t:Si(!!t),d):r},d.container=function(t){return arguments.length?(s="function"==typeof t?t:Si(t),d):s},d.subject=function(t){return arguments.length?(o="function"==typeof t?t:Si(t),d):o},d.touchable=function(t){return arguments.length?(a="function"==typeof t?t:Si(!!t),d):a},d.on=function(){var t=h.on.apply(h,arguments);return t===h?d:t},d.clickDistance=function(t){return arguments.length?(u=(t=+t)*t,d):Math.sqrt(u)},d}function Ci(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Li(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Di(){}ki.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Pi=.7,Fi=1/Pi,Ri="\\s*([+-]?\\d+)\\s*",Hi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Gi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ui=/^#([0-9a-f]{3,8})$/,Bi=new RegExp("^rgb\\("+[Ri,Ri,Ri]+"\\)$"),ji=new RegExp("^rgb\\("+[Gi,Gi,Gi]+"\\)$"),zi=new RegExp("^rgba\\("+[Ri,Ri,Ri,Hi]+"\\)$"),Wi=new RegExp("^rgba\\("+[Gi,Gi,Gi,Hi]+"\\)$"),Xi=new RegExp("^hsl\\("+[Hi,Gi,Gi]+"\\)$"),Vi=new RegExp("^hsla\\("+[Hi,Gi,Gi,Hi]+"\\)$"),Yi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function qi(){return this.rgb().formatHex()}function Qi(){return this.rgb().formatRgb()}function $i(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ui.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ki(e):3===n?new er(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Zi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Zi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Bi.exec(t))?new er(e[1],e[2],e[3],1):(e=ji.exec(t))?new er(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=zi.exec(t))?Zi(e[1],e[2],e[3],e[4]):(e=Wi.exec(t))?Zi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Xi.exec(t))?sr(e[1],e[2]/100,e[3]/100,1):(e=Vi.exec(t))?sr(e[1],e[2]/100,e[3]/100,e[4]):Yi.hasOwnProperty(t)?Ki(Yi[t]):"transparent"===t?new er(NaN,NaN,NaN,0):null}function Ki(t){return new er(t>>16&255,t>>8&255,255&t,1)}function Zi(t,e,n,i){return i<=0&&(t=e=n=NaN),new er(t,e,n,i)}function Ji(t){return t instanceof Di||(t=$i(t)),t?new er((t=t.rgb()).r,t.g,t.b,t.opacity):new er}function tr(t,e,n,i){return 1===arguments.length?Ji(t):new er(t,e,n,null==i?1:i)}function er(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function nr(){return"#"+rr(this.r)+rr(this.g)+rr(this.b)}function ir(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function rr(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function sr(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ar(t,e,n,i)}function or(t){if(t instanceof ar)return new ar(t.h,t.s,t.l,t.opacity);if(t instanceof Di||(t=$i(t)),!t)return new ar;if(t instanceof ar)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(o=e===s?(n-i)/a+6*(n<i):n===s?(i-e)/a+2:(e-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new ar(o,a,l,t.opacity)}function ar(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function lr(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Ci(Di,$i,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:qi,formatHex:qi,formatHsl:function(){return or(this).formatHsl()},formatRgb:Qi,toString:Qi}),Ci(er,tr,Li(Di,{brighter:function(t){return t=null==t?Fi:Math.pow(Fi,t),new er(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Pi:Math.pow(Pi,t),new er(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nr,formatHex:nr,formatRgb:ir,toString:ir})),Ci(ar,(function(t,e,n,i){return 1===arguments.length?or(t):new ar(t,e,n,null==i?1:i)}),Li(Di,{brighter:function(t){return t=null==t?Fi:Math.pow(Fi,t),new ar(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Pi:Math.pow(Pi,t),new ar(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new er(lr(t>=240?t-240:t+120,r,i),lr(t,r,i),lr(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var hr=t=>()=>t;function cr(t){return 1==(t=+t)?ur:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):hr(isNaN(e)?n:e)}}function ur(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):hr(isNaN(t)?e:t)}var dr=function t(e){var n=cr(e);function i(t,e){var i=n((t=tr(t)).r,(e=tr(e)).r),r=n(t.g,e.g),s=n(t.b,e.b),o=ur(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=s(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function fr(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(s){for(n=0;n<i;++n)r[n]=t[n]*(1-s)+e[n]*s;return r}}function gr(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,s=new Array(r),o=new Array(i);for(n=0;n<r;++n)s[n]=br(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=s[n](t);return o}}function mr(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function pr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function yr(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=br(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var _r=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wr=new RegExp(_r.source,"g");function vr(t,e){var n,i,r,s=_r.lastIndex=wr.lastIndex=0,o=-1,a=[],l=[];for(t+="",e+="";(n=_r.exec(t))&&(i=wr.exec(e));)(r=i.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:pr(n,i)})),s=wr.lastIndex;return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function br(t,e){var n,i,r=typeof e;return null==e||"boolean"===r?hr(e):("number"===r?pr:"string"===r?(n=$i(e))?(e=n,dr):vr:e instanceof $i?dr:e instanceof Date?mr:(i=e,!ArrayBuffer.isView(i)||i instanceof DataView?Array.isArray(e)?gr:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?yr:pr:fr))(t,e)}function xr(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Ar,Tr=180/Math.PI,Sr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function kr(t,e,n,i,r,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*Tr,skewX:Math.atan(l)*Tr,scaleX:o,scaleY:a}}function Mr(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(s,o){var a=[],l=[];return s=t(s),o=t(o),function(t,i,r,s,o,a){if(t!==r||i!==s){var l=o.push("translate(",null,e,null,n);a.push({i:l-4,x:pr(t,r)},{i:l-2,x:pr(i,s)})}else(r||s)&&o.push("translate("+r+e+s+n)}(s.translateX,s.translateY,o.translateX,o.translateY,a,l),function(t,e,n,s){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),s.push({i:n.push(r(n)+"rotate(",null,i)-2,x:pr(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(s.rotate,o.rotate,a,l),function(t,e,n,s){t!==e?s.push({i:n.push(r(n)+"skewX(",null,i)-2,x:pr(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(s.skewX,o.skewX,a,l),function(t,e,n,i,s,o){if(t!==n||e!==i){var a=s.push(r(s)+"scale(",null,",",null,")");o.push({i:a-4,x:pr(t,n)},{i:a-2,x:pr(e,i)})}else 1===n&&1===i||s.push(r(s)+"scale("+n+","+i+")")}(s.scaleX,s.scaleY,o.scaleX,o.scaleY,a,l),s=o=null,function(t){for(var e,n=-1,i=l.length;++n<i;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var Er,Ir,Or=Mr((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Sr:kr(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Nr=Mr((function(t){return null==t?Sr:(Ar||(Ar=document.createElementNS("http://www.w3.org/2000/svg","g")),Ar.setAttribute("transform",t),(t=Ar.transform.baseVal.consolidate())?kr((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Sr)}),", ",")",")"),Cr=0,Lr=0,Dr=0,Pr=0,Fr=0,Rr=0,Hr="object"==typeof performance&&performance.now?performance:Date,Gr="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ur(){return Fr||(Gr(Br),Fr=Hr.now()+Rr)}function Br(){Fr=0}function jr(){this._call=this._time=this._next=null}function zr(t,e,n){var i=new jr;return i.restart(t,e,n),i}function Wr(){Fr=(Pr=Hr.now())+Rr,Cr=Lr=0;try{!function(){Ur(),++Cr;for(var t,e=Er;e;)(t=Fr-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Cr}()}finally{Cr=0,function(){var t,e,n=Er,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Er=e);Ir=t,Vr(i)}(),Fr=0}}function Xr(){var t=Hr.now(),e=t-Pr;e>1e3&&(Rr-=e,Pr=t)}function Vr(t){Cr||(Lr&&(Lr=clearTimeout(Lr)),t-Fr>24?(t<1/0&&(Lr=setTimeout(Wr,t-Hr.now()-Rr)),Dr&&(Dr=clearInterval(Dr))):(Dr||(Pr=Hr.now(),Dr=setInterval(Xr,1e3)),Cr=1,Gr(Wr)))}function Yr(t,e,n){var i=new jr;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}jr.prototype=zr.prototype={constructor:jr,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Ur():+n)+(null==e?0:+e),this._next||Ir===this||(Ir?Ir._next=this:Er=this,Ir=this),this._call=t,this._time=n,Vr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vr())}};var qr=Je("start","end","cancel","interrupt"),Qr=[];function $r(t,e,n,i,r,s){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function s(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}function o(s){var h,c,u,d;if(1!==n.state)return l();for(h in r)if((d=r[h]).name===n.name){if(3===d.state)return Yr(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[h]):+h<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[h])}if(Yr((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(s))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(u=n.tween.length),h=0,c=-1;h<u;++h)(d=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(i[++c]=d);i.length=c+1}}function a(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),s=-1,o=i.length;++s<o;)i[s].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=zr(s,0,n.time)}(t,n,{name:e,index:i,group:r,on:qr,tween:Qr,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})}function Kr(t,e){var n=Jr(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Zr(t,e){var n=Jr(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Jr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ts(t,e){var n,i;return function(){var r=Zr(this,t),s=r.tween;if(s!==n)for(var o=0,a=(i=n=s).length;o<a;++o)if(i[o].name===e){(i=i.slice()).splice(o,1);break}r.tween=i}}function es(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var s=Zr(this,t),o=s.tween;if(o!==i){r=(i=o).slice();for(var a={name:e,value:n},l=0,h=r.length;l<h;++l)if(r[l].name===e){r[l]=a;break}l===h&&r.push(a)}s.tween=r}}function ns(t,e,n){var i=t._id;return t.each((function(){var t=Zr(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Jr(t,i).value[e]}}function is(t,e){var n;return("number"==typeof e?pr:e instanceof $i?dr:(n=$i(e))?(e=n,dr):vr)(t,e)}function rs(t){return function(){this.removeAttribute(t)}}function ss(t){return function(){this.removeAttributeNS(t.space,t.local)}}function os(t,e,n){var i,r,s=n+"";return function(){var o=this.getAttribute(t);return o===s?null:o===i?r:r=e(i=o,n)}}function as(t,e,n){var i,r,s=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===i?r:r=e(i=o,n)}}function ls(t,e,n){var i,r,s;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(a=l+"")?null:o===i&&a===r?s:(r=a,s=e(i=o,l));this.removeAttribute(t)}}function hs(t,e,n){var i,r,s;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:o===i&&a===r?s:(r=a,s=e(i=o,l));this.removeAttributeNS(t.space,t.local)}}function cs(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function us(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ds(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&us(t,r)),n}return r._value=e,r}function fs(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&cs(t,r)),n}return r._value=e,r}function gs(t,e){return function(){Kr(this,t).delay=+e.apply(this,arguments)}}function ms(t,e){return e=+e,function(){Kr(this,t).delay=e}}function ps(t,e){return function(){Zr(this,t).duration=+e.apply(this,arguments)}}function ys(t,e){return e=+e,function(){Zr(this,t).duration=e}}function _s(t,e){if("function"!=typeof e)throw new Error;return function(){Zr(this,t).ease=e}}function ws(t,e,n){var i,r,s=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Kr:Zr;return function(){var o=s(this,t),a=o.on;a!==i&&(r=(i=a).copy()).on(e,n),o.on=r}}var vs=_i.prototype.constructor;function bs(t){return function(){this.style.removeProperty(t)}}function xs(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function As(t,e,n){var i,r;function s(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&xs(t,s,n)),i}return s._value=e,s}function Ts(t){return function(e){this.textContent=t.call(this,e)}}function Ss(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Ts(i)),e}return i._value=t,i}var ks=0;function Ms(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Es(){return++ks}var Is=_i.prototype;Ms.prototype={constructor:Ms,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=dn(t));for(var i=this._groups,r=i.length,s=new Array(r),o=0;o<r;++o)for(var a,l,h=i[o],c=h.length,u=s[o]=new Array(c),d=0;d<c;++d)(a=h[d])&&(l=t.call(a,a.__data__,d,h))&&("__data__"in a&&(l.__data__=a.__data__),u[d]=l,$r(u[d],e,n,d,u,Jr(a,n)));return new Ms(s,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=mn(t));for(var i=this._groups,r=i.length,s=[],o=[],a=0;a<r;++a)for(var l,h=i[a],c=h.length,u=0;u<c;++u)if(l=h[u]){for(var d,f=t.call(l,l.__data__,u,h),g=Jr(l,n),m=0,p=f.length;m<p;++m)(d=f[m])&&$r(d,e,n,m,f,g);s.push(f),o.push(l)}return new Ms(s,o,e,n)},selectChild:Is.selectChild,selectChildren:Is.selectChildren,filter:function(t){"function"!=typeof t&&(t=pn(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o=e[r],a=o.length,l=i[r]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new Ms(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),o=new Array(i),a=0;a<s;++a)for(var l,h=e[a],c=n[a],u=h.length,d=o[a]=new Array(u),f=0;f<u;++f)(l=h[f]||c[f])&&(d[f]=l);for(;a<i;++a)o[a]=e[a];return new Ms(o,this._parents,this._name,this._id)},selection:function(){return new vs(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Es(),i=this._groups,r=i.length,s=0;s<r;++s)for(var o,a=i[s],l=a.length,h=0;h<l;++h)if(o=a[h]){var c=Jr(o,e);$r(o,t,n,h,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ms(i,this._parents,t,n)},call:Is.call,nodes:Is.nodes,node:Is.node,size:Is.size,empty:Is.empty,each:Is.each,on:function(t,e){var n=this._id;return arguments.length<2?Jr(this.node(),n).on.on(t):this.each(ws(n,t,e))},attr:function(t,e){var n=an(t),i="transform"===n?Nr:is;return this.attrTween(t,"function"==typeof e?(n.local?hs:ls)(n,i,ns(this,"attr."+t,e)):null==e?(n.local?ss:rs)(n):(n.local?as:os)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=an(t);return this.tween(n,(i.local?ds:fs)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?Or:is;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var s=Un(this,t),o=(this.style.removeProperty(t),Un(this,t));return s===o?null:s===n&&o===i?r:r=e(n=s,i=o)}}(t,i)).on("end.style."+t,bs(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,s;return function(){var o=Un(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=Un(this,t)),o===l?null:o===i&&l===r?s:(r=l,s=e(i=o,a))}}(t,i,ns(this,"style."+t,e))).each(function(t,e){var n,i,r,s,o="style."+e,a="end."+o;return function(){var l=Zr(this,t),h=l.on,c=null==l.value[o]?s||(s=bs(e)):void 0;h===n&&r===c||(i=(n=h).copy()).on(a,r=c),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,s=n+"";return function(){var o=Un(this,t);return o===s?null:o===i?r:r=e(i=o,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,As(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ns(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Ss(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=Jr(this.node(),n).tween,s=0,o=r.length;s<o;++s)if((i=r[s]).name===t)return i.value;return null}return this.each((null==e?ts:es)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?gs:ms)(e,t)):Jr(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ps:ys)(e,t)):Jr(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(_s(e,t)):Jr(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Zr(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(s,o){var a={value:o},l={value:function(){0==--r&&s()}};n.each((function(){var n=Zr(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===r&&s()}))},[Symbol.iterator]:Is[Symbol.iterator]};var Os={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Ns(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Cs(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Ls(t,e){return fetch(t,e).then(Cs)}function Ds(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}_i.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,i,r,s=t.__transition,o=!0;if(s){for(r in e=null==e?null:e+"",s)(n=s[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete s[r]):o=!1;o&&delete t.__transition}}(this,t)}))},_i.prototype.transition=function(t){var e,n;t instanceof Ms?(e=t._id,t=t._name):(e=Es(),(n=Os).time=Ur(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var o,a=i[s],l=a.length,h=0;h<l;++h)(o=a[h])&&$r(o,t,e,h,a,n||Ns(o,e));return new Ms(i,this._parents,t,e)};var Ps,Fs=(Ps="application/xml",(t,e)=>Ls(t,e).then((t=>(new DOMParser).parseFromString(t,Ps))));function Rs(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Hs(t){return(t=Rs(Math.abs(t)))?t[1]:NaN}var Gs,Us=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Bs(t){if(!(e=Us.exec(t)))throw new Error("invalid format: "+t);var e;return new js({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function js(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function zs(t,e){var n=Rs(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}Bs.prototype=js.prototype,js.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Ws={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>zs(100*t,e),r:zs,s:function(t,e){var n=Rs(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(Gs=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Rs(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Xs(t){return t}var Vs,Ys,qs,Qs=Array.prototype.map,$s=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Ks(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?Xs:(e=Qs.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",s=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?Xs:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Qs.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",h=void 0===t.minus?"−":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function u(t){var e=(t=Bs(t)).fill,n=t.align,u=t.sign,d=t.symbol,f=t.zero,g=t.width,m=t.comma,p=t.precision,y=t.trim,_=t.type;"n"===_?(m=!0,_="g"):Ws[_]||(void 0===p&&(p=12),y=!0,_="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var w="$"===d?r:"#"===d&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",v="$"===d?s:/[%p]/.test(_)?l:"",b=Ws[_],x=/[defgprs%]/.test(_);function A(t){var r,s,l,d=w,A=v;if("c"===_)A=b(t)+A,t="";else{var T=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:b(Math.abs(t),p),y&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),T&&0==+t&&"+"!==u&&(T=!1),d=(T?"("===u?u:h:"-"===u||"("===u?"":u)+d,A=("s"===_?$s[8+Gs/3]:"")+A+(T&&"("===u?")":""),x)for(r=-1,s=t.length;++r<s;)if(48>(l=t.charCodeAt(r))||l>57){A=(46===l?o+t.slice(r+1):t.slice(r))+A,t=t.slice(0,r);break}}m&&!f&&(t=i(t,1/0));var S=d.length+t.length+A.length,k=S<g?new Array(g-S+1).join(e):"";switch(m&&f&&(t=i(k+t,k.length?g-A.length:1/0),k=""),n){case"<":t=d+t+A+k;break;case"=":t=d+k+t+A;break;case"^":t=k.slice(0,S=k.length>>1)+d+t+A+k.slice(S);break;default:t=k+d+t+A}return a(t)}return p=void 0===p?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),A.toString=function(){return t+""},A}return{format:u,formatPrefix:function(t,e){var n=u(((t=Bs(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Hs(e)/3))),r=Math.pow(10,-i),s=$s[8+i/3];return function(t){return n(r*t)+s}}}}function Zs(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Js(t){return+t}!function(t){Vs=Ks(t),Ys=Vs.format,qs=Vs.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var to=[0,1];function eo(t){return t}function no(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function io(t,e,n){var i=t[0],r=t[1],s=e[0],o=e[1];return r<i?(i=no(r,i),s=n(o,s)):(i=no(i,r),s=n(s,o)),function(t){return s(i(t))}}function ro(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=no(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(e){var n=ut(t,e,1,i)-1;return s[n](r[n](e))}}function so(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function oo(){var t,e,n,i,r,s,o=to,a=to,l=br,h=eo;function c(){var t,e,n,l=Math.min(o.length,a.length);return h!==eo&&(t=o[0],e=o[l-1],t>e&&(n=t,t=e,e=n),h=function(n){return Math.max(t,Math.min(e,n))}),i=l>2?ro:io,r=s=null,u}function u(e){return null==e||isNaN(e=+e)?n:(r||(r=i(o.map(t),a,l)))(t(h(e)))}return u.invert=function(n){return h(e((s||(s=i(a,o.map(t),pr)))(n)))},u.domain=function(t){return arguments.length?(o=Array.from(t,Js),c()):o.slice()},u.range=function(t){return arguments.length?(a=Array.from(t),c()):a.slice()},u.rangeRound=function(t){return a=Array.from(t),l=xr,c()},u.clamp=function(t){return arguments.length?(h=!!t||eo,c()):h!==eo},u.interpolate=function(t){return arguments.length?(l=t,c()):l},u.unknown=function(t){return arguments.length?(n=t,u):n},function(n,i){return t=n,e=i,c()}}function ao(){return oo()(eo,eo)}function lo(t,e,n,i){var r,s=pt(t,e,n);switch((i=Bs(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Hs(e)/3)))-Hs(Math.abs(t)))}(s,o))||(i.precision=r),qs(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Hs(e)-Hs(t))+1}(s,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-Hs(Math.abs(t)))}(s))||(i.precision=r-2*("%"===i.type))}return Ys(i)}function ho(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var i,r,s,o,a=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(o=mt(t,e,n))||!isFinite(o))return[];if(o>0){let n=Math.round(t/o),i=Math.round(e/o);for(n*o<t&&++n,i*o>e&&--i,s=new Array(r=i-n+1);++a<r;)s[a]=(n+a)*o}else{o=-o;let n=Math.round(t*o),i=Math.round(e*o);for(n/o<t&&++n,i/o>e&&--i,s=new Array(r=i-n+1);++a<r;)s[a]=(n+a)/o}return i&&s.reverse(),s}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return lo(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r,s=e(),o=0,a=s.length-1,l=s[o],h=s[a],c=10;for(h<l&&(r=l,l=h,h=r,r=o,o=a,a=r);c-- >0;){if((r=mt(l,h,n))===i)return s[o]=l,s[a]=h,e(s);if(r>0)l=Math.floor(l/r)*r,h=Math.ceil(h/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,h=Math.floor(h*r)/r}i=r}return t},t}function co(){var t=ao();return t.copy=function(){return so(t,co())},Zs.apply(t,arguments),ho(t)}function uo(t){return new Date(t)}function fo(t){return t instanceof Date?+t:+new Date(+t)}function go(t,e,n,i,r,s,o,a,l,h){var c=ao(),u=c.invert,d=c.domain,f=h(".%L"),g=h(":%S"),m=h("%I:%M"),p=h("%I %p"),y=h("%a %d"),_=h("%b %d"),w=h("%B"),v=h("%Y");function b(t){return(l(t)<t?f:a(t)<t?g:o(t)<t?m:s(t)<t?p:i(t)<t?r(t)<t?y:_:n(t)<t?w:v)(t)}return c.invert=function(t){return new Date(u(t))},c.domain=function(t){return arguments.length?d(Array.from(t,fo)):d().map(uo)},c.ticks=function(e){var n=d();return t(n[0],n[n.length-1],null==e?10:e)},c.tickFormat=function(t,e){return null==e?b:h(e)},c.nice=function(t){var n=d();return t&&"function"==typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?d(function(t,e){var n,i=0,r=(t=t.slice()).length-1,s=t[i],o=t[r];return o<s&&(n=i,i=r,r=n,n=s,s=o,o=n),t[i]=e.floor(s),t[r]=e.ceil(o),t}(n,t)):c},c.copy=function(){return so(c,go(t,e,n,i,r,s,o,a,l,h))},c}Tt("%m/%d/%Y");const mo=Tt("%d/%m/%Y"),po="%Y-%m-%d %H:%M:%S",yo=St(po),_o=Tt(po),wo={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2592e6,year:31536e6,milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:2592e6,years:31536e6};function vo(t,e,n){return new Date(t.getTime()+e*wo[n])}const bo=Tt("%w");function xo(t,e){const n=new Date(t);switch(e){case"millisecond":break;case"second":n.setMilliseconds(0);break;case"minute":n.setMilliseconds(0),n.setSeconds(0);break;case"hour":n.setMilliseconds(0),n.setSeconds(0),n.setMinutes(0);break;case"day":n.setMilliseconds(0),n.setSeconds(0),n.setMinutes(0),n.setHours(0);break;case"week":return new Date(n.getTime()-864e5*parseInt(bo(n)));case"month":n.setMilliseconds(0),n.setSeconds(0),n.setMinutes(0),n.setHours(0),n.setDate(0);break;case"year":n.setMilliseconds(0),n.setSeconds(0),n.setMinutes(0),n.setHours(0),n.setDate(0),n.setMonth(0)}return n}function Ao(t,e){const n=Tt("%V"),i=new Date(t);switch(e){case 0:return i.getUTCMilliseconds();case 1:return i.getUTCSeconds();case 2:return i.getUTCMinutes();case 3:return i.getUTCHours();case 4:return i.getUTCDay();case 5:return parseInt(n(i));case 6:return i.getUTCMonth()+1;default:return i.getUTCFullYear()}}const To=(t,e)=>Ao(t,e).toString();function So(t,e){switch(t){case 0:return"%S";case 1:return"%S"+(e?".":"");case 2:return"%M"+(e?":":"");case 3:return"%H";case 4:return"%D"+(e?" ":"");case 6:return"%m"+(e?"-":"");default:return"%Y"+(e?"-":"")}}const ko=["millisecond","second","minute","hour","day","week","month","year","decade","century","millenium"],Mo="[*dgraph*]";function Eo(t,e,n){return n==Mo?t:n}function Io(t,e){return e instanceof Oo?(console.log("dgraphReplacer found a DynamicGraph property",t),Mo):e}class Oo{constructor(){this.BOOKMARK_COLORS=this.default_colors,this.selectionColor_pointer=0,this.name="",this.gran_min=0,this.gran_max=Number.MAX_VALUE,this.minWeight=1e7,this.maxWeight=-1e7,this._nodes=[],this._links=[],this.directed=!1,this._nodePairs=[],this._locations=[],this._times=[],this.timeObjects=[],this.nodeOrders=[],this.matrix=[],this.selections=[],this.nodeArrays=new Co,this.linkArrays=new Lo,this.nodePairArrays=new Do,this.timeArrays=new Po,this.linkTypeArrays=new Fo,this.nodeTypeArrays=new Ro,this.locationArrays=new Ho,this.attributeArrays={node:this.nodeArrays,link:this.linkArrays,time:this.timeArrays,nodePair:this.nodePairArrays,linkType:this.linkTypeArrays,nodeType:this.nodeTypeArrays,location:this.locationArrays},this.highlightArrays=new oa,this.highlightFreezeArrays=new oa,this.currentSelection_id=0,this.defaultLinkSelection=this.createSelection("link"),this.defaultNodeSelection=this.createSelection("node"),this.gran_min_NAME="gran_min",this.gran_max_NAME="gran_max_NAME",this.directed_NAME="directed_NAME",this.minWeight_NAME="minWeight_NAME",this.maxWeight_NAME="maxWeight_NAME",this.matrix_NAME="matrix_NAME",this.nodeArrays_NAME="nodeArrays_NAME",this.linkArrays_NAME="linkArrays_NAME",this.nodePairArrays_NAME="nodePairArrays_NAME",this.timeArrays_NAME="timeArrays_NAME",this.linkTypeArrays_NAME="linkTypeArrays_NAME",this.nodeTypeArrays_NAME="nodeTypeArrays_NAME",this.locationArrays_NAME="locationArrays_NAME"}default_colors(t){const e=["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac"];return e[t%e.length]}attr(t,e,n){let i;try{i=this.attributeArrays[n][t][e]}catch(t){i=void 0}return i}standardArrayReplacer(t,e){return e instanceof Oo?(console.log("standardReplacer found a DynamicGraph property",t),Mo):"selections"!=t?e:void 0}static timeReviver(t,e,n){return""==t?aa(e,new Vo(e.id,n)):Eo(n,0,e)}static nodeArrayReviver(t,e,n){switch(t){case"":return aa(e,new Co);case"outLinks":case"inLinks":case"links":case"outNeighbors":case"inNeighbors":case"neighbors":return ha(e,(function(){return new Wo}));case"locations":return ha(e,(function(){return new zo}));default:return e}}static linkArrayReviver(t,e,n){switch(t){case"":return aa(e,new Lo);case"weights":return ha(e,(function(){return new zo}));default:return e}}static nodePairArrayReviver(t,e,n){return""===t?aa(e,new Do):e}static timeArrayReviver(t,e,n){switch(t){case"":return aa(e,new Po);case"time":return e.map((function(t,e){return new Date(t)}));default:return e}}static linkTypeArrayReviver(t,e,n){return""===t?aa(e,new Fo):e}static nodeTypeArrayReviver(t,e,n){return""===t?aa(e,new Ro):e}static locationArrayReviver(t,e,n){return""===t?aa(e,new Ho):e}loadDynamicGraph(t,e){this.clearSelections(),this.name=e;const n=t.getFromStorage(this.name,this.gran_min_NAME);null!=n&&(this.gran_min=n);const i=t.getFromStorage(this.name,this.gran_max_NAME);null!=i&&(this.gran_max=i);const r=t.getFromStorage(this.name,this.directed_NAME);null!=r&&(this.directed=r);const s=t.getFromStorage(this.name,this.minWeight_NAME);null!=s&&(this.minWeight=s);const o=t.getFromStorage(this.name,this.maxWeight_NAME);null!=o&&(this.maxWeight=o);const a=t.getFromStorage(this.name,this.matrix_NAME);null!=a&&(this.matrix=a);const l=t.getFromStorage(this.name,this.nodeArrays_NAME,Oo.nodeArrayReviver);null!=l&&(this.nodeArrays=l);const h=t.getFromStorage(this.name,this.linkArrays_NAME,Oo.linkArrayReviver);null!=h&&(this.linkArrays=h);const c=t.getFromStorage(this.name,this.nodePairArrays_NAME,Oo.nodePairArrayReviver);null!=c&&(this.nodePairArrays=c);const u=t.getFromStorage(this.name,this.timeArrays_NAME,Oo.timeArrayReviver);if(null!=u&&(this.timeArrays=u),"timeArrays"in this&&this.timeArrays)if("momentTime"in this.timeArrays&&"unixTime"in this.timeArrays){const t=this.timeArrays.momentTime;for(let e=0;e<t.length;e++)t[e]=new Date(this.timeArrays.unixTime[e])}else"unixTime"in this.timeArrays?(console.log("No time in timeArrays"),this.timeArrays.momentTime=this.timeArrays.unixTime.map(new Date)):(console.log("No time or unixTime in timeArrays"),this.timeArrays.momentTime=[]);else console.log("No timeArrays"),this.timeArrays=new Po;const d=t.getFromStorage(this.name,this.linkTypeArrays_NAME,Oo.linkTypeArrayReviver);null!=d&&(this.linkTypeArrays=d);const f=t.getFromStorage(this.name,this.nodeTypeArrays_NAME,Oo.nodeTypeArrayReviver);null!=f&&(this.nodeTypeArrays=f);const g=t.getFromStorage(this.name,this.locationArrays_NAME,Oo.locationArrayReviver);null!=g&&(this.locationArrays=g),this.attributeArrays={node:this.nodeArrays,link:this.linkArrays,time:this.timeArrays,nodePair:this.nodePairArrays,linkType:this.linkTypeArrays,nodeType:this.nodeTypeArrays,location:this.locationArrays},this.createGraphObjects(!0,!0),this.createSelections(!0)}saveDynamicGraph(t){t.saveToStorage(this.name,this.gran_min_NAME,this.gran_min),t.saveToStorage(this.name,this.gran_max_NAME,this.gran_max),t.saveToStorage(this.name,this.directed_NAME,this.directed),t.saveToStorage(this.name,this.minWeight_NAME,this.minWeight),t.saveToStorage(this.name,this.maxWeight_NAME,this.maxWeight),t.saveToStorage(this.name,this.matrix_NAME,this.matrix),t.saveToStorage(this.name,this.nodeArrays_NAME,this.nodeArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.linkArrays_NAME,this.linkArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.nodePairArrays_NAME,this.nodePairArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.timeArrays_NAME,this.timeArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.linkTypeArrays_NAME,this.linkTypeArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.nodeTypeArrays_NAME,this.nodeTypeArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.locationArrays_NAME,this.locationArrays,this.standardArrayReplacer)}delete(t){t.removeFromStorage(this.name,this.gran_min_NAME),t.removeFromStorage(this.name,this.gran_max_NAME),t.removeFromStorage(this.name,this.directed_NAME),t.removeFromStorage(this.name,this.minWeight_NAME),t.removeFromStorage(this.name,this.maxWeight_NAME),t.removeFromStorage(this.name,this.matrix_NAME),t.removeFromStorage(this.name,this.nodeArrays_NAME),t.removeFromStorage(this.name,this.linkArrays_NAME),t.removeFromStorage(this.name,this.nodePairArrays_NAME),t.removeFromStorage(this.name,this.timeArrays_NAME),t.removeFromStorage(this.name,this.linkTypeArrays_NAME),t.removeFromStorage(this.name,this.nodeTypeArrays_NAME),t.removeFromStorage(this.name,this.locationArrays_NAME)}debugCompareTo(t){let e=!0;return this.name!=t.name&&(console.log("name different"),e=!1),this.gran_min!=t.gran_min&&(console.log("gran_min different",this.gran_min,t.gran_min),e=!1),this.gran_max!=t.gran_max&&(console.log("gran_max different",this.gran_max,t.gran_max),e=!1),this.directed!=t.directed&&(console.log("directed different",this.directed,t.directed),e=!1),this._nodes.length==t._nodes.length&&ca(this._nodes,t._nodes,2)||(console.log("nodes different"),e=!1),this._links.length==t._links.length&&ca(this._links,t._links,2)||(console.log("links different"),e=!1),this._nodePairs.length==t._nodePairs.length&&ca(this._nodePairs,t._nodePairs,2)||(console.log("nodePairs different"),e=!1),this._locations.length==t._locations.length&&ca(this._locations,t._locations,2)||(console.log("locations different"),e=!1),this._times.length==t._times.length&&ca(this._times,t._times,2)||(console.log("times different"),e=!1),(this.nodeOrders&&this.nodeOrders.length!=t.nodeOrders.length||!ca(this.nodeOrders,t.nodeOrders,2))&&(console.log("nodeOrders different",this.nodeOrders,t.nodeOrders),e=!1),this.matrix.length==t.matrix.length&&ca(this.matrix,t.matrix,2)||(console.log("matrix different",this.matrix,t.matrix),e=!1),this.nodeArrays.length==t.nodeArrays.length&&ca(this.nodeArrays,t.nodeArrays,2)||(console.log("nodeArrays different",this.nodeArrays,t.nodeArrays),e=!1),this.linkArrays.length==t.linkArrays.length&&ca(this.linkArrays,t.linkArrays,2)||(console.log("linkArrays different",this.linkArrays,t.linkArrays),e=!1),this.nodePairArrays.length==t.nodePairArrays.length&&ca(this.nodePairArrays,t.nodePairArrays,2)||(console.log("nodePairArrays different",this.nodePairArrays,t.nodePairArrays),e=!1),this.timeArrays.length==t.timeArrays.length&&ca(this.timeArrays,t.timeArrays,2)||(console.log("timeArrays different",this.timeArrays,t.timeArrays),e=!1),this.linkTypeArrays.length==t.linkTypeArrays.length&&ca(this.linkTypeArrays,t.linkTypeArrays,2)||(console.log("linkTypeArrays different",this.linkTypeArrays,t.linkTypeArrays),e=!1),this.nodeTypeArrays.length==t.nodeTypeArrays.length&&ca(this.nodeTypeArrays,t.nodeTypeArrays,2)||(console.log("nodeTypeArrays different",this.nodeTypeArrays,t.nodeTypeArrays),e=!1),this.locationArrays.length==t.locationArrays.length&&ca(this.locationArrays,t.locationArrays,2)||(console.log("locationArrays different",this.locationArrays,t.locationArrays),e=!1),this.defaultLinkSelection.elementIds.length==t.defaultLinkSelection.elementIds.length&&ca(this.defaultLinkSelection,t.defaultLinkSelection,2)||(console.log("defaultLinkSelection different",this.defaultLinkSelection,t.defaultLinkSelection),e=!1),this.defaultNodeSelection.elementIds.length==t.defaultNodeSelection.elementIds.length&&ca(this.defaultNodeSelection,t.defaultNodeSelection,2)||(console.log("defaultNodeSelection different",this.defaultNodeSelection,t.defaultNodeSelection),e=!1),this.selections.length==t.selections.length&&ca(this.selections,t.selections,2)||(console.log("selections different",this.selections,t.selections),e=!1),e}initDynamicGraph(t){var e,n,i,r,s;let o;this.clearSelections(),console.log("[dynamicgraph.ts] Create dynamic graph for ",t.name,t),this.name=t.name,this.directed=t.directed,this.gran_min=0,this.gran_max=0;const a=[];let l,c,u,d,f,g,m;if(h(t.linkSchema.time)){console.log("GEtting unix times for all times - linktable"),console.log(t.linkTable);for(let n=0;n<t.linkTable.length;n++)o=t.linkTable[n][t.linkSchema.time],console.log(t.linkTable[n]),l=null===(e=yo(o))||void 0===e?void 0:e.getTime(),null!=l&&-1==a.indexOf(l)&&a.push(l);a.sort(ua);let n=99999999999999;for(let t=0;t<a.length-2;t++)n=Math.min(n,a[t+1]-a[t]);n>=1e3&&(this.gran_min=1),n>=6e4&&(this.gran_min=2),n>=36e5&&(this.gran_min=3),n>=864e5&&(this.gran_min=4),n>=6048e5&&(this.gran_min=5),n>=2592e6&&(this.gran_min=6),n>=31104e6&&(this.gran_min=7),n>=31104e7&&(this.gran_min=8),n>=31104e8&&(this.gran_min=9),n>=31104e9&&(this.gran_min=10),n=a[a.length-1]-a[0],this.gran_max=0,n>=1e3&&(this.gran_max=1),n>=6e4&&(this.gran_max=2),n>=36e5&&(this.gran_max=3),n>=864e5&&(this.gran_max=4),n>=6048e5&&(this.gran_max=5),n>=2592e6&&(this.gran_max=6),n>=31104e6&&(this.gran_max=7),n>=31104e7&&(this.gran_max=8),n>=31104e8&&(this.gran_max=9),n>=31104e9&&(this.gran_max=10),console.log("[Dynamic Graph] Minimal granularity",ko[this.gran_min]),console.log("[Dynamic Graph] Maximal granularity",ko[this.gran_max]);for(let t=0;t<a.length;t++)this.timeArrays.id.push(t),this.timeArrays.momentTime.push(new Date(a[t])),this.timeArrays.label.push(_o(this.timeArrays.momentTime[t])),this.timeArrays.unixTime.push(a[t]),this.timeArrays.selections.push([]),this.timeArrays.filter.push(!1),this.timeArrays.links.push([]),this._times.push(new Vo(t,this));for(let t=0;t<=ko.length;t++)this.timeObjects.push([])}if(0==this.timeArrays.length&&(this.timeArrays.id.push(0),this.timeArrays.momentTime.push(new Date(0)),this.timeArrays.unixTime.push(0),this.timeArrays.selections.push([]),this.timeArrays.filter.push(!1),this.timeArrays.links.push([]),this._times.push(new Vo(0,this))),console.assert(!t.locationTable||h(t.locationSchema.id)),t.locationTable)for(let e=0;e<t.locationTable.length;e++)this.locationArrays.id.push(t.locationTable[e][t.locationSchema.id]),this.locationArrays.label.push(t.locationTable[e][t.locationSchema.label]),this.locationArrays.longitude.push(t.locationTable[e][t.locationSchema.longitude]),this.locationArrays.latitude.push(t.locationTable[e][t.locationSchema.latitude]),this.locationArrays.x.push(t.locationTable[e][t.locationSchema.x]),this.locationArrays.y.push(t.locationTable[e][t.locationSchema.y]),this.locationArrays.z.push(t.locationTable[e][t.locationSchema.z]),this.locationArrays.radius.push(t.locationTable[e][t.locationSchema.radius]);"id"in this.locationArrays&&console.log("locations",this.locationArrays.id.length),console.assert(0==t.nodeTable.length||h(t.nodeSchema.id),"either there is no nodeTable data, or we have a schema for the nodetable");const p=[];for(const e in t.nodeSchema)Object.prototype.hasOwnProperty.call(t.nodeSchema,e)&&"id"!=e&&"label"!=e&&"time"!=e&&"name"!=e&&"nodeType"!=e&&"location"!=e&&"constructor"!=e&&(p.push(e),this.nodeArrays[e]=[]);for(let e=0;e<t.nodeTable.length;e++){if(c=t.nodeTable[e],u=c[t.nodeSchema.id],d=this.nodeArrays.id.indexOf(u),-1==d&&(d=this.nodeArrays.id.length,this.nodeArrays.id.push(u),this.nodeArrays.nodeType.push(""),this.nodeArrays.outLinks.push(new Wo),this.nodeArrays.inLinks.push(new Wo),this.nodeArrays.links.push(new Wo),this.nodeArrays.outNeighbors.push(new Wo),this.nodeArrays.inNeighbors.push(new Wo),this.nodeArrays.neighbors.push(new Wo),this.nodeArrays.selections.push([]),this.nodeArrays.filter.push(!1),this.nodeArrays.locations.push(new zo),this.nodeArrays.attributes.push(new Object),this.nodeArrays.color.push(""),this.nodeArrays.shape.push(""),h(t.nodeSchema.label)?this.nodeArrays.label.push(c[t.nodeSchema.label]):this.nodeArrays.label.push(c[t.nodeSchema.id])),h(t.nodeSchema.time)){o=c[t.nodeSchema.time],console.log("params"),console.log(o),console.log(po),console.log(null===(n=yo(o))||void 0===n?void 0:n.toUTCString()),console.log(null===(i=yo(o))||void 0===i?void 0:i.getTime());const e=this.getTimeIdForUnixTime(null===(r=yo(o))||void 0===r?void 0:r.getTime());f=null==o||null==e?this._times[0]:this._times[e]}else f=this._times[0];if(null==f&&(f=this._times[0]),h(t.nodeSchema.location)){const e=c[t.nodeSchema.location];if(null==e||null==e)continue;this.nodeArrays.locations[u].set(f,e)}if(h(t.nodeSchema.shape)){const e=c[t.nodeSchema.shape];this.nodeArrays.shape.push(e)}h(t.nodeSchema.nodeType)&&(g=t.nodeTable[e][t.nodeSchema.nodeType],m=this.nodeTypeArrays.name.indexOf(g),m<0&&(m=this.nodeTypeArrays.length,this.nodeTypeArrays.id.push(m),this.nodeTypeArrays.name.push(g)),this.nodeArrays.nodeType[d]=g,t.nodeTable[e][t.nodeSchema.nodeType]=m);for(let e=0;e<p.length;e++){const n=p[e];this.nodeArrays[n].push(c[t.nodeSchema[n]])}}if("id"in this.nodeArrays)for(let t=0;t<this.nodeArrays.id.length;t++)this.matrix.push(da(void 0,this.nodeArrays.id.length));let y,_,w,v,b;const x=[];for(const e in t.linkSchema)Object.prototype.hasOwnProperty.call(t.linkSchema,e)&&"id"!=e&&"linkType"!=e&&"time"!=e&&"name"!=e&&"source"!=e&&"target"!=e&&"weight"!=e&&"directed"!=e&&(x.push(e),this.linkArrays[e]=[]);console.log("linkUserProperties",x),console.assert(0==t.linkTable.length||h(t.linkSchema.id)&&h(t.linkSchema.source)&&h(t.linkSchema.target),"either there are no links, or the linkschema is defined");for(let e=0;e<t.linkTable.length;e++){if(c=t.linkTable[e],b=c[t.linkSchema.id],this.linkArrays.directed.push(!1),-1==this.linkArrays.id.indexOf(b)&&(this.linkArrays.id[b]=b,this.linkArrays.source[b]=c[t.linkSchema.source],this.linkArrays.target[b]=c[t.linkSchema.target],this.linkArrays.linkType[b]=c[t.linkSchema.linkType],this.linkArrays.directed[b]=c[t.linkSchema.directed],this.linkArrays.weights[b]=new zo,this.linkArrays.presence[b]=[],this.linkArrays.selections.push([]),this.linkArrays.nodePair.push(void 0),this.linkArrays.filter.push(!1)),h(t.linkSchema.time)){o=t.linkTable[e][t.linkSchema.time],l=null===(s=yo(o))||void 0===s?void 0:s.getTime();const n=l?this.getTimeIdForUnixTime(l):void 0;w=null!=n?n:0}else w=0;f=this._times[w],this.linkArrays.presence[b].push(w),h(t.linkSchema.weight)&&null!=t.linkTable[e][t.linkSchema.weight]?(this.linkArrays.weights[b].set(f,t.linkTable[e][t.linkSchema.weight]),this.minWeight=Math.min(this.minWeight,t.linkTable[e][t.linkSchema.weight]),this.maxWeight=Math.max(this.maxWeight,t.linkTable[e][t.linkSchema.weight])):(this.minWeight=0,this.maxWeight=1,this.linkArrays.weights[b].set(f,1)),y=this.nodeArrays.id.indexOf(c[t.linkSchema.source]),_=this.nodeArrays.id.indexOf(c[t.linkSchema.target]),this.nodeArrays.neighbors[y].add(f,_),this.nodeArrays.neighbors[_].add(f,y),this.nodeArrays.links[y].add(f,b),this.nodeArrays.links[_].add(f,b),this.linkArrays.directed[e]&&(this.nodeArrays.outNeighbors[y].add(f,_),this.nodeArrays.inNeighbors[_].add(f,y),this.nodeArrays.outLinks[y].add(f,b),this.nodeArrays.inLinks[_].add(f,b)),v=this.matrix[y][_],h(v)||(v=this.nodePairArrays.length,this.matrix[y][_]=v,this.nodePairArrays.id.push(v),this.nodePairArrays.source.push(y),this.nodePairArrays.target.push(_),this.nodePairArrays.links.push([]),this.nodePairArrays.selections.push([]),this.nodePairArrays.filter.push(!1)),-1==this.nodePairArrays.links[v].indexOf(b)&&(this.nodePairArrays.links[v].push(b),this.linkArrays.nodePair[b]=v),h(t.linkSchema.linkType)&&(g=t.linkTable[e][t.linkSchema.linkType],m=this.linkTypeArrays.name.indexOf(g),m<0&&(m=this.linkTypeArrays.length,this.linkTypeArrays.id.push(m),this.linkTypeArrays.name.push(g)),t.linkTable[e][t.linkSchema.linkType]=m);for(let e=0;e<x.length;e++){const n=x[e];this.linkArrays[n].push(c[t.linkSchema[n]])}}for(let t=0;t<this.linkArrays.length;t++)for(let e=0;e<this.timeArrays.length;e++)this.linkArrays.weights[t]&&Object.prototype.hasOwnProperty.call(this.linkArrays.weights[t].toArray(),this.timeArrays.id[e].toString())&&this.timeArrays.links[e].push(this.linkArrays.id[t]);const A=new Set(["#e4549b","#a33a36","#bd6221","#dfba47","#b5b867","#479b7f","#335b8e","#78387d"]),T={};this.nodeArrays.color.forEach((function(t){if(!T[t]){const e=Array.from(A),n=e[Math.floor(Math.random()*e.length)];T[t]=n,A.delete(n)}}));const S=new Set(["cross","diamond","square","triangle"]),k={};this.nodeArrays.shape.forEach((function(t){if(!k[t]){const e=Array.from(S),n=e[Math.floor(Math.random()*e.length)];k[t]=n,S.delete(n)}})),console.log("[Dynamic Graph] Dynamic Graph created: ",this.nodeArrays.length),console.log("[Dynamic Graph]    - Nodes: ",this.nodeArrays.length),console.log("[Dynamic Graph]    - Edges: ",this.linkArrays.length),console.log("[Dynamic Graph]    - Times: ",this.timeArrays.length),console.log("[Dynamic Graph]    - Link types: ",this.linkTypeArrays.length),console.log("[Dynamic Graph]    - Node Pairs: ",this.nodePairArrays.length),console.log('>>>this.nodeArrays["neighbors"][0]',this.nodeArrays.neighbors[0]),this.createGraphObjects(!0,!0),this.createSelections(!1)}createSelections(t){if(t){"nodeArrays"in this&&this.nodeArrays||(this.nodeArrays=new Co,this.linkArrays=new Lo,this.timeArrays=new Po,this.nodePairArrays=new Do),this.nodeArrays.selections=new Array(this.nodeArrays.length);for(let t=0;t<this.nodeArrays.selections.length;t++)this.nodeArrays.selections[t]=[];this.linkArrays.selections=new Array(this.linkArrays.length);for(let t=0;t<this.linkArrays.selections.length;t++)this.linkArrays.selections[t]=[];this.timeArrays.selections=new Array(this.timeArrays.length);for(let t=0;t<this.timeArrays.selections.length;t++)this.timeArrays.selections[t]=[];this.nodePairArrays.selections=new Array(this.nodePairArrays.length);for(let t=0;t<this.nodePairArrays.selections.length;t++)this.nodePairArrays.selections[t]=[]}this.defaultNodeSelection=this.createSelection("node"),this.defaultNodeSelection.name="Unselected";for(let t=0;t<this._nodes.length;t++)this.defaultNodeSelection.elementIds.push(t),this.addToAttributeArraysSelection(this.defaultNodeSelection,"node",this._nodes[t].id());this.defaultNodeSelection.color="#000000",this.defaultNodeSelection.showColor=!1,this.defaultNodeSelection.priority=1e4,this.selectionColor_pointer--,this.defaultLinkSelection=this.createSelection("link"),this.defaultLinkSelection.name="Unselected";for(let t=0;t<this._links.length;t++)this.defaultLinkSelection.elementIds.push(t),this.addToAttributeArraysSelection(this.defaultLinkSelection,"link",this._links[t].id());this.defaultLinkSelection.color="#000000",this.defaultLinkSelection.showColor=!1,this.defaultLinkSelection.priority=1e4,this.selectionColor_pointer--;let e,n,i,r=[];const s=[];for(let t=0;t<this.nodeArrays.nodeType.length;t++)e=this.nodeArrays.nodeType[t],null!=e&&0!=e.length&&"undefined"!=e&&(n=r.indexOf(e),-1==n?(i=this.createSelection("node"),i.name=e,s.push(i),r.push(e)):i=s[n],this.addElementToSelection(i,this._nodes[t]));1==s.length&&(console.log("nodeSelections[0]:",s[0]),s[0].color="#444"),r=[];const o=[];for(let t=0;t<this.linkArrays.linkType.length;t++)e=this.linkArrays.linkType[t],e&&"undefined"!=e&&(n=r.indexOf(e),-1==n?(i=this.createSelection("link"),i.name=e,o.push(i),r.push(e)):i=o[n],this.addElementToSelection(i,this._links[t]));1==o.length&&(o[0].color="#444"),this.currentSelection_id=0}createGraphObjects(t,e){console.log("[DynamicNetwork:createGraph()] >>> ");const n=Date.now();if(this.locationArrays&&"id"in this.locationArrays)for(let t=0;t<this.locationArrays.id.length;t++)this._locations.push(new Qo(this.locationArrays.id[t],this));else this.locationArrays=new Ho;const i=[];if("nodeArrays"in this&&this.nodeArrays)for(let t=0;t<this.nodeArrays.id.length;t++)i.push(new ea(t,this));const r=[];let s;if("linkArrays"in this&&this.linkArrays)for(let t=0;t<this.linkArrays.source.length;t++)s=new ia(t,this),r.push(s);if("nodePairArrays"in this&&this.nodePairArrays)for(let t=0;t<this.nodePairArrays.length;t++)this.nodePairArrays.links[t],this._nodePairs.push(new Ko(t,this));if(this._nodes=i,this._links=r,t){this._times=[];for(let t=0;t<this.timeArrays.length;t++)this._times.push(new Vo(t,this))}console.log("[DynamicNetwork:getGraph()] <<< ",Date.now()-n,"msec")}nodeAttr(t,e){return this.attr(t,e,"node")}linkAttr(t,e){return this.attr(t,e,"link")}pairAttr(t,e){return this.attr(t,e,"nodePair")}timeAttr(t,e){return this.attr(t,e,"time")}get startTime(){return this._times[0]}get endTime(){return this._times[this._times.length-1]}highlight(t,e){if("freeze"==t)return this.highlight("resetFreeze"),void this.highlight("addFreeze",e);if("resetFreeze"==t)return this.highlightFreezeArrays.nodeIds=[],this.highlightFreezeArrays.linkIds=[],this.highlightFreezeArrays.nodePairIds=[],void(this.highlightFreezeArrays.timeIds=[]);if("reset"==t)return this.highlightArrays.nodeIds=[],this.highlightArrays.linkIds=[],this.highlightArrays.nodePairIds=[],void(this.highlightArrays.timeIds=[]);if(e){if("set"==t)return this.highlight("reset"),void this.highlight("add",e);if("add"==t)for(const t in e)for(let n=0;n<e[t].length;n++)this.highlightArrays[t].push(e[t][n]);else if("remove"==t){let t;for(const n in e)for(let i=0;i<e[n].length;i++)t=this.highlightArrays[n].indexOf(e[n][i]),t>=0&&this.highlightArrays[n].splice(t,1)}if("addFreeze"==t)for(const t in e)for(let n=0;n<e[t].length;n++)this.highlightFreezeArrays[t].push(e[t][n]);else if("removeFreeze"==t){let t;for(const n in e)for(let i=0;i<e[n].length;i++)t=this.highlightFreezeArrays[n].indexOf(e[n][i]),t>=0&&this.highlightFreezeArrays[n].splice(t,1)}}else console.error("[DynamicGraph] highlight: idCompound not set!")}selection(t,e,n){null==n&&(n=this.currentSelection_id);const i=this.getSelection(n);if(i)if("set"==t){const t=new oa;t[i.acceptedType+"s"]=i.elementIds,this.selection("remove",t,n),this.selection("add",e,n)}else"add"==t?(e.linkIds.forEach((t=>this.addToSelectionByTypeAndId(i,"link",t))),e.nodeIds.forEach((t=>this.addToSelectionByTypeAndId(i,"node",t))),e.timeIds.forEach((t=>this.addToSelectionByTypeAndId(i,"time",t))),e.nodePairIds.forEach((t=>this.addToSelectionByTypeAndId(i,"nodePair",t)))):"remove"==t&&(e.linkIds.forEach((t=>this.removeFromSelectionByTypeAndId(i,"link",t))),e.nodeIds.forEach((t=>this.removeFromSelectionByTypeAndId(i,"node",t))),e.timeIds.forEach((t=>this.removeFromSelectionByTypeAndId(i,"time",t))),e.nodePairIds.forEach((t=>this.removeFromSelectionByTypeAndId(i,"nodePair",t))));else console.error("[DynamicGraph] Selection with ",n,"not found in ",this.selections)}addToAttributeArraysSelection(t,e,n){const i=this.attributeArrays[e].selections[n];for(let r=0;r<i.length;r++)if(i[r].priority>t.priority)return void this.attributeArrays[e].selections[n].splice(r,0,t);this.attributeArrays[e].selections[n].push(t)}removeFromAttributeArraysSelection(t,e,n){const i=this.attributeArrays[e].selections[n];for(let r=0;r<i.length;r++)i[r]==t&&this.attributeArrays[e].selections[n].splice(r,1)}addElementToSelection(t,e){this.addToSelectionByTypeAndId(t,e.type,e.id())}addToSelectionByTypeAndId(t,e,n){if(e!=t.acceptedType)return void console.log("attempting to put object of the wrong type into a selection. "+e+" !="+t.acceptedType);let i;t.elementIds.push(n),this.addToAttributeArraysSelection(t,e,n),"node"==e?(i=this.defaultNodeSelection.elementIds.indexOf(n),i>-1&&(this.removeFromAttributeArraysSelection(this.defaultNodeSelection,e,n),this.defaultNodeSelection.elementIds.splice(i,1))):"link"==e&&(i=this.defaultLinkSelection.elementIds.indexOf(n),i>-1&&(this.removeFromAttributeArraysSelection(this.defaultLinkSelection,e,n),this.defaultLinkSelection.elementIds.splice(i,1)))}removeElementFromSelection(t,e){this.removeFromSelectionByTypeAndId(t,e.type,e.id())}removeFromSelectionByTypeAndId(t,e,n){const i=t.elementIds.indexOf(n);-1!=i&&(t.elementIds.splice(i,1),this.removeFromAttributeArraysSelection(t,e,n),0==this.getSelectionsByTypeAndId(e,n).length&&("node"==e?(this.defaultNodeSelection.elementIds.push(n),this.addToAttributeArraysSelection(this.defaultNodeSelection,e,n)):"link"==e&&(this.defaultLinkSelection.elementIds.push(n),this.addToAttributeArraysSelection(this.defaultLinkSelection,e,n))))}getSelectionsByTypeAndId(t,e){return this.attributeArrays[t].selections[e]}filterSelection(t,e){const n=this.getSelection(t);null!=n&&(n.filter=e)}isFiltered(t,e){return this.attributeArrays[e+"s"].filter}isHighlighted(t,e){return this.highlightArrays[e+"Ids"].indexOf(t)>-1||this.highlightFreezeArrays[e+"Ids"].indexOf(t)>-1}isFrozen(t,e){return this.highlightFreezeArrays[e+"Ids"].indexOf(t)>-1}getHighlightedIds(t){return this.highlightArrays[t+"Ids"]}setCurrentSelection(t){console.log("[DynamicGraph] setCurrentSelectionId ",t),this.currentSelection_id=t}getCurrentSelection(){return this.getSelection(this.currentSelection_id)}addSelection(t,e,n,i){const r=this.createSelection(n);r.id=t,r.color=e,r.priority=i}createSelection(t){const e=new c(this.selections.length,t);return e.color=this.BOOKMARK_COLORS(this.selectionColor_pointer%10),this.selectionColor_pointer++,this.selections.push(e),e}deleteSelection(t){const e=this.getSelection(t);if(null!=e){const t=new oa;t[e.acceptedType+"Ids"]=e.elementIds.slice(0),console.log("Delete selection->remove elemeents",e.elementIds.slice(0)),this.selection("remove",t,e.id),this.selections.splice(this.selections.indexOf(e),1)}}setSelectionColor(t,e){const n=this.getSelection(t);n&&(n.color=e)}getSelections(t){const e=[];if(t){for(let n=0;n<this.selections.length;n++)this.selections[n].acceptsType(t)&&e.push(this.selections[n]);return e}return this.selections}getSelection(t){for(let e=0;e<this.selections.length;e++)if(t==this.selections[e].id)return this.selections[e];console.error("[DynamicGraph] No selection with id ",t,"found!")}clearSelections(){this.selections=[]}getTimeIdForUnixTime(t){let e;for(console.log("unixTime: "),console.log(t),e=0;e<this.timeArrays.length;e++)if(t==this.timeArrays.unixTime[e])return e;console.error("Time object for unix time",t,"not found!")}addNodeOrdering(t,e){for(let e=0;e<this.nodeOrders.length;e++)if(this.nodeOrders[e].name==t)return void console.error("Ordering",t,"already exists");const n=new Go(t,e);this.nodeOrders.push(n)}setNodeOrdering(t,e){for(let n=0;n<this.nodeOrders.length;n++)if(this.nodeOrders[n].name==t)return void(this.nodeOrders[n].order=e);console.error("Ordering",t,"does not exist")}removeNodeOrdering(t,e){for(let e=0;e<this.nodeOrders.length;e++)this.nodeOrders[e].name==t&&this.nodeOrders.splice(e,1)}getNodeOrder(t){for(let e=0;e<this.nodeOrders.length;e++)if(this.nodeOrders[e].name==t)return this.nodeOrders[e];console.error("Ordering",t,"not found!")}nodes(){return new ta(this.nodeArrays.id,this)}links(){return new na(this.linkArrays.id,this)}times(){return new Xo(this.timeArrays.id,this)}locations(){return new Yo(this.locationArrays.id,this)}nodePairs(){return new $o(this.nodePairArrays.id,this)}linksBetween(t,e){let n=this.matrix[t.id()][e.id()];if(null==n&&(n=this.matrix[e.id()][t.id()]),null==n)return new na([],this);const i=this.nodePair(n);return new na(null!=i?i.links().toArray():[],this)}get(t,e){return t.indexOf("nodePair")>-1?this.nodePair(e):t.indexOf("node")>-1?this.node(e):t.indexOf("link")>-1?this.link(e):t.indexOf("time")>-1?this.time(e):t.indexOf("locations")>-1?this.location(e):void 0}getAll(t){return"nodes"==t?this.nodes():"links"==t?this.links():"times"==t?this.times():"nodePairs"==t?this.nodePairs():this.locations()}node(t){for(let e=0;e<this._nodes.length;e++)if(this._nodes[e].id()==t)return this._nodes[e]}link(t){for(let e=0;e<this._links.length;e++)if(this._links[e].id()==t)return this._links[e]}time(t){for(let e=0;e<this._times.length;e++)if(this._times[e].id()==t)return this._times[e]}location(t){for(let e=0;e<this._locations.length;e++)if(this._locations[e].id()==t)return this._locations[e]}nodePair(t){for(let e=0;e<this._nodePairs.length;e++)if(this._nodePairs[e].id()==t)return this._nodePairs[e]}getMinGranularity(){return this.gran_min}getMaxGranularity(){return this.gran_max}}class No{constructor(){this.id=[]}get length(){return this.id.length}}class Co extends No{constructor(){super(...arguments),this.id=[],this.label=[],this.outLinks=[],this.inLinks=[],this.links=[],this.outNeighbors=[],this.inNeighbors=[],this.neighbors=[],this.selections=[],this.attributes=[],this.locations=[],this.filter=[],this.nodeType=[],this.color=[],this.shape=[]}}class Lo extends No{constructor(){super(...arguments),this.source=[],this.target=[],this.linkType=[],this.directed=[],this.nodePair=[],this.presence=[],this.weights=[],this.selections=[],this.filter=[],this.attributes=new Object}}class Do extends No{constructor(){super(...arguments),this.source=[],this.target=[],this.links=[],this.selections=[],this.filter=[]}}class Po extends No{constructor(){super(...arguments),this.id=[],this.momentTime=[],this.label=[],this.unixTime=[],this.selections=[],this.filter=[],this.links=[]}}class Fo extends No{constructor(){super(...arguments),this.name=[],this.count=[],this.color=[],this.filter=[]}}class Ro extends No{constructor(){super(...arguments),this.name=[],this.count=[],this.color=[],this.filter=[]}}class Ho extends No{constructor(){super(...arguments),this.id=[],this.label=[],this.longitude=[],this.latitude=[],this.x=[],this.y=[],this.z=[],this.radius=[]}}class Go{constructor(t,e){this.order=[],this.name=t,this.order=e}}class Uo{constructor(t){if(this._elements=[],t)for(let e=0;e<t.length;e++)null!=t[e]&&this._elements.push(t[e])}addUnique(t){-1==this._elements.indexOf(t)&&this._elements.push(t)}add(t){this._elements.push(t)}addAll(t){for(let e=0;e<t.length;e++)null!=t[e]&&this._elements.push(t[e])}addAllUnique(t){for(let e=0;e<t.length;e++)this.addUnique(t[e])}get length(){return this._elements.length}size(){return this._elements.length}ids(){return this._elements}removeDuplicates(){const t=this._elements.slice(0);this._elements=[];for(let e=0;e<t.length;e++)-1==this._elements.indexOf(t[e])&&this._elements.push(t[e]);return this}generic_intersection(t){const e=[];for(let n=0;n<this._elements.length;n++)for(let i=0;i<t._elements.length;i++)this._elements[n]==t._elements[i]&&e.push(this._elements[n]);return new Uo(e)}}class Bo extends Uo{constructor(t,e,n){super(t),this.g=e,this.elementType=n}generic_filter(t){const e=[];for(let n=0;n<this._elements.length;n++)try{t(this.g.get(this.elementType,this._elements[n]))&&e.push(this._elements[n])}catch(t){}return e}generic_selected(){const t=[];for(let e=0;e<this._elements.length;e++){const n=this.g.get(this.elementType,this._elements[e]);null!=n&&n.isSelected()&&t.push(this._elements[e])}return t}generic_visible(){const t=[];for(let e=0;e<this._elements.length;e++){const n=this.g.get(this.elementType,this._elements[e]);null!=n&&n.isVisible()&&t.push(this._elements[e])}return t}generic_highlighted(){const t=[];for(let e=0;e<this._elements.length;e++){const n=this.g.get(this.elementType,this._elements[e]);null!=n&&n.isHighlighted()&&t.push(this._elements[e])}return t}generic_presentIn(t,e){const n=[];for(let i=0;i<this._elements.length;i++){const r=this.g.get(this.elementType,this._elements[i]);null!=r&&r.presentIn(t,e)&&n.push(this._elements[i])}return n}generic_sort(t,e){if(0==this._elements.length)return this;const n=this._elements.slice(0);return n.sort(((n,i)=>{const r=this.g.get(this.elementType,n),s=this.g.get(this.elementType,i);return null!=r&&null!=s?sa(r,s,t,e):null==r&&null==s?0:null==r?1:-1})),this._elements=n,this}generic_removeDuplicates(){const t=[];for(let e=0;e<this._elements.length;e++)-1==t.indexOf(this._elements[e])&&t.push(this._elements[e]);return this._elements=t,this}}class jo{constructor(t,e,n){this._id=t,this.type=e,this.g=n}id(){return this._id}attr(t){return this.g.attr(t,this._id,this.type)}getSelections(){return this.g.attributeArrays[this.type].selections[this._id]}addToSelection(t){this.g.attributeArrays[this.type].selections[this._id].push(t)}removeFromSelection(t){const e=this.g.attributeArrays[this.type].selections[this._id];for(let n=0;n<e.length;n++)e[n]==t&&this.g.attributeArrays[this.type].selections[this._id].splice(n,1)}inSelection(t){return this.getSelections().indexOf(t)>-1}isSelected(t){if(!t)return this.getSelections().length>0;const e=this.g.attributeArrays[this.type].selections[this._id];for(let n=0;n<e.length;n++)if(e[n]!=this.g.defaultNodeSelection&&e[n]!=this.g.defaultLinkSelection&&e[n]==t)return!0;return!1}isHighlighted(){return this.g.isHighlighted(this._id,this.type)}isFrozen(){return this.g.isFrozen(this._id,this.type)}isFiltered(){return this.g.isFiltered(this._id,this.type)}isVisible(){const t=this.getSelections();if(0==t.length)return!0;for(let e=0;e<t.length;e++)if(t[e].filter)return!1;return!0}presentIn(t,e){const n=this.attr("presence");e||(e=t);for(let i=t._id;i<=e._id;i++)if(n.indexOf(i)>-1)return!0;return!1}}class zo{constructor(){this.serie={}}period(t,e){const n=t.id(),i=e.id(),r=new zo;for(const t in this.serie)parseInt(t)>=n&&parseInt(t)<=i&&(r.serie[t]=this.serie[t]);return r}set(t,e){this.serie[t.id()]=e}get(t){if(null!=this.serie[t.id()])return this.serie[t.id()]}size(){return this.toArray().length}getSerie(){return this.serie}toArray(t){null==t&&(t=!1);const e=[];if(t)for(const t in this.serie)e.push(this.serie[t]);else for(const t in this.serie)-1==e.indexOf(this.serie[t])&&e.push(this.serie[t]);return e}}class Wo{constructor(){this.serie={}}period(t,e){const n=t.id();t.id();const i=new Wo;for(const t in this.serie)parseInt(t)>=n&&parseInt(t)<=n&&(i.serie[t]=this.serie[t]);return i}add(t,e){null!=t&&(this.serie[t._id]||(this.serie[t._id]=[]),this.serie[t._id].push(e))}get(t){return this.serie[t._id]}toArray(){const t=[];for(const e in this.serie)t.push(this.serie[e]);return t}toFlatArray(t){null==t&&(t=!1);const e=[];for(const n in this.serie)for(let i=0;i<this.serie[n].length;i++)(!t||t&&-1==e.indexOf(this.serie[n]))&&e.push(this.serie[n][i]);return e}}class Xo extends Bo{constructor(t,e){if(super(t,e,"time"),t.length>0&&t[0]instanceof Vo){this._elements=[];for(let e=0;e<t.length;e++)this._elements.push(t[e].id())}if(t.length>0&&"number"==typeof t[0]){this._elements=[];for(let e=0;e<t.length;e++)this._elements.push(t[e])}}contains(t){return this._elements.indexOf(t.id())>-1}highlighted(){return new Xo(super.generic_highlighted(),this.g)}visible(){return new Xo(super.generic_visible(),this.g)}selected(){return new Xo(super.generic_selected(),this.g)}filter(t){return new Xo(super.generic_filter(t),this.g)}presentIn(t,e){return new Xo(super.generic_presentIn(t,e),this.g)}sort(t){return super.generic_sort(t)}links(){let t=[];for(let e=0;e<this._elements.length;e++)t=t.concat(this.g.attr("links",this._elements[e],"time"));return new na(t,this.g)}get(t){return this.g._times[this._elements[t]]}last(){return this.g._times[this._elements[this._elements.length-1]]}toArray(){const t=[],e=this.g._times;for(let n=0;n<this._elements.length;n++)t.push(e[this._elements[n]]);return t}createAttribute(t,e){if(null==this.g.timeArrays[t]){this.g.timeArrays[t]=[];for(let e=0;e<this.g._times.length;e++)this.g.timeArrays[t].push()}for(let n=0;n<this._elements.length;n++)this.g.timeArrays[t][this._elements[n]]=e(this.g._times[this._elements[n]]);return this}unixTimes(){const t=[];for(let e=0;e<this._elements.length;e++){const n=this.g.time(this._elements[e]);null!=n&&t.push(n.unixTime())}return t}intersection(t){return new Xo(this.generic_intersection(t)._elements,this.g)}forEach(t){for(let e=0;e<this._elements.length;e++)t(this.g.time(this._elements[e]),e);return this}}class Vo extends jo{constructor(t,e){super(t,"time",e),this.getWeek=Tt("%V")}time(){return this.attr("momentTime")}moment(){return this.attr("momentTime")}label(){return this.attr("label")}unixTime(){return this.attr("unixTime")}links(){return new na(this.attr("links"),this.g)}year(){return this.time().getUTCFullYear()}month(){return this.time().getUTCMonth()}week(){return parseInt(this.getWeek(this.time()))}day(){return this.time().getUTCDay()}hour(){return this.time().getUTCHours()}minute(){return this.time().getUTCMinutes()}second(){return this.time().getUTCSeconds()}millisecond(){return this.time().getMilliseconds()}format(t){return Tt(t)(this.time())}}class Yo extends Bo{constructor(t,e){if(super(t,e,"location"),t.length>0&&t[0]instanceof Qo){this._elements=[];for(let e=0;e<t.length;e++)this._elements=t[e].id()}if(t.length>0&&"number"==typeof t[0]){this._elements=[];for(let e=0;e<t.length;e++)this._elements.push(t[e])}}contains(t){return this._elements.indexOf(t.id())>-1}highlighted(){return new Yo(super.generic_highlighted(),this.g)}visible(){return new Yo(super.generic_visible(),this.g)}selected(){return new Yo(super.generic_selected(),this.g)}filter(t){return new Yo(super.generic_filter(t),this.g)}presentIn(t,e){return new Yo(super.generic_presentIn(t,e),this.g)}sort(t){return super.generic_sort(t)}get(t){return this.g._locations[this._elements[t]]}last(){return this.g._locations[this._elements[this._elements.length-1]]}toArray(){const t=[];for(let e=0;e<this._elements.length;e++)t.push(this.g._locations[this._elements[e]]);return t}createAttribute(t,e){if(null==this.g.locationArrays[t]){this.g.locationArrays[t]=[];for(let e=0;e<this.g._locations.length;e++)this.g.locationArrays[t].push()}for(let n=0;n<this._elements.length;n++)this.g.locationArrays[t][this._elements[n]]=e(this.g._locations[this._elements[n]]);return this}intersection(t){return new Yo(this.generic_intersection(t)._elements,this.g)}removeDuplicates(){return new Yo(this.generic_removeDuplicates()._elements,this.g)}forEach(t){for(let e=0;e<this._elements.length;e++)t(this.g.location(this._elements[e]),e);return this}}class qo extends Uo{clone(){return this._elements.slice(0)}min(){this._elements=this.makeNumbers(this._elements);let t=parseInt(this._elements[0]+"");for(let e=1;e<this._elements.length;e++)null!=this._elements[e]&&(t=Math.min(t,parseInt(this._elements[e]+"")));return t}max(){let t=parseInt(this._elements[0]+"");for(let e=1;e<this._elements.length;e++)null!=this._elements[e]&&(t=Math.max(t,parseInt(this._elements[e]+"")));return t}mean(){this._elements=this.makeNumbers(this._elements);let t=0,e=0;for(let n=0;n<this._elements.length;n++)"number"==typeof this._elements[n]&&(t+=parseInt(this._elements[n]+""),e++);return t/e}sum(){let t=0;for(let e=0;e<this._elements.length;e++)"number"==typeof this._elements[e]&&(t+=parseInt(this._elements[e]+""));return t}toArray(){return this._elements.slice(0)}get(t){return this._elements[t]}forEach(t){for(let e=0;e<this._elements.length;e++)t(this._elements[e],e);return this}makeNumbers(t){if(t&&t.length>0){if("string"==typeof t[0]){const e=[];for(let n=0;n<t.length;n++)e.push(parseFloat(t[n]+""));return console.log("string array converted",e),e}}return t}}class Qo extends jo{constructor(t,e){super(t,"location",e)}label(){return this.attr("label")+""}longitude(){return this.attr("longitude")}latitude(){return this.attr("latitude")}x(){return this.attr("x")}y(){return this.attr("y")}z(){return this.attr("z")}radius(){return this.attr("radius")}}class $o extends Bo{constructor(t,e){if(super(t,e,"nodePair"),t.length>0&&t[0]instanceof Ko){this._elements=[];for(let e=0;e<t.length;e++)this._elements.push(t[e].id())}if(t.length>0&&"number"==typeof t[0]){this._elements=[];for(let e=0;e<t.length;e++)this._elements.push(t[e])}}contains(t){return this._elements.indexOf(t.id())>-1}highlighted(){return new $o(super.generic_highlighted(),this.g)}visible(){return new $o(super.generic_visible(),this.g)}selected(){return new $o(super.generic_selected(),this.g)}filter(t){return new $o(super.generic_filter(t),this.g)}presentIn(t,e){return new $o(super.generic_presentIn(t,e),this.g)}sort(t){return super.generic_sort(t)}get(t){return this.g._nodePairs[this._elements[t]]}last(){return this.g._links[this._elements[this._elements.length-1]]}toArray(){const t=[];for(let e=0;e<this._elements.length;e++)t.push(this.g._nodePairs[this._elements[e]]);return t}createAttribute(t,e){if(null==this.g.nodePairArrays[t]){this.g.nodePairArrays[t]=[];for(let e=0;e<this.g._nodePairs.length;e++)this.g.nodePairArrays[t].push()}for(let n=0;n<this._elements.length;n++)this.g.nodePairArrays[t][this._elements[n]]=e(this.g._nodePairs[this._elements[n]]);return this}intersection(t){return new $o(this.generic_intersection(t)._elements,this.g)}removeDuplicates(){return new $o(this.generic_removeDuplicates()._elements,this.g)}forEach(t){for(let e=0;e<this._elements.length;e++)t(this.g.nodePair(this._elements[e]),e);return this}}class Ko extends jo{constructor(t,e){super(t,"nodePair",e)}get source(){return this.g._nodes[this.attr("source")]}get target(){return this.g._nodes[this.attr("target")]}links(){return new na(this.attr("links"),this.g)}nodeType(){return this.attr("nodeType")}presentIn(t,e){for(let n=0;n<this.links.length;n++)if(this.links[n].presentIn(t,e))return!0;return!1}}class Zo{constructor(t){this._elements=t?t.slice(0):[]}contains(t){return this._elements.indexOf(t)>-1}addUnique(t){-1==this._elements.indexOf(t)&&this._elements.push(t)}add(t){this._elements.push(t)}addAll(t){for(let e=0;e<t.length;e++)null!=t[e]&&this._elements.push(t[e])}addAllUnique(t){for(let e=0;e<t.length;e++)this.addUnique(t[e])}get length(){return this._elements.length}size(){return this._elements.length}toArray(){return this._elements.slice(0)}forEach(t){for(let e=0;e<this._elements.length;e++)t(this._elements[e],e);return this}}function Jo(t,e,n,i,r,s){let o,a=[];for(let l=0;l<e.length;l++){o=null!=s&&null!=r?i.attr(t,e[l],n).period(r,s).toArray():null!=r?[i.attr(t,e[l],n).get(r)]:i.attr(t,e[l],n).toArray();for(let t=0;t<o.length;t++)o[t]instanceof Array?a=a.concat(o[t]):-1==a.indexOf(o[t])&&a.push(o[t])}return a}class ta extends Bo{constructor(t,e){if(super(t,e,"node"),t.length>0&&t[0]instanceof ea){this._elements=[];for(let e=0;e<t.length;e++)this._elements.push(t[e].id())}else if(t.length>0&&"number"==typeof t[0]){this._elements=[];for(let e=0;e<t.length;e++)this._elements.push(t[e])}}contains(t){return this._elements.indexOf(t.id())>-1}highlighted(){return new ta(super.generic_highlighted(),this.g)}visible(){return new ta(super.generic_visible(),this.g)}selected(){return new ta(super.generic_selected(),this.g)}filter(t){return new ta(super.generic_filter(t),this.g)}presentIn(t,e){return new ta(super.generic_presentIn(t,e),this.g)}sort(t,e){return super.generic_sort(t,e)}label(){const t=new Zo;for(let e=0;e<this._elements.length;e++)t.add(""+this.g.attr("label",this._elements[e],"node"));return t}neighbors(t,e){return new ta(Jo("neighbors",this._elements,"node",this.g,t,e),this.g)}links(t,e){return new na(Jo("links",this._elements,"node",this.g,t,e),this.g)}locations(t,e){return new Yo(Jo("locations",this._elements,"node",this.g,t,e),this.g)}nodeTypes(){const t=new Zo;for(let e=0;e<this._elements.length;e++)t.add(this.g.attr("nodeType",this._elements[e],"node"));return t}get(t){return this.g._nodes[this._elements[t]]}last(){return this.g._nodes[this._elements[this._elements.length-1]]}toArray(){const t=[];for(let e=0;e<this._elements.length;e++)t.push(this.g._nodes[this._elements[e]]);return t}createAttribute(t,e){if(null==this.g.nodeArrays[t]){this.g.nodeArrays[t]=[];for(let e=0;e<this.g._nodes.length;e++)this.g.nodeArrays[t].push()}for(let n=0;n<this._elements.length;n++)this.g.nodeArrays[t][this._elements[n]]=e(this.g._nodes[this._elements[n]]);return this}intersection(t){return new ta(this.generic_intersection(t)._elements,this.g)}removeDuplicates(){return new ta(this.generic_removeDuplicates()._elements,this.g)}forEach(t){for(let e=0;e<this._elements.length;e++)t(this.g.node(this._elements[e]),e);return this}}class ea extends jo{constructor(t,e){super(t,"node",e)}label(){return""+this.attr("label")}shape(){return""+this.attr("shape")}color(){return""+this.attr("color")}nodeType(){return this.attr("nodeType")}neighbors(t,e){return new ta(null!=e&&null!=t?this.attr("neighbors").period(t,e).toFlatArray(!0):null!=t?this.attr("neighbors").get(t):this.attr("neighbors").toFlatArray(),this.g)}inNeighbors(t,e){return new ta(null!=e&&null!=t?this.attr("inNeighbors").period(t,e).toFlatArray(!0):null!=t?this.attr("inNeighbors").get(t):this.attr("inNeighbors").toFlatArray(!0),this.g)}outNeighbors(t,e){return new ta(null!=e&&null!=t?this.attr("outNeighbors").period(t,e).toFlatArray(!0):null!=t?this.attr("outNeighbors").get(t):this.attr("outNeighbors").toFlatArray(),this.g)}links(t,e){return new na(null!=e&&null!=t?this.attr("links").period(t,e).toFlatArray(!0):null!=t?this.attr("links").get(t):this.attr("links").toFlatArray(!0),this.g)}inLinks(t,e){return new na(null!=e&&null!=t?this.attr("inLinks").period(t,e).toFlatArray(!0):null!=t?this.attr("inLinks").get(t):this.attr("inLinks").toFlatArray(!0),this.g)}outLinks(t,e){return new na(null!=e&&null!=t?this.attr("outLinks").period(t,e).toFlatArray(!0):null!=t?this.attr("outLinks").get(t):this.attr("outLinks").toFlatArray(!0),this.g)}locations(t,e){return new Yo(null!=e&&null!=t?this.attr("locations").period(t,e).toArray():null!=t?[this.attr("locations").get(t)]:this.attr("locations").toArray(),this.g)}locationSerie(t,e){let n;n=null!=e&&null!=t?this.attr("locations").period(t,e):null!=t?this.attr("locations").get(t):this.attr("locations");const i=n.getSerie(),r=new zo;for(const t in i){const e=this.g.time(parseInt(t)),n=this.g.location(i[t]);null!=e&&null!=n&&r.set(e,n)}return r}linksBetween(t){const e=this.links().toArray(),n=[];let i;for(let r=0;r<e.length;r++)i=e[r],i.source!=t&&i.target!=t||n.push(i);return new na(n,this.g)}}class na extends Bo{constructor(t,e){if(super(t,e,"link"),t.length>0&&t[0]instanceof ia){this._elements=[];for(let e=0;e<t.length;e++)this._elements.push(t[e].id())}if(t.length>0&&"number"==typeof t[0]){this._elements=[];for(let e=0;e<t.length;e++)this._elements.push(t[e])}}contains(t){return this._elements.indexOf(t.id())>-1}highlighted(){return new na(super.generic_highlighted(),this.g)}visible(){return new na(super.generic_visible(),this.g)}selected(){return new na(super.generic_selected(),this.g)}filter(t){return new na(super.generic_filter(t),this.g)}presentIn(t,e){return new na(super.generic_presentIn(t,e),this.g)}sort(t){return super.generic_sort(t)}get(t){return this.g._links[this._elements[t]]}last(){return this.g._links[this._elements[this._elements.length-1]]}toArray(){const t=[];for(let e=0;e<this._elements.length;e++)t.push(this.g._links[this._elements[e]]);return t}weights(t,e){const n=new qo;for(let i=0;i<this._elements.length;i++){const r=this.g.link(i);null!=r&&n.addAll(r.weights(t,e).toArray())}return n}createAttribute(t,e){if(null==this.g.linkArrays[t]){this.g.linkArrays[t]=[];for(let e=0;e<this.g._links.length;e++)this.g.linkArrays[t].push()}for(let n=0;n<this._elements.length;n++)this.g.linkArrays[t][this._elements[n]]=e(this.g._links[this._elements[n]]);return this}linkTypes(){const t=[];let e;for(let n=0;n<this._elements.length;n++){const i=this.g.link(this._elements[n]);null!=i&&(e=i.linkType(),-1==t.indexOf(e)&&t.push(e))}return t}sources(){const t=[];let e;for(let n=0;n<this._elements.length;n++)e=this.g.link(this._elements[n]),null!=e&&-1==t.indexOf(e.source.id())&&t.push(e.source.id());return new ta(t,this.g)}targets(){const t=[];let e;for(let n=0;n<this._elements.length;n++)e=this.g.link(this._elements[n]),null!=e&&-1==t.indexOf(e.target.id())&&t.push(e.target.id());return new ta(t,this.g)}intersection(t){return new na(this.generic_intersection(t)._elements,this.g)}removeDuplicates(){return new na(this.generic_removeDuplicates()._elements,this.g)}forEach(t){for(let e=0;e<this._elements.length;e++)t(this.g.link(this._elements[e]),e);return this}}class ia extends jo{constructor(t,e){super(t,"link",e),this.targetNPO=void 0,this.sourceNPO=void 0}linkType(){return this.attr("linkType")}get source(){return this.g._nodes[this.attr("source")]}get target(){return this.g._nodes[this.attr("target")]}nodePair(){return this.g._nodePairs[this.attr("nodePair")]}directed(){return this.attr("directed")}other(t){return this.source==t?this.target:this.source}weights(t,e){return new qo(null==t?this.attr("weights").toArray():null==e?[this.attr("weights").get(t)]:this.attr("weights").period(t,e).toArray())}presentIn(t,e){return this.weights(t,e).toArray().length>0}times(){return new Xo(this.attr("presence"),this.g)}}class ra{constructor(t,e,n){this.id=t,this.name=e,this.color=n}}function sa(t,e,n,i){const r=t.attr(n);let s;return s="string"==typeof r?t.attr(n).localeCompare(e.attr(n)):"number"==typeof r?e.attr(n)-t.attr(n):0,0==i&&(s=-s),s}class oa{constructor(){this.nodeIds=[],this.linkIds=[],this.timeIds=[],this.nodePairIds=[],this.locationIds=[]}}function aa(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function la(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n))for(const i in t[n])Object.prototype.hasOwnProperty.call(t[n],i)&&(e[n][i]=t[n][i]);return e}function ha(t,e){const n=[];for(const i in t)n.push(la(t[i],e()));return n}function ca(t,e,n){let i=!0;if(null==t||null==e)return t==e;if(typeof t!=typeof e)return!1;if("object"!=typeof t)return!0;if(t.constructor!==e.constructor)return!1;if(n>0)for(const r in t)r in e&&Object.prototype.hasOwnProperty.call(t,r)&&Object.prototype.hasOwnProperty.call(e,r)&&!ca(t[r],e[r],n-1)&&(console.log("compareFailed for key",r,t[r],e[r]),i=!1);return i}function ua(t,e){return t-e}function da(t,e){const n=[];for(;e--;)n[e]=t;return n}var fa=Object.freeze({__proto__:null,GRANULARITY:ko,DGRAPH_SUB:Mo,DGRAPH_SER_VERBOSE_LOGGING:!1,dgraphReviver:Eo,dgraphReplacer:Io,DynamicGraph:Oo,AttributeArray:No,NodeArray:Co,LinkArray:Lo,NodePairArray:Do,TimeArray:Po,LinkTypeArray:Fo,NodeTypeArray:Ro,LocationArray:Ho,NodeType:class{constructor(t,e,n){this.id=t,this.name=e,this.color=n}},Ordering:Go,Query:Uo,GraphElementQuery:Bo,BasicElement:jo,ScalarTimeSeries:zo,ArrayTimeSeries:Wo,TimeQuery:Xo,Time:Vo,LocationQuery:Yo,NumberQuery:qo,Location:Qo,NodePairQuery:$o,NodePair:Ko,StringQuery:Zo,NodeQuery:ta,Node:ea,LinkQuery:na,Link:ia,LinkType:ra,attributeSort:sa,IDCompound:oa,copyPropsShallow:aa,copyTimeseriesPropsShallow:la,copyTimeSeries:ha,compareTypesDeep:ca,sortNumber:ua,array:da,doubleArray:function(t,e,n){const i=[];null==n&&(n=[]);const r=[];if(e)for(;e--;)r[e]=n;for(;t--;)i[t]=r.slice(0);return i}});class ga{constructor(){this.nodes=[],this.links=[],this.times=[],this.nodePairs=[],this.locations=[]}}function ma(t,e){return t.priority-e.priority}function pa(){const t={};let e,n;return window.location.search.replace("?","").split("&").forEach((function(i){e=i.split("="),n=decodeURIComponent(e[1]),t[e[0]]=n})),t}function ya(t){return parseInt(va(t).substring(0,2),16)}function _a(t){return parseInt(va(t).substring(2,4),16)}function wa(t){return parseInt(va(t).substring(4,6),16)}function va(t){return"#"==t.charAt(0)?t.substring(1,7):t}function ba(t){const e=new oa;return null!=t&&(t.nodes&&(e.nodeIds=t.nodes.map((t=>t.id()))),t.links&&(e.linkIds=t.links.map((t=>t.id()))),t.times&&(e.timeIds=t.times.map((t=>t.id()))),t.nodePairs&&(e.nodePairIds=t.nodePairs.map((t=>t.id())))),e}function xa(t,e,n,i,r,s){const o="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e))),a=document.createElement("canvas");a.width=n,a.height=i;const l=a.getContext("2d"),h=new Image;h.src=o,h.onload=function(){l.clearRect(0,0,n,i),s&&(l.fillStyle=s,l.fillRect(0,0,a.width,a.height)),l.drawImage(h,0,0,n,i),a.toBlob((function(e){r(e,t)}))}}function Aa(t){t.setAttribute("xlink","http://www.w3.org/1999/xlink");const e=function(t){const e=[];e.push("#"+t.id);for(let n=0;n<t.classList.length;n++)r("."+t.classList[n],e)||e.push("."+t.classList[n]);const n=t.getElementsByTagName("*");for(let t=0;t<n.length;t++){const i=n[t].id;r("#"+i,e)||e.push("#"+i);const s=n[t].classList;for(let t=0;t<s.length;t++)r("."+s[t],e)||e.push("."+s[t])}let i="";for(let t=0;t<document.styleSheets.length;t++){const n=document.styleSheets[t];try{if(!n.cssRules)continue}catch(t){if("SecurityError"!==t.name)throw t;continue}const s=n.cssRules;for(let t=0;t<s.length;t++){const n=s[t];r(n.selectorText,e)&&(i+=n.cssText)}}return i;function r(t,e){return e.includes(t)}}(t);!function(t,e){const n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML=t;const i=e.hasChildNodes()?e.children[0]:null;e.insertBefore(n,i)}(e,t);let n=(new XMLSerializer).serializeToString(t);return n=n.replace(/(\w+)?:?xlink=/g,"xmlns:xlink="),n=n.replace(/NS\d+:href/g,"xlink:href"),n}function Ta(t){let e;e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):unescape(t.split(",")[1]);const n=t.split(",")[0].split(":")[1].split(";")[0];console.log("mimeString",n);const i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);return new Blob([i],{type:n})}var Sa=Object.freeze({__proto__:null,getType:function(t){let e="";if(0!=t.length)return t[0]instanceof ea?e="node":t[0]instanceof ia?e="link":t[0]instanceof Vo?e="time":t[0]instanceof Ko?e="nodePair":t[0]instanceof ra?e="linkType":"number"==typeof t[0]&&(e="number"),e},makeElementCompound:function(t,e){const n=new ga;return null!=t&&(t.nodeIds&&(n.nodes=t.nodeIds.map((t=>e.node(t)))),t.linkIds&&(n.links=t.linkIds.map((t=>e.link(t)))),t.timeIds&&(n.times=t.timeIds.map((t=>e.time(t)))),t.nodePairIds&&(n.nodePairs=t.nodePairIds.map((t=>e.nodePair(t))))),n},ElementCompound:ga,getPriorityColor:function(t){let e=0;const n=t.getSelections();for(;!n[e].showColor;)if(e++,e==n.length)return void(e=-1);return t.getSelections()[e].color},sortByPriority:ma,getUrlVars:pa,capitalizeFirstLetter:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},isBefore:function(t,e){return t.time<e.time},isAfter:function(t,e){return t.time>e.time},hex2Rgb:function(t){return[ya(t),_a(t),wa(t)]},hex2web:function(t){return(t+="").replace("0x","#")},hex2RgbNormalized:function(t){return[ya(t)/255,_a(t)/255,wa(t)/255]},areEqualShallow:function(t,e){for(const n in t)if(!(n in e)||t[n]!==e[n])return!1;for(const n in e)if(!(n in t)||t[n]!==e[n])return!1;return!0},compareTypesShallow:function(t,e){return null==t||null==e?t==e:typeof t==typeof e&&("object"!=typeof t||t.constructor===e.constructor)},copyArray:function(t,e){const n=[];for(const i in t)n.push(aa(t[i],e()));return n},Box:class{constructor(t,e,n,i){this.x1=Math.min(t,n),this.x2=Math.max(t,n),this.y1=Math.min(e,i),this.y2=Math.max(e,i)}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}isPoint(){return 0==this.width&&0==this.height}},inBox:function(t,e,n){return t>n.x1&&t<n.x2&&e>n.y1&&e<n.y2},isSame:function(t,e){if(t.length!=e.length)return!1;let n=!0;for(let i=0;i<t.length;i++){n=!1;for(let r=0;r<e.length;r++)t[i]==e[r]&&(n=!0);if(!n)return!1}return!0},cloneCompound:function(t){const e=new oa;if(t.nodeIds){e.nodeIds=[];for(let n=0;n<t.nodeIds.length;n++)e.nodeIds.push(t.nodeIds[n])}if(t.linkIds){e.linkIds=[];for(let n=0;n<t.linkIds.length;n++)e.linkIds.push(t.linkIds[n])}if(t.nodePairIds){e.nodePairIds=[];for(let n=0;n<t.nodePairIds.length;n++)e.nodePairIds.push(t.nodePairIds[n])}if(t.timeIds){e.timeIds=[];for(let n=0;n<t.timeIds.length;n++)e.timeIds.push(t.timeIds[n])}return e},makeIdCompound:ba,arraysEqual:function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0},encapsulate:function(t,e){null==e&&(e="element");const n=[];let i;for(let r=0;r<t.length;r++)i={index:r},i[e]=t[r],n.push(i);return n},isPointInPolyArray:function(t,e){const n=t.length;let i=!1,r=-1,s=n-1;for(;++r<n;s=r)(t[r][1]<=e[1]&&e[1]<t[s][1]||t[s][1]<=e[1]&&e[1]<t[r][1])&&e[0]<(t[s][0]-t[r][0])*(e[1]-t[r][1])/(t[s][1]-t[r][1])+t[r][0]&&(i=!i);return i},downloadPNGFromCanvas:function(t){const e=Ta(document.getElementsByTagName("canvas")[0].toDataURL("image/png")),n=t+"_"+(new Date).toUTCString()+".png",i=document.createElement("a");i.download=n,i.href=window.URL.createObjectURL(e),i.click()},getBlobFromSVG:function(t,e,n){const i=document.querySelector("#"+e);if(!i)return;const r=i.scrollWidth,s=i.scrollHeight;null!=n&&xa(t,Aa(wi("#"+e).node()),r,s,n)},getBlobFromSVGNode:function(t,e,n,i){const r=Aa(e);let s=e.getAttribute("width"),o=e.getAttribute("height");null==s&&(s=window.innerWidth+1e3),null==o&&(o=window.innerHeight+1e3),xa(t,r,s,o,n,i)},getBlobFromSVGString:xa,getSVGString:Aa,exportPNG:function(t,e){const n=Ta(t.toDataURL("image/jpg",1)),i=e+"_"+(new Date).toUTCString()+".png",r=document.createElement("a");r.download=i,r.href=window.webkitURL.createObjectURL(n),r.click()},showMessage:function(t,e){var n;const i=()=>{const t=document.querySelector(".messageBox");t&&(t.outerHTML="")};i();const r=document.createElement("div");r.innerHTML=`\n  <div id="div" class="messageBox" style="\n                    width: 100%;\n                    height: 100%;\n                    background-color: #ffffff;\n                    opacity: .9;\n                    position: absolute;\n                    top: 0;\n                    left: 0;">\n  <div id="div" style="\n        font-size: 20pt;\n        font-weight: bold;\n        font-family: 'Helvetica Neue', Helvetica, sans-serif;\n        width: 500px;\n        padding-top: 300px;\n        text-align: center;\n        margin:auto;">\n          <p>${t}</p>\n   </div>             \n</div>\n  `;const s=()=>{const t=document.getElementById(".messageBox");if(!t)return;const e=setInterval((function(){t.style.opacity||(t.style.opacity="1"),+t.style.opacity>0?t.style.opacity=(+t.style.opacity-.1).toString():clearInterval(e)}),200)};null===(n=document.querySelector("body"))||void 0===n||n.appendChild(r),r.onclick=i,e&&window.setTimeout(s,e)},formatAtGranularity:To,formatTimeAtGranularity:Ao});var ka=Object.freeze({__proto__:null,orderNodes:function(t,e){const n=[],i=t.nodes().ids();let r,s,a,l,h,c;null!=e?(r=e.distance?e.distance:r.manhattan,s=e.nodes?e.nodes:t.nodes().toArray(),a=e.links?e.links:t.links().toArray(),l=e.start?e.start:t.startTime,h=e.end?e.end:t.endTime):(r=r.manhattan,s=t.nodes().toArray(),a=t.links().toArray(),l=t.startTime,h=t.endTime);for(let t=0;t<s.length;t++){c=[],n.push(c);for(let e=0;e<s.length;e++)n[t].push(0)}let u,d,f=0;for(let t=0;t<a.length;t++)f=0,u=s.indexOf(a[t].source),d=s.indexOf(a[t].target),-1!=u&&-1!=d&&(f+=a[t].weights(l,h).mean(),f?(n[u][d]=f,n[d][u]=f):console.log("weight",f));return o.optimal_leaf_order().reorder(n).forEach((function(t,e){i[s[t].id()]=e})),i},OrderingConfiguration:class{constructor(t,e){this.nodes=[],this.links=[],this.algorithm=[],this.distance=[],this.start=t,this.end=e}}});class Ma{constructor(t,e){this.nodes=[],this.links=[],this.times=[],this.nodes=t.slice(0),this.links=e.slice(0)}print(){console.log("nodes:",this.nodes.length,"links:",this.links.length)}}var Ea=Object.freeze({__proto__:null,Motif:Ma,MotifTemplate:class{constructor(t,e){this.nodes=[],this.links=[],this.nodes=t.slice(0),this.links=e.slice(0)}},MotifSequence:class{constructor(){this.motifs=[]}push(t){this.motifs.push(t)}},findTemplate:function(t,e,n){const i=e.nodes.length,r=e.links.length;for(let n=0;n<t.length;n++){t[n].links().toArray();for(let t=0;t<i;t++)for(let n=0;n<r;n++)e.links[n][0],e.nodes[t]}},findClusters:function(t,e){if(0==t.length)return[];const n=t[0].g,i=t[0].g.links().toArray();for(let t=0;t<i.length;t++)i[t].value=i[t].weights().sum();const r=a.default.cluster(t,i),s=[];let o,l=[];for(let t=0;t<r.length;t++)if(l=[],o=r[t],!(o.length<4)){for(let t=0;t<o.length;t++)o[t]=n.node(parseInt(o[t]));for(let t=0;t<o.length;t++)for(let e=t+1;e<o.length;e++)l=l.concat(o[t].linksBetween(o[e]).toArray());s.push({nodes:o,links:l})}return s},findFullEgoNetwork:function(t,e){const n=[];let i,r,s,o;for(let e=0;e<t.length;e++){o=t[e],s=[],i=o.neighbors().removeDuplicates(),r=i.links().removeDuplicates().toArray(),i=i.toArray().concat(o);for(let t=0;t<r.length;t++)null!=r[t]&&i.indexOf(r[t].source)>-1&&i.indexOf(r[t].target)>-1&&s.push(r[t]);n.push(new Ma(i,s))}return n}}),Ia={exports:{}};!function(t){var e=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function r(t,e){if(!i[t]){i[t]={};for(var n=0;n<t.length;n++)i[t][t.charAt(n)]=n}return i[t][e]}var s={compressToBase64:function(t){if(null==t)return"";var n=s._compress(t,6,(function(t){return e.charAt(t)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:s._decompress(t.length,32,(function(n){return r(e,t.charAt(n))}))},compressToUTF16:function(e){return null==e?"":s._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:s._decompress(t.length,16384,(function(e){return t.charCodeAt(e)-32}))},compressToUint8Array:function(t){for(var e=s.compress(t),n=new Uint8Array(2*e.length),i=0,r=e.length;i<r;i++){var o=e.charCodeAt(i);n[2*i]=o>>>8,n[2*i+1]=o%256}return n},decompressFromUint8Array:function(e){if(null==e)return s.decompress(e);for(var n=new Array(e.length/2),i=0,r=n.length;i<r;i++)n[i]=256*e[2*i]+e[2*i+1];var o=[];return n.forEach((function(e){o.push(t(e))})),s.decompress(o.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":s._compress(t,6,(function(t){return n.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),s._decompress(t.length,32,(function(e){return r(n,t.charAt(e))})))},compress:function(e){return s._compress(e,16,(function(e){return t(e)}))},_compress:function(t,e,n){if(null==t)return"";var i,r,s,o={},a={},l="",h="",c="",u=2,d=3,f=2,g=[],m=0,p=0;for(s=0;s<t.length;s+=1)if(l=t.charAt(s),Object.prototype.hasOwnProperty.call(o,l)||(o[l]=d++,a[l]=!0),h=c+l,Object.prototype.hasOwnProperty.call(o,h))c=h;else{if(Object.prototype.hasOwnProperty.call(a,c)){if(c.charCodeAt(0)<256){for(i=0;i<f;i++)m<<=1,p==e-1?(p=0,g.push(n(m)),m=0):p++;for(r=c.charCodeAt(0),i=0;i<8;i++)m=m<<1|1&r,p==e-1?(p=0,g.push(n(m)),m=0):p++,r>>=1}else{for(r=1,i=0;i<f;i++)m=m<<1|r,p==e-1?(p=0,g.push(n(m)),m=0):p++,r=0;for(r=c.charCodeAt(0),i=0;i<16;i++)m=m<<1|1&r,p==e-1?(p=0,g.push(n(m)),m=0):p++,r>>=1}0==--u&&(u=Math.pow(2,f),f++),delete a[c]}else for(r=o[c],i=0;i<f;i++)m=m<<1|1&r,p==e-1?(p=0,g.push(n(m)),m=0):p++,r>>=1;0==--u&&(u=Math.pow(2,f),f++),o[h]=d++,c=String(l)}if(""!==c){if(Object.prototype.hasOwnProperty.call(a,c)){if(c.charCodeAt(0)<256){for(i=0;i<f;i++)m<<=1,p==e-1?(p=0,g.push(n(m)),m=0):p++;for(r=c.charCodeAt(0),i=0;i<8;i++)m=m<<1|1&r,p==e-1?(p=0,g.push(n(m)),m=0):p++,r>>=1}else{for(r=1,i=0;i<f;i++)m=m<<1|r,p==e-1?(p=0,g.push(n(m)),m=0):p++,r=0;for(r=c.charCodeAt(0),i=0;i<16;i++)m=m<<1|1&r,p==e-1?(p=0,g.push(n(m)),m=0):p++,r>>=1}0==--u&&(u=Math.pow(2,f),f++),delete a[c]}else for(r=o[c],i=0;i<f;i++)m=m<<1|1&r,p==e-1?(p=0,g.push(n(m)),m=0):p++,r>>=1;0==--u&&(u=Math.pow(2,f),f++)}for(r=2,i=0;i<f;i++)m=m<<1|1&r,p==e-1?(p=0,g.push(n(m)),m=0):p++,r>>=1;for(;;){if(m<<=1,p==e-1){g.push(n(m));break}p++}return g.join("")},decompress:function(t){return null==t?"":""==t?null:s._decompress(t.length,32768,(function(e){return t.charCodeAt(e)}))},_decompress:function(e,n,i){var r,s,o,a,l,h,c,u=[],d=4,f=4,g=3,m="",p=[],y={val:i(0),position:n,index:1};for(r=0;r<3;r+=1)u[r]=r;for(o=0,l=Math.pow(2,2),h=1;h!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),o|=(a>0?1:0)*h,h<<=1;switch(o){case 0:for(o=0,l=Math.pow(2,8),h=1;h!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),o|=(a>0?1:0)*h,h<<=1;c=t(o);break;case 1:for(o=0,l=Math.pow(2,16),h=1;h!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),o|=(a>0?1:0)*h,h<<=1;c=t(o);break;case 2:return""}for(u[3]=c,s=c,p.push(c);;){if(y.index>e)return"";for(o=0,l=Math.pow(2,g),h=1;h!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),o|=(a>0?1:0)*h,h<<=1;switch(c=o){case 0:for(o=0,l=Math.pow(2,8),h=1;h!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),o|=(a>0?1:0)*h,h<<=1;u[f++]=t(o),c=f-1,d--;break;case 1:for(o=0,l=Math.pow(2,16),h=1;h!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),o|=(a>0?1:0)*h,h<<=1;u[f++]=t(o),c=f-1,d--;break;case 2:return p.join("")}if(0==d&&(d=Math.pow(2,g),g++),u[c])m=u[c];else{if(c!==f)return null;m=s+s.charAt(0)}p.push(m),u[f++]=s+m.charAt(0),s=m,0==--d&&(d=Math.pow(2,g),g++)}}};return s}();null!=t&&(t.exports=e)}(Ia);class Oa{constructor(t){this.keepOnlyOneSession=!1,this.session="",this.sessionDataPrefix="ncubesession",this.SEP="_",t?t.keepOnlyOneSession&&this.setOptions(t):this.keepOnlyOneSession=!1}setOptions(t){this.keepOnlyOneSession=t.keepOnlyOneSession}clearSessionData(t){const e=this.sessionDataPrefix+this.SEP+t,n=[];for(let t=0;t<localStorage.length;t++){const i=localStorage.key(t);i&&((0==i.indexOf(e)||0==i.indexOf("connectoscope1"))&&n.push(i))}for(let t=0;t<n.length;t++){const e=n[t];localStorage.removeItem(e)}}clearAllSessionData(){this.clearSessionData("")}isSessionCached(t,e){const n=this.sessionDataPrefix+this.SEP+t+this.SEP+e;for(let t=0;t<localStorage.length;t++){const e=localStorage.key(t);if(e&&0==e.indexOf(n))return!0}return!1}importData(t,e){if(this.session=t,e.nodeTable||e.linkTable){e.nodeTable||console.log("[n3] Node table missing!"),e.linkTable||console.log("[n3] Link table missing!"),e.nodeSchema||console.log("[n3] Node schema missing!"),e.linkSchema||console.log("[n3] Link schema missing!");for(let t=0;t<e.nodeTable.length;t++)for(let n=0;n<e.nodeTable[t].length;n++)"string"==typeof e.nodeTable[t][n]&&(e.nodeTable[t][n]=e.nodeTable[t][n].trim());for(let t=0;t<e.linkTable.length;t++)for(let n=0;n<e.linkTable[t].length;n++)"string"==typeof e.linkTable[t][n]&&(e.linkTable[t][n]=e.linkTable[t][n].trim());if(this.isSchemaWellDefined(e)){console.log("data is well-schematized, caching dynamicGraph"),this.keepOnlyOneSession&&this.clearAllSessionData();const t=new Oo;t.initDynamicGraph(e),t.saveDynamicGraph(this)}else console.log("data is not well-schematized, so not caching dynamicGraph")}else console.log("Empty tables. No data imported.")}saveToStorage(t,e,n,i){if(null==n)return void console.log("attempting to save undefined value. aborting",t,e);const r=JSON.stringify(n,i);let s;s=r.length>4194304?Ia.exports.compress(r):r,localStorage[this.sessionDataPrefix+this.SEP+this.session+this.SEP+t+this.SEP+e]=s}getFromStorage(t,e,n,i){let r;console.assert(""!=this.session),r=n?function(t,e){return n(t,e,i)}:void 0;const s=localStorage[this.sessionDataPrefix+this.SEP+this.session+this.SEP+t+this.SEP+e];if(s&&"undefined"!=s){let t;return t="true"==s||"false"!=s&&("\"'[{0123456789".indexOf(s[0])>=0?s:Ia.exports.decompress(s)),JSON.parse(t,r)}}removeFromStorage(t,e){localStorage.removeItem(this.sessionDataPrefix+this.SEP+this.session+this.SEP+t+this.SEP+e)}getGraph(t,e){return this.session=t,this.dynamicGraph&&this.dynamicGraph.name==e||(this.dynamicGraph=new Oo,this.dynamicGraph.loadDynamicGraph(this,e)),this.dynamicGraph}isSchemaWellDefined(t){return console.log("isSchemaWellDefined"),!(t.locationTable&&!h(t.locationSchema.id))&&(!(t.nodeTable.length>0&&!h(t.nodeSchema.id))&&!(t.linkTable.length>0&&!(h(t.linkSchema.id)&&h(t.linkSchema.source)&&h(t.linkSchema.target))))}}function Na(){return po}let Ca,La;function Da(t,e){const n=pa();return t||(t=n.datasetName),La=e||n.session,Ca.getGraph(La,t)}function Pa(t,e,n,i,r,s,o){const a=document.createElement("iframe");a.style.width=r.toString(),a.style.height=s.toString();const l=document.getElementById(t);if(!l)return;l.appendChild(a);let h="";for(const t in o)h+="&"+t+"="+o[t];if(!e.startsWith("http")){let t;t=window.location.port?location.protocol+"//"+window.location.hostname+":"+window.location.port+window.location.pathname:location.protocol+"//"+window.location.hostname+window.location.pathname,e=t+"/node_modules/vistorian-"+e+"/web/index.html"}return a.src=`${e}?session=${n}&datasetName=${i}${h}`,r&&(a.width=r.toString()),s&&(a.height=s.toString()),null!=o&&Object.prototype.hasOwnProperty.call(o,"scrolling")&&(a.scrolling=o.scrolling),a}function Fa(t,e,n,i){if(!e.startsWith("http")){let t;t=window.location.port?location.protocol+"//"+window.location.hostname+":"+window.location.port+window.location.pathname:location.protocol+"//"+window.location.hostname+window.location.pathname,e=t+"/node_modules/vistorian-"+e+"/web/index.html"}const r=e+"?session="+t+"&datasetName="+n;i?window.open(r,"_blank"):window.open(r)}var Ra;"undefined"!=typeof window&&(window.dataManager||(window.dataManager=new Oa),Ca=window.dataManager),function(t){t[t.Local=0]="Local",t[t.Global=1]="Global",t[t.Data=2]="Data"}(Ra||(Ra={}));var Ha=Object.freeze({__proto__:null,timeFormat:Na,getSessionId:function(){return La},setDataManagerOptions:function(t){Ca.setOptions(t)},isSessionCached:function(t,e){return Ca.isSessionCached(t,e)},importData:function(t,e){console.log("[n3] Import data",e.name),La=t,Ca.importData(t,e)},clearAllDataManagerSessionCaches:function(){Ca.clearAllSessionData()},getDynamicGraph:Da,openVisualizationWindow:function(t,e,n){Fa(t,e,n,!1)},openVisualizationTab:function(t,e,n){Fa(t,e,n,!0)},createTabVisualizations:function(t,e,n,i,r,s,o){const a=document.querySelector("#"+t);if(!a)return;const l=document.createElement("div");a.appendChild(l);const h=document.createElement("div");a.appendChild(h);const c=document.createElement("ul");l.appendChild(c),c.outerHTML='<ul class="networkcube-tabs"                    style="                        list-style-type: none;                        margin: 0;                        padding:2px;                        overflow: hidden;                        border: none;                        background-color: #f1f1f1;"                    ></ul>';for(let t=0;t<e.length;t++){e[t].name=e[t].name.replace(" ","-");const a=document.createElement("li");c.appendChild(a),a.outerHTML=`\n<li style="float: left;">\n  <a style="      display: inline-block;      color: black;      margin-right: 8px;      margin-left: 8px;      padding: 5px;      text-align: left;      text-decoration: none;      transition: 0.3s;      font-weight: 800;      border: #fff 1px solid;      border-radius: 5px;      font-size: 13px;" href="#" class="networkcube-tablinks" onclick="networkcube.switchVisTab(event, '${e[t].name}')">\n          ${e[t].name}\n  </a>\n</li>`;const l=document.createElement("div");h.appendChild(l),l.outerHTML=`<div id="networkcube-visTab-${e[t].name}" style="display:${0==t?"block":"none"};" class="networkcube-visTabContent"></div>`,Pa("networkcube-visTab-"+e[t].name,e[t].url,n,i,r,s,o)}},switchVisTab:function(t,e){const n=document.getElementsByClassName("networkcube-visTabContent");for(let t=0;t<n.length;t++)n[t].style.display="none";const i=document.getElementsByClassName("networkcube-tablinks");for(let t=0;t<i.length;t++)i[t].className=i[t].className.replace(" active","");const r=document.getElementById("networkcube-visTab-"+e);r&&(r.style.display="block"),t.currentTarget.className+=" active"},createVisualizationIFrame:Pa,getURLString:function(t){return"?session="+La+"&datasetName="+t},get OrderType(){return Ra},isTrackingEnabled:function(){return"true"==localStorage.getItem("NETWORKCUBE_IS_TRACKING_ENABLED")},isTrackingSet:function(){return null!==localStorage.getItem("NETWORKCUBE_IS_TRACKING_ENABLED")},deleteData:function(t){Da(t).delete(Ca)}});function Ga(t,e){const n=[],i=e.nodes;for(let t=0;t<i.length;t++)n.push([t,i[t].name]);const r=[],s=e.times;let o;for(let t=0;t<s.length;t++){o=s[t].matrix;for(let e=0;e<o.length;e++)for(let n=0;n<o.length;n++)r.push([e*o.length+n,e,n,o[e][n],t])}return new u({nodeTable:n,linkTable:r,linkSchema:{id:0,source:1,target:2,weight:3,time:4},nodeSchema:{id:0,label:1},name:t})}function Ua(t,e){const n=(new DOMParser).parseFromString(e,"text/xml"),i=n.documentElement.getElementsByTagName("node"),r=[],s=[];for(let t=0;t<i.length;t++)r.push([r.length,i[t].getAttribute("name")||i[t].getAttribute("id"),i[t].getAttribute("type")]),s.push(i[t].id);const o=[],a=new y(0,1,2),l=n.documentElement.getElementsByTagName("edge");let h,c,d,f;for(let t=0;t<l.length;t++)h=s.indexOf(l[t].getAttribute("source")||""),c=s.indexOf(l[t].getAttribute("target")||""),d==h&&f==c||(d=h,f=c,o.push([o.length,h,c]));return new u({name:t,nodeTable:r,linkTable:o,nodeSchema:{id:0,label:1,nodeType:2},linkSchema:a})}function Ba(t,e){let n=e.links;n||(n=e.edges),n||(n=e.connections),n||(n=e.relations);const i=[];let r,s=[];const o={id:0,source:1,target:2,weight:3};let a;const l=[];let h;for(let t=0;t<n.length;t++)for(h in r=n[t],r)Object.prototype.hasOwnProperty.call(r,h)&&"id"!=h&&"linkType"!=h&&"time"!=h&&"name"!=h&&"source"!=h&&"target"!=h&&"weight"!=h&&"directed"!=h&&null==o[h]&&(l.push(h),o[h]=3+l.length);for(let t=0;t<n.length;t++){r=n[t],a=1,null!=r.weight&&(a=r.weight),s=[t,r.source,r.target,a];for(let t=0;t<l.length;t++)h=l[t],null==r[h]?s.push(void 0):s.push(r[h]);i.push(s)}let c,d=e.nodes;d||(d=e.vertices);const f=[],g={id:0,label:1},m=[];for(let t=0;t<d.length;t++)for(h in c=d[t],c)Object.prototype.hasOwnProperty.call(c,h)&&"id"!=h&&"label"!=h&&"time"!=h&&"name"!=h&&"nodeType"!=h&&"location"!=h&&"constructor"!=h&&null==g[h]&&(m.push(h),g[h]=1+m.length);for(let t=0;t<d.length;t++){c=d[t],s=[t],c.name?s.push(c.name):c.label?s.push(c.label):s.push(""+t);for(let t=0;t<m.length;t++)h=m[t],null==c[h]?s.push(void 0):s.push(c[h]);f.push(s)}return new u({name:t,nodeTable:f,locationTable:[],linkTable:i,nodeSchema:g,locationSchema:{id:0,longitude:1,latitude:2},linkSchema:o})}function ja(t,e){const n=[];let i=[];const r=new y(0,1,2),s=e;let o;const a=[],l=new p(0),h=[];for(let t=0;t<s.length;t++)o=s[t],i=[t],o.name&&(i.push(o.name),l.label=1),o.label&&(i.push(o.name),l.label=1),h.push(o.name),a.push(i);let c,d;for(let t=0;t<s.length;t++)for(let e=0;e<s[t].imports.length;e++)c=h.indexOf(s[t].name),d=h.indexOf(s[t].imports[e]),-1==c||-1==d?console.error("---"):n.push([n.length,c,d]);return new u({name:t,nodeTable:a,linkTable:n,nodeSchema:l,linkSchema:r})}function za(t,e){const n=[],i=[],r=new p(0);r.id=0,r.label=1,r.nodeType=2;for(let t=0;t<e.nodes.length;t++)console.log("data.nodes[i].name.substring(0,3)",e.nodes[t].name.substring(0,3)),n.push([e.nodes[t].nodeId,e.nodes[t].name,e.nodes[t].name.substring(0,3)]);const s=new y(0,1,2);s.id=0,s.source=1,s.target=2,s.time=3,s.weight=4;for(let t=0;t<e.edges.length;t++){const n=vo(new Date,e.edges[t].timeIndex,"second");i.push([e.edges[t].edgeId,e.edges[t].sourceNodeId,e.edges[t].targetNodeId,_o(n),e.edges[t].weight])}return new u({name:t,nodeTable:n,linkTable:i,nodeSchema:r,linkSchema:s})}function Wa(t,e){const n=e.split("\n"),i=[],r=[];let s,o="";for(let t=0;t<n.length;t++)if(s=n[t],s.indexOf("*Vertices")>-1)o="nodes";else if(s.indexOf("*Arcs")>-1)o="undirectedLinks";else if(s.indexOf("*Edges")>-1)o="directedLinks";else{s=s.trim(),s=s.split(" ");for(let t=0;t<s.length;t)0==s[t].length?s.splice(t,1):t++;0!=s.length&&(o.indexOf("nodes")>-1?i.push([i.length,s[1]]):o.indexOf("undirectedLinks")>-1?r.push([r.length,parseInt(s[0])-1,parseInt(s[1])-1,!1]):o.indexOf("directedLinks")>-1&&r.push([r.length,parseInt(s[0])-1,parseInt(s[1])-1,!0]))}return new u({name:t,nodeTable:i,linkTable:r,nodeSchema:{id:0,label:1},linkSchema:{id:0,source:1,target:2,directed:3}})}function Xa(t,e){const n=e.split("\n"),i=[],r=[];let s,o="",a=0,l=0;for(let t=0;t<n.length;t++)if(s=n[t],s.indexOf("ROW LABELS")>-1)o="rows";else if(s.indexOf("COLUMN LABELS")>-1)o="cols";else if(s.indexOf("DATA:")>-1)o="links";else if(0!=o.length)if(s=s.trim(),s=s.split(" "),o.indexOf("rows")>-1)i.push([i.length,s[0]]),a++;else if(o.indexOf("cols")>-1){if(s[0].includes(i[0][1].toString())){o="",a=0;continue}i.push([i.length,s[0]])}else if(o.indexOf("links")>-1){for(let t=0;t<s.length;t++)1==parseInt(s[t])&&r.push([r.length,l,a+1]);l++}return new u({name:t,nodeTable:i,linkTable:r,nodeSchema:{id:0,label:1},linkSchema:{id:0,source:1,target:2}})}function Va(t,e){const n=[],i=[],r=e.split("\n");let s,o;const a=[],l=[],h=[],c=[],d=[],f=[];for(let t=0;t<r.length;t++)s=r[t].replace(/@/g,""),o=s.split(" "),o.length<3||(0==parseInt(o[0])&&o[2].indexOf("INDI")>-1?(a.push(o[1].trim()),l.push("")):1==parseInt(o[0])&&o[1].indexOf("SEX")>-1?l[l.length-1]=o[2].trim():0==parseInt(o[0])&&o[2].indexOf("FAM")>-1?(h.push(o[1].trim()),c.push([]),d.push(void 0),f.push(void 0)):1==parseInt(o[0])&&o[1].indexOf("CHIL")>-1?c[c.length-1].push(o[2].trim()):1==parseInt(o[0])&&o[1].indexOf("HUSB")>-1?d[c.length-1]=o[2].trim():1==parseInt(o[0])&&o[1].indexOf("WIFE")>-1&&(f[c.length-1]=o[2].trim()));for(let t=0;t<a.length;t++)n.push([t,a[t],l[t]]);let g,m,p;for(let t=0;t<h.length;t++){g=a.indexOf(d[t]),m=a.indexOf(f[t]),console.log("--\x3e",g,m,d[t],f[t]);for(let e=0;e<c[t].length;e++)p=a.indexOf(c[t][e]),null!=p&&-1!=p&&(null!=g&&g>-1&&i.push([i.length,g,p]),null!=m&&m>-1&&i.push([i.length,m,p]))}return new u({name:t,nodeTable:n,linkTable:i,nodeSchema:{id:0,label:1,nodeType:2},linkSchema:{id:0,source:1,target:2}})}function Ya(t,e){const n=e.split("\n"),i=[],r=[];let s,o,a,l=0;for(;l<n.length&&(s=n[l],-1!=s.indexOf("#"));l++);let h=" ";n[l].indexOf(",")>-1?h=",":n[l].indexOf("\t")>-1&&(h="\t");const c=[];let d;for(;l<n.length;l++){s=n[l],s=s.split(h);for(let t=0;t<s.length;t)0==s[t].length?s.splice(t,1):t++;if(s.length<2)continue;if(o=s[0].toLowerCase(),null==o||""==o)continue;let t=c.indexOf(o);if(-1==t&&(t=c.length,c.push(o)),a=s[1].toLowerCase(),null==a)continue;a=a.trim();let e=c.indexOf(a);-1==e&&(e=c.length,c.push(a)),d=1,r.push([r.length,t,e,1])}for(l=0;l<=c.length;l++)i.push([l,c[l]+""]);return new u({name:t,nodeTable:i,linkTable:r,nodeSchema:{id:0,label:1},linkSchema:{id:0,source:1,target:2,weight:3}})}function qa(t,e){const n=e.split("\n"),i=[],r=[],s=[];let o;const a=n[0].trim().split(",");for(let t=0;t<a.length;t++)o=a[t].trim(),i.push([i.length,o]),s.push(o);let l,h;for(let t=1;t<n.length;t++)if(h=n[t],h=h.trim(),h=h.split(","),l=s.indexOf(h[0].trim()),-1!=l)for(let t=1;t<h.length;t++)h[t].length>0&&parseInt(h[t].replace(/\s/g,""))>3e5&&r.push([r.length,l,t-1]);else console.error("Node",h[0],"not defined");return console.log("----\x3enodes found:",i.length),console.log("----\x3elinks found:",r.length),new u({name:t,nodeTable:i,linkTable:r,nodeSchema:{id:0,label:1},linkSchema:{id:0,source:1,target:2}})}var Qa=Object.freeze({__proto__:null,loadFromURL:function(t,e,n,i){const r=(i=i||e.split("=")[0])||"UNNAMED";new Map([["pajek",Wa],["mat",Xa],["gedcom",Va],["linkList",Ya],["matrix",qa]]).has(t)&&Ls(e).then((e=>{const i=s.get(t);i&&n(i(r,e))}));const s=new Map([["dyson",Ga],["json",Ba],["jsonList",ja],["NCube",za]]);s.has(t)&&function(t,e){return fetch(t,e).then(Ds)}(e).then((e=>{if(!e)return;const i=s.get(t);i&&n(i(r,e))})),"XML"===t&&Fs(e).then((t=>{if(!t)return;Ua&&n(Ua(r,t))}))},parseDyson:Ga,loadLinkTable:function(t,e,n,i,r){null==r&&(r="%Q"),null!=n.source?null!=n.target?fetch(t).then((t=>t.text())).then((s=>{const o=[],a=s.split("\r\n");for(let t=1;t<a.length;t++)o.push(a[t].split(i));const l=o,h=[],c=[],d=new p(0);let f,g,m;d.label=1;const _=[],w=new y(0,1,2);let v,b=3;for(const t in n)"source"!=t&&"target"!=t&&(w[t]=b++);l.shift();const x=St(r||"%Q"),A=Tt(Na());for(let t=0;t<l.length;t++)if(0!=l[t].length&&0!=l[t][0].length){v=new Array(b),null==n.id?v[0]=_.length:v[0]=l[t][n.id];for(let e=0;e<l[t].length;e++)l[t][e]=l[t][e].trim();if(m=l[t][n.source],-1==c.indexOf(m)&&c.push(m),f=c.indexOf(m),m=l[t][n.target],-1==c.indexOf(m)&&c.push(m),g=c.indexOf(m),v[w.source]=f,v[w.target]=g,null!=n.weight&&(v[w.weight]=Number(l[t][n.weight])),null!=n.time){const e=x(l[t][n.time]);v[w.time]=e?A(e):void 0}for(const e in n)"source"!=e&&"target"!=e&&"time"!=e&&"weight"!=e&&(v[w[e]]=l[t][n[e]]);_.push(v)}for(let t=0;t<c.length;t++)h.push([t,c[t]]);const T=new u({nodeTable:h,linkTable:_,linkSchema:w,nodeSchema:d,name:t});null!=n.time&&(T.timeFormat=Na()),e(T)})):console.error("[n3] Link Schema does not have -target- attribute. Import aborted."):console.error("[n3] Link Schema does not have -source- attribute. Import aborted.")},parseXML:Ua,parseJSON:Ba,parseJSONList:ja,parseNCube:za,parsePajek:Wa,parseMat:Xa,parseGEDCOM:Va,parseLinkList:Ya,parseMatrix:qa,exportCSV:function(t){let e="";for(let n=0;n<t.links().length;n++){const i=t.link(n);null!=i&&(e+=i.source.id()+","+i.target.id()+"\n")}return e},downloadText:function(t,e){const n=new Blob([t],{type:"text/text"}),i=e,r=document.createElement("a");r.download=i,r.href=window.webkitURL.createObjectURL(n),r.click()}});function $a(t,e,n){const i=t.toLowerCase().split(","),r=new oa;for(let s=0;s<i.length;s++)t=i[s].trim(),n&&"node"!=n||(r.nodeIds=r.nodeIds.concat(e.nodes().filter((e=>e.label().toLowerCase().indexOf(t)>-1||e.nodeType().toLowerCase().indexOf(t)>-1)).ids())),n&&"link"!=n||(r.linkIds=r.linkIds.concat(e.links().filter((e=>e.source.label().toLowerCase().indexOf(t)>-1||e.target.label().toLowerCase().indexOf(t)>-1||e.linkType().indexOf(t)>-1)).ids())),n&&"locations"!=n||(r.locationIds=r.locationIds.concat(e.locations().filter((e=>e.label().toLowerCase().indexOf(t)>-1)).ids()));return r}var Ka=Object.freeze({__proto__:null,searchForTerm:$a});const Za="highlight",Ja="selection",tl="timeRange",el="createSelection",nl="deleteSelection",il="setCurrentSelectionId",rl="setSelectionColor",sl="selectionColoring",ol="selectionFilter",al="selectionPriority",ll="searchResult",hl="SET_STATE",cl="GET_STATE",ul="STATE_CREATED",dl="ZOOM_INTERACTION",fl="CENTER_VIEW",gl=[Za,Ja,tl,el,nl,il,sl,ol,al,ll,rl,hl,cl,ul,dl];const ml=new class{};let pl=-1;window.addEventListener("storage",(function(){const t=localStorage[Fl];if(null==t||"undefined"==t)return;const e=Da(),n=JSON.parse(t,(function(t,n){return Eo(e,0,n)}));if(!n||n.id==pl)return;pl=n.id,Hl(n)}),!1);class yl{constructor(t){this.id=Math.random(),this.type=t,this.body=null}}class _l extends yl{constructor(t,e,n){super(Za),this.action=t,this.idCompound=null!=e?e:new oa,this.msg=null!=n?n:""}}class wl extends yl{constructor(t,e,n){super(Ja),this.action=t,this.idCompound=e,this.selectionId=null!=n?n:0}}function vl(t,e,n,i){const r=new bl(t,e);null==i&&(i=!1),i?Rl(r):Hl(r)}class bl extends yl{constructor(t,e){super(tl),this.startUnix=t,this.endUnix=e}}class xl extends yl{constructor(t){super(el),this.selection=t}}class Al extends yl{constructor(t){super(il),this.selectionId=t.id}}class Tl extends yl{constructor(t,e){super(sl),this.selectionId=t.id,this.showColor=e}}class Sl extends yl{constructor(t,e){super(ol),this.selectionId=t.id,this.filter=e}}class kl extends yl{constructor(t,e,n,i){super(al),this.selectionId1=t.id,this.selectionId2=e.id,this.priority1=n,this.priority2=i}}class Ml extends yl{constructor(t){super(nl),this.selectionId=t.id}}class El extends yl{constructor(t,e){super(rl),this.selectionId=t.id,this.color=e}}class Il extends yl{constructor(t){super(fl),this.selectionId=t.id}}class Ol extends yl{constructor(t,e){super(ll),this.idCompound=e,this.searchTerm=t}}class Nl{constructor(t,e,n){this.networkType=t,this.timeSliderStart=e,this.timeSliderEnd=n}}class Cl extends yl{constructor(t,e){super(hl),this.state=t,this.viewType=e}}class Ll extends yl{constructor(t,e,n,i){super(cl),this.bookmarkIndex=t,this.viewType=e,this.isNewBookmark=n,this.typeOfMultiView=i}}class Dl extends yl{constructor(t,e,n,i,r){super(ul),this.state=t,this.bookmarkIndex=e,this.viewType=n,this.isNewBookmark=i,this.typeOfMultiView=r}}class Pl extends yl{constructor(t,e){super(dl),this.visType=t,this.ineractionType=e}}const Fl="networkcube_message";function Rl(t,e){(null==e||e)&&Hl(t),localStorage[Fl]=JSON.stringify(t,(function(t,e){return Io(t,e)}))}function Hl(t){const e=Da();if(ml[t.type]){if(t.type==Za){const n=t;e.highlight(n.action,n.idCompound)}else if(t.type==Ja){const n=t;e.selection(n.action,n.idCompound,n.selectionId)}else if(t.type==tl);else if(t.type==sl){const n=t,i=e.getSelection(n.selectionId);null!=i&&(i.showColor=n.showColor)}else if(t.type==al){const n=t,i=e.getSelection(n.selectionId1),r=e.getSelection(n.selectionId2);null!=i&&(i.priority=n.priority1),null!=r&&(r.priority=n.priority2);const s=e.links().selected().toArray();for(let t=0;t<s.length;t++)s[t].getSelections().sort(ma);const o=e.nodes().selected().toArray();for(let t=0;t<o.length;t++)o[t].getSelections().sort(ma);const a=e.nodePairs().selected().toArray();for(let t=0;t<a.length;t++)a[t].getSelections().sort(ma)}else if(t.type==ol){const n=t;e.filterSelection(n.selectionId,n.filter)}else if(t.type==el){const n=t;e.addSelection(n.selection.id,n.selection.color,n.selection.acceptedType,n.selection.priority)}else if(t.type==il){const n=t;e.setCurrentSelection(n.selectionId)}else if(t.type==nl){const n=t;e.deleteSelection(n.selectionId)}else if(t.type==ll){const n=t;e.highlight("set",n.idCompound)}else if(t.type==rl){const n=t,i=e.getSelection(n.selectionId);null!=i&&(i.color=n.color)}else t.type==cl||t.type==hl||t.type==ul||t.type;ml[(n=t).type]&&null!=ml[n.type]&&ml[n.type](n)}var n}localStorage[Fl]=void 0;var Gl=Object.freeze({__proto__:null,MESSAGE_HIGHLIGHT:Za,MESSAGE_SELECTION:Ja,MESSAGE_TIME_RANGE:tl,MESSAGE_SELECTION_CREATE:el,MESSAGE_SELECTION_DELETE:nl,MESSAGE_SELECTION_SET_CURRENT:il,MESSAGE_SELECTION_COLORING:rl,MESSAGE_SELECTION_SET_COLORING_VISIBILITY:sl,MESSAGE_SELECTION_FILTER:ol,MESSAGE_SELECTION_PRIORITY:al,MESSAGE_SEARCH_RESULT:ll,MESSAGE_SET_STATE:hl,MESSAGE_GET_STATE:cl,MESSAGE_STATE_CREATED:ul,MESSAGE_ZOOM_INTERACTION:dl,MESSAGE_CENTER_VIEW_ON_SELECTION:fl,addEventListener:function(t,e){ml[t]=e},setDefaultEventListener:function(t){for(let e=0;e<gl.length;e++)ml[gl[e]]=t},Message:yl,sendMessage:function(t,e){const n=new yl(t);n.body=e,Rl(n,!0)},highlight:function(t,e,n){const i=Da(),r=ba(e);null!=e&&function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1}(e),null==!e&&(t="reset"),Rl(new _l(t,r,n));let s="auto";e&&i.currentSelection_id>0&&(s="url(/networkcube/icons/brush.png),auto");const o=document.querySelector("body");o&&(o.style.cursor=s)},HighlightMessage:_l,selection:function(t,e,n){const i=Da();n||(n=i.currentSelection_id);const r=ba(e);Rl(new wl(t,r,n))},SelectionMessage:wl,timeRange:vl,TimeRangeMessage:bl,createSelection:function(t,e){const n=Da().createSelection(t);return n.name=e,Rl(new xl(n),!1),n},CreateSelectionMessage:xl,setCurrentSelection:function(t){Da(),Rl(new Al(t))},SetCurrentSelectionIdMessage:Al,showSelectionColor:function(t,e){Rl(new Tl(t,e))},ShowSelectionColorMessage:Tl,filterSelection:function(t,e){Rl(new Sl(t,e))},FilterSelectionMessage:Sl,swapPriority:function(t,e){Rl(new kl(t,e,e.priority,t.priority))},SelectionPriorityMessage:kl,deleteSelection:function(t){Rl(new Ml(t))},DeleteSelectionMessage:Ml,setSelectionColor:function(t,e){Rl(new El(t,e))},centerViewOnSelection:function(t){Rl(new Il(t))},CenterViewMessage:Il,search:function(t,e){const n=$a(t,Da(),e);Rl(new Ol(t,n))},SearchResultMessage:Ol,NetworkControls:Nl,NodeLinkControls:class extends Nl{constructor(t,e,n,i,r,s,o,a,l,h,c,u){super(t,e,n),this.globalZoom=i,this.panOffsetGlobal=s,this.panOffsetLocal=r,this.linkOpacity=o,this.nodeOpacity=a,this.nodeSize=l,this.edgeGap=h,this.linkWidth=c,this.labellingType=u}},MatrixControls:class extends Nl{constructor(t,e,n,i,r){super(t,e,n),this.zoom=i,this.labellingType=r}},TimeArchsControls:class extends Nl{constructor(t,e,n,i){super(t,e,n),this.labellingType=i}},MapControls:class extends Nl{constructor(t,e,n,i,r,s){super(t,e,n),this.nodeOverlap=i,this.linkOpacity=r,this.opacityOfPositionlessNodes=s}},SetStateMessage:Cl,setState:function(t,e){Rl(new Cl(t,e),!0)},GetStateMessage:Ll,getState:function(t,e,n,i){Rl(new Ll(t,e,n,i),!0)},StateCreatedMessage:Dl,stateCreated:function(t,e,n,i,r){Rl(new Dl(t,e,n,i,r),!0)},ZoomInteractionMessage:Pl,zoomInteraction:function(t,e){Rl(new Pl(t,e),!0)},distributeMessage:Rl});var Ul=Object.freeze({__proto__:null,findDegree:function(t){const e=[];for(const n of t){const t=n.neighbors().removeDuplicates().toArray().concat(n),i=n.links().removeDuplicates().toArray();e.push(new Ma(t,i))}return e}});var Bl=Object.freeze({__proto__:null,schema1:["#775566","#6688bb","#556677","#88aa88","#88bb33","#cc7744","#003366","#994422","#331111"],schema2:["#44B3C2","#F1A94E","#E45641","#5D4C46","#7B8D8E","#2ca02c","#003366","#9467bd","#bcbd22","#e377c2"],schema3:["#001166","#0055aa","#1199cc","#99ccdd","#002222","#ddffff","#446655","#779988","#115522"],schema4:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],schema5:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],schema6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]});class jl{constructor(t,e,n){if(this.points=[],this.baseFunc=()=>0,this.baseFuncRangeInt=0,n){this.points=[];for(let e=0;e<t.length;e++)this.points.push(t[e])}else this.points=t;this.degree=e,this.dimension=t[0].length,2==e?(this.baseFunc=this.basisDeg2,this.baseFuncRangeInt=2):3==e?(this.baseFunc=this.basisDeg3,this.baseFuncRangeInt=2):4==e?(this.baseFunc=this.basisDeg4,this.baseFuncRangeInt=3):5==e&&(this.baseFunc=this.basisDeg5,this.baseFuncRangeInt=3)}seqAt(t){const e=this.points,n=this.degree+1;return function(i){return i<n?e[0][t]:e.length+n<=i?e[e.length-1][t]:e[i-n][t]}}basisDeg2(t){return-.5<=t&&t<.5?.75-t*t:.5<=t&&t<=1.5?1.125+(t/2-1.5)*t:-1.5<=t&&t<-.5?1.125+(1.5+t/2)*t:0}basisDeg3(t){return-1<=t&&t<0?2/3+(-1-t/2)*t*t:1<=t&&t<=2?4/3+t*((1-t/6)*t-2):-2<=t&&t<-1?4/3+t*(2+(1+t/6)*t):0<=t&&t<1?2/3+(t/2-1)*t*t:0}basisDeg4(t){return-1.5<=t&&t<-.5?55/96+t*(-5/24+t*(-5/4+(-5/6-t/6)*t)):.5<=t&&t<1.5?55/96+t*(5/24+t*(-5/4+(5/6-t/6)*t)):1.5<=t&&t<=2.5?625/384+t*(-125/48+t*(25/16+(-5/12+t/24)*t)):-2.5<=t&&t<=-1.5?625/384+t*(125/48+t*(25/16+(5/12+t/24)*t)):-1.5<=t&&t<1.5?115/192+t*t*(-5/8+t*t/4):0}basisDeg5(t){return-2<=t&&t<-1?.425+t*(-5/8+t*(-7/4+t*(-5/4+(-3/8-t/24)*t))):0<=t&&t<1?.55+t*t*((1/4-t/12)*t*t-.5):2<=t&&t<=3?2.025+t*(-27/8+t*(9/4+t*(-3/4+(1/8-t/120)*t))):-3<=t&&t<-2?2.025+t*(27/8+t*(9/4+t*(3/4+(1/8+t/120)*t))):1<=t&&t<2?.425+t*(5/8+t*(-7/4+t*(5/4+(-3/8+t/24)*t))):-1<=t&&t<0?.55+t*t*((1/4+t/12)*t*t-.5):0}getInterpol(t,e){const n=this.baseFunc,i=this.baseFuncRangeInt,r=Math.floor(e);let s=0;for(let o=r-i;o<=r+i;o++)s+=t(o)*n(e-o);return s}calcAt(t){if(t*=2*(this.degree+1)+this.points.length,2==this.dimension)return[this.getInterpol(this.seqAt(0),t),this.getInterpol(this.seqAt(1),t)];if(3==this.dimension)return[this.getInterpol(this.seqAt(0),t),this.getInterpol(this.seqAt(1),t),this.getInterpol(this.seqAt(2),t)];{const e=[];for(let n=0;n<this.dimension;n++)e.push(this.getInterpol(this.seqAt(n),t));return e}}}var zl=Object.freeze({__proto__:null,BSpline:jl});function Wl(t,e,n,i,r,s,o,a){r/=2,s/=2,t.push([e-r,n-s,i],[e+r,n-s,i],[e+r,n+s,i],[e+r,n+s,i],[e-r,n+s,i],[e-r,n-s,i]),o.push([a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]])}function Xl(t,e,n,i,r,s,o){const a=Math.PI/5.5;for(let l=0;l<11;l++)t.push([e+Math.cos(l*a)*r,n+Math.sin(l*a)*r,i],[e+Math.cos((l+1)*a)*r,n+Math.sin((l+1)*a)*r,i],[e,n,i]),s.push([o[0],o[1],o[2],o[3]],[o[0],o[1],o[2],o[3]],[o[0],o[1],o[2],o[3]])}function Vl(t){const e=new Float32Array(3*t.length);for(let n=0;n<t.length;n++)e[3*n+0]=t[n][0],e[3*n+1]=t[n][1],e[3*n+2]=t[n][2];return e}function Yl(t){const e=new Float32Array(4*t.length);for(let n=0;n<t.length;n++)e[4*n+0]=t[n][0],e[4*n+1]=t[n][1],e[4*n+2]=t[n][2],e[4*n+3]=t[n][3];return e}let ql,Ql=document.createElement("canvas");class $l{constructor(t){this.scene=new l.Scene,this.camera=new l.OrthographicCamera(0,0,0,0),this.renderer=new l.WebGLRenderer,this.geometry=new l.BufferGeometry,this.elementQueries=[],Ql=document.createElement("canvas"),Ql.setAttribute("id","textCanvas")}render(){for(let t=0;t<this.elementQueries.length;t++)(this.elementQueries[t].updateAttributes||this.elementQueries[t].updateStyle)&&this.elementQueries[t].set();this.renderer.render(this.scene,this.camera)}selectAll(){return Kl()}enableZoom(t){function e(t){t.preventDefault(),ql.camera.zoom+=t.wheelDelta/1e3,ql.camera.zoom=Math.max(.1,ql.camera.zoom),ql.camera.updateProjectionMatrix(),ql.render()}window.addEventListener("mousewheel",e,!1)}enablePanning(t){this.interactor.isPanEnabled=t}enableHorizontalPanning(t){this.interactor.isHorizontalPanEnabled=t}}function Kl(){const t=new Zl;return ql.elementQueries.push(t),t}class Zl{constructor(){this.dataElements=[],this.visualElements=[],this.mesh=new l.Mesh,this.children=[],this.scene=new l.Scene,this.x=[],this.y=[],this.z=[],this.r=[],this.fill=[],this.stroke=[],this.strokewidth=[],this.opacity=[],this.shape="",this.updateAttributes=!1,this.updateStyle=!1,this.IS_SHADER=!1,this.scene=ql.scene}data(t){return this.dataElements=t.slice(0),this}append(t){let e=[];switch(t){case"circle":oh(this,this.scene);break;case"path":e=lh(this.dataElements,this.scene);break;case"line":e=ch(this.dataElements,this.scene);break;case"rect":e=ah(this.dataElements,this.scene);break;case"text":e=uh(this.dataElements,this.scene);break;case"polygon":e=hh(this.dataElements,this.scene);break;default:console.error("Shape",t,"does not exist.")}if(!this.IS_SHADER)for(let t=0;t<e.length;t++)this.x.push(0),this.y.push(0),this.z.push(0);return this.shape=t,this.visualElements=e,this}push(t){return this.dataElements.push(t),this}getData(t){return this.dataElements[this.visualElements.indexOf(t)]}getVisual(t){return this.visualElements[this.dataElements.indexOf(t)]}get length(){return this.dataElements.length}filter(t){const e=[],n=[];for(let i=0;i<this.dataElements.length;i++)t(this.dataElements[i],i)&&(e.push(this.dataElements[i]),n.push(this.visualElements[i]));const i=(new Zl).data(e);return i.visualElements=n,i}attr(t,e){const n=this.visualElements.length;if(this.IS_SHADER)for(let n=0;n<this.dataElements.length;n++)this[t][n]=e instanceof Function?e(this.dataElements[n],n):e;else for(let i=0;i<n;i++)this.setAttr(this.visualElements[i],t,e instanceof Function?e(this.dataElements[i],i):e,i),Object.prototype.hasOwnProperty.call(this.visualElements[i],"wireframe")&&this.setAttr(this.visualElements[i].wireframe,t,e instanceof Function?e(this.dataElements[i],i):e,i);return this.updateAttributes=!0,this}style(t,e){const n=this.visualElements.length;if(this.IS_SHADER){t=t.replace("-","");for(let n=0;n<this.dataElements.length;n++)this[t][n]=e instanceof Function?e(this.dataElements[n],n):e}else for(let i=0;i<n;i++)Jl(this.visualElements[i],t,e instanceof Function?e(this.dataElements[i],i):e,this);return this.updateStyle=!0,this}set(){if(!this.IS_SHADER)return this;this.visualElements.length;const t=[],e=[];let n;if("circle"==this.shape)for(let i=0;i<this.dataElements.length;i++)n=new l.Color(this.fill[i]),Xl(t,this.x[i],this.y[i],this.z[i],this.r[i],e,[n.r,n.g,n.b,this.opacity[i]]);const i=this.mesh.geometry;return i.addAttribute("position",new l.BufferAttribute(Vl(t),3)),i.addAttribute("customColor",new l.BufferAttribute(Yl(e),4)),i.needsUpdate=!0,i.verticesNeedUpdate=!0,this.mesh.material.needsUpdate=!0,this.updateAttributes=!1,this.updateStyle=!1,this}text(t){const e=this.visualElements.length;for(let n=0;n<e;n++)this.visualElements[n].text=t instanceof Function?t(this.dataElements[n],n):t,null!=this.visualElements[n].text&&th(this.visualElements[n],this.visualElements[n].text);return this}on(t,e){switch(t){case"mouseover":this.mouseOverHandler=e;break;case"mousemove":this.mouseMoveHandler=e;break;case"mouseout":this.mouseOutHandler=e;break;case"mousedown":this.mouseDownHandler=e;break;case"mouseup":this.mouseUpHandler=e;break;case"click":this.clickHandler=e}return ql.interactor.register(this,t),this}call(t,e,n){const i=this.dataElements.indexOf(e);switch(t){case"mouseover":this.mouseOverHandler(e,i,n);break;case"mousemove":this.mouseMoveHandler(e,i,n);break;case"mouseout":this.mouseOutHandler(e,i,n);break;case"mousedown":this.mouseDownHandler(e,i,n);break;case"mouseup":this.mouseUpHandler(e,i,n);break;case"click":this.clickHandler(e,i,n)}return this}setAttr(t,e,n,i){switch(e){case"x":t.position.x=n,this.x[i]=n;break;case"y":t.position.y=n,this.y[i]=n;break;case"z":t.position.z=n,this.z[i]=n;break;case"x1":eh(t,n);break;case"y1":nh(t,n);break;case"x2":ih(t,n);break;case"y2":rh(t,n);break;case"r":t.scale.set(n,n,n);break;case"width":t.scale.setX(n);break;case"height":t.scale.setY(n);break;case"depth":t.scale.setZ(n);break;case"d":dh(t,n);break;case"points":fh(t,n);break;case"rotation":t.rotation.z=n*Math.PI/180;break;case"scaleX":t.scale.x=n;break;case"scaleY":t.scale.y=n;break;default:console.error("Attribute",e,"does not exist.")}t.geometry.verticesNeedUpdate=!0,t.geometry.elementsNeedUpdate=!0,t.geometry.lineDistancesNeedUpdate=!0}removeAll(){for(let t=0;t<this.visualElements.length;t++)this.visualElements[t].wireframe&&this.scene.remove(this.visualElements[t].wireframe),this.scene.remove(this.visualElements[t])}}function Jl(t,e,n,i){switch(e){case"fill":"text"==i.shape?th(t,t.text,{color:n}):t.material.color=new l.Color(n);break;case"stroke":Object.prototype.hasOwnProperty.call(t,"wireframe")?t.wireframe.material.color=new l.Color(n):t.material.color=new l.Color(n);break;case"opacity":t.material.opacity=n,Object.prototype.hasOwnProperty.call(t,"wireframe")&&(t.wireframe.material.opacity=n);break;case"stroke-width":Object.prototype.hasOwnProperty.call(t,"wireframe")?t.wireframe.material.linewidth=n:t.material.linewidth=n;break;case"font-size":t.scale.x=n/30,t.scale.y=n/30,t.geometry.verticesNeedUpdate=!0;break;default:console.error("Style",e,"does not exist.")}t.material.needsUpdate=!0,Object.prototype.hasOwnProperty.call(t,"wireframe")&&(t.wireframe.material.needsUpdate=!0)}function th(t,e,n){let i=n;null==i&&(i={}),null==i.color&&(i.color="#000000"),t.text=e;const r=document.createElement("canvas"),s=r.getContext("2d");let o=0;s&&(s.font="30pt Helvetica",o=s.measureText(e).width,r.width=o,r.height=30,s.textAlign="left",s.textBaseline="middle",s.fillStyle=i.color,s.font="30pt Helvetica",s.fillText(e,0,r.height/2));const a=new l.Texture(r);a.minFilter=l.LinearFilter,a.flipY=!0,a.needsUpdate=!0,t.material.map=a,t.material.transparent=!0,t.material.needsUpdate=!0,t.geometry=new l.PlaneGeometry(o,30),t.geometry.needsUpdate=!0,t.geometry.verticesNeedUpdate=!0,t.needsUpdate=!0}function eh(t,e){t.geometry.vertices[0].x=e}function nh(t,e){t.geometry.vertices[0].y=e}function ih(t,e){t.geometry.vertices[1].x=e}function rh(t,e){t.geometry.vertices[1].y=e}class sh{constructor(){this.position={x:0,y:0,z:0},this.children=[]}}function oh(t,e){const n=t.dataElements;t.IS_SHADER=!0;const i=new l.ShaderMaterial({vertexShader:"        attribute vec4 customColor;        varying vec4 vColor;        void main() {            vColor = customColor;            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1 );        }",fragmentShader:"        varying vec4 vColor;        void main() {            gl_FragColor = vec4(vColor[0], vColor[1], vColor[2], vColor[3]);        }"});i.blending=l.NormalBlending,i.depthTest=!0,i.transparent=!0,i.side=l.DoubleSide;const r=new l.BufferGeometry;Wl([],0,0,0,10,10,[],[0,0,1,.5]);for(let e=0;e<n.length;e++)t.x.push(0),t.y.push(0),t.z.push(0),t.r.push(0),t.fill.push("0x000000"),t.stroke.push("0x000000"),t.strokewidth.push(1),t.opacity.push(1);return r.addAttribute("position",new l.BufferAttribute(Vl([]),3)),r.addAttribute("customColor",new l.BufferAttribute(Yl([]),4)),t.mesh=new l.Mesh(r,i),t.mesh.position.set(0,0,1),e.add(t.mesh),t}function ah(t,e){let n;const i=[];let r;for(let s=0;s<t.length;s++){const t=new l.Shape;t.moveTo(0,0),t.lineTo(0,-1),t.lineTo(1,-1),t.lineTo(1,0),t.lineTo(0,0),n=new l.ShapeGeometry(t),r=new l.Mesh(n,new l.MeshBasicMaterial({color:0,transparent:!0})),r.position.set(0,0,1),i.push(r),e.add(r),n=new l.Geometry,n.vertices.push(new l.Vector3(0,0,0),new l.Vector3(0,-1,0),new l.Vector3(1,-1,0),new l.Vector3(1,0,0),new l.Vector3(0,0,0));const s=new l.Line(n,new l.LineBasicMaterial({color:0,transparent:!0,linewidth:1}));r.wireframe=s,s.position.set(0,0,1.1),e.add(s)}return i}function lh(t,e){let n;const i=[];let r;for(let s=0;s<t.length;s++)n=new l.Geometry,r=new l.Line(n,new l.LineBasicMaterial({color:0,transparent:!0})),r.position.set(0,0,0),i.push(r),e.add(r);return i}function hh(t,e){let n;const i=[];let r;for(let s=0;s<t.length;s++)n=new l.Geometry,r=new l.Mesh(n,new l.MeshBasicMaterial({color:0,transparent:!0,side:l.DoubleSide})),r.doubleSided=!0,r.position.set(0,0,0),i.push(r),e.add(r);return i}function ch(t,e){let n;const i=[];let r;for(let s=0;s<t.length;s++)n=new l.Geometry,n.vertices.push(new l.Vector3(-10,0,0),new l.Vector3(0,10,0)),r=new l.Line(n,new l.LineBasicMaterial({color:0,transparent:!0})),r.position.set(0,0,0),i.push(r),e.add(r);return i}function uh(t,e){const n=[];let i;for(let r=0;r<t.length;r++)i=new l.Mesh(new l.PlaneGeometry(1e3,100),new l.MeshBasicMaterial),i.doubleSided=!0,n.push(i),e.add(i);return n}function dh(t,e){t.geometry.vertices=[];for(let n=0;n<e.length;n++)t.geometry.vertices.push(new l.Vector3(e[n].x,e[n].y,0));t.geometry.verticesNeedUpdate=!0}function fh(t,e){const n=new l.Shape(e);t.geometry=new l.ShapeGeometry(n),t.geometry.verticesNeedUpdate=!0}class gh{constructor(t,e,n){this.mouse=[],this.mouseStart=[],this.mouseDown=!1,this.cameraStart=[],this.panOffset=[],this.lastIntersectedSelections=[],this.lastIntersectedElements=[],this.isPanEnabled=!0,this.isHorizontalPanEnabled=!0,this.isLassoEnabled=!0,this.lassoPoints=[],this.mouseOverSelections=[],this.mouseMoveSelections=[],this.mouseOutSelections=[],this.mouseDownSelections=[],this.mouseUpSelections=[],this.clickSelections=[],this.scene=t,this.canvas=e,this.camera=n,this.mouse=[0,0],e.addEventListener("mousemove",(t=>{this.mouseMoveHandler(t)})),e.addEventListener("mousedown",(t=>{this.mouseDownHandler(t)})),e.addEventListener("mouseup",(t=>{this.mouseUpHandler(t)})),e.addEventListener("click",(t=>{this.clickHandler(t)}))}register(t,e){switch(e){case"mouseover":this.mouseOverSelections.push(t);break;case"mousemove":this.mouseMoveSelections.push(t);break;case"mouseout":this.mouseOutSelections.push(t);break;case"mousedown":this.mouseDownSelections.push(t);break;case"mouseup":this.mouseUpSelections.push(t);break;case"click":this.clickSelections.push(t)}}addEventListener(t,e){"lassoStart"==t&&(this.lassoStartHandler=e),"lassoEnd"==t&&(this.lassoEndHandler=e),"lassoMove"==t&&(this.lassoMoveHandler=e)}mouseMoveHandler(t){if(this.mouse=mh(t.clientX,t.clientY),this.isLassoEnabled&&2==t.which)this.lassoPoints.push(this.mouse),this.lassoMoveHandler&&this.lassoMoveHandler(this.lassoPoints);else{let e=[];for(let t=0;t<this.lastIntersectedSelections.length;t++)for(let e=0;e<this.lastIntersectedElements[t].length;e++)this.lastIntersectedSelections[t].call("mouseout",this.lastIntersectedElements[t][e]);this.lastIntersectedSelections=[],this.lastIntersectedElements=[];let n=!0;for(let i=0;i<this.mouseOverSelections.length;i++){e=this.intersect(this.mouseOverSelections[i],this.mouse[0],this.mouse[1]),e.length>0&&(this.lastIntersectedElements.push(e),this.lastIntersectedSelections.push(this.mouseOverSelections[i]));for(let n=0;n<e.length;n++)this.mouseOverSelections[i].call("mouseover",e[n],t);e.length>0&&(n=!1)}for(let i=0;i<this.mouseMoveSelections.length;i++){e=this.intersect(this.mouseMoveSelections[i],this.mouse[0],this.mouse[1]);for(let n=0;n<e.length;n++)this.mouseMoveSelections[i].call("mousemove",e[n],t);e.length>0&&(n=!1)}n&&this.mouseDown&&this.isPanEnabled&&(this.panOffset=[t.clientX-this.mouseStart[0],t.clientY-this.mouseStart[1]],this.isHorizontalPanEnabled&&(ql.camera.position.x=this.cameraStart[0]-this.panOffset[0]/ql.camera.zoom),ql.camera.position.y=this.cameraStart[1]+this.panOffset[1]/ql.camera.zoom,ql.render())}}clickHandler(t){this.mouse=mh(t.clientX,t.clientY);let e=[];for(let n=0;n<this.clickSelections.length;n++){e=this.intersect(this.clickSelections[n],this.mouse[0],this.mouse[1]);for(let i=0;i<e.length;i++)this.clickSelections[n].call("click",e[i],t)}this.mouseDown=!1}mouseDownHandler(t){this.mouse=mh(t.clientX,t.clientY),this.mouseStart=[t.clientX,t.clientY],this.cameraStart=[ql.camera.position.x,ql.camera.position.y],this.mouseDown=!0;let e=[];for(let n=0;n<this.mouseDownSelections.length;n++){e=this.intersect(this.mouseDownSelections[n],this.mouse[0],this.mouse[1]);for(let i=0;i<e.length;i++)this.mouseDownSelections[n].call("mousedown",e[i],t)}this.lassoPoints=[],this.lassoPoints.push(this.mouse),this.lassoStartHandler&&2==t.which&&this.lassoStartHandler(this.lassoPoints)}mouseUpHandler(t){this.mouse=mh(t.clientX,t.clientY);let e=[];for(let n=0;n<this.mouseUpSelections.length;n++){e=this.intersect(this.mouseUpSelections[n],this.mouse[0],this.mouse[1]);for(let i=0;i<e.length;i++)this.mouseUpSelections[n].call("mouseup",e[i],t)}this.mouseDown=!1,this.lassoEndHandler&&2==t.which&&this.lassoEndHandler(this.lassoPoints)}intersect(t,e,n){switch(t.shape){case"circle":return this.intersectCircles(t);case"rect":case"text":return this.intersectRects(t);case"path":return this.intersectPaths(t)}return[]}intersectCircles(t){const e=[];let n;for(let i=0;i<t.dataElements.length;i++)n=Math.sqrt(Math.pow(this.mouse[0]-t.x[i],2)+Math.pow(this.mouse[1]-t.y[i],2)),n<=t.r[i]&&e.push(t.dataElements[i]);return e}intersectRects(t){const e=[];let n;for(let i=0;i<t.visualElements.length;i++)n=t.visualElements[i],this.mouse[0]>=n.position.x&&this.mouse[0]<=n.position.x+n.geometry.vertices[0].x*n.scale.x&&this.mouse[1]<=n.position.y&&this.mouse[1]>=n.position.y+n.geometry.vertices[1].y*n.scale.y&&e.push(t.dataElements[i]);return e}intersectPaths(t){const e=[];let n,i,r,s=!1;for(let o=0;o<t.visualElements.length;o++){n=t.visualElements[o];for(let a=1;a<n.geometry.vertices.length;a++)if(i=n.geometry.vertices[a-1],i={x:i.x+t.x[o],y:i.y+t.y[o]},r=n.geometry.vertices[a],r={x:r.x+t.x[o],y:r.y+t.y[o]},l({x:this.mouse[0],y:this.mouse[1]},i,r)<3){e.push(t.dataElements[o]),s=!0;break}if(s)break}return e;function o(t){return t*t}function a(t,e){return o(t.x-e.x)+o(t.y-e.y)}function l(t,e,n){const i=a(e,n);if(0==i)return a(t,e);const r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return a(t,r<0?e:r>1?n:{x:e.x+r*(n.x-e.x),y:e.y+r*(n.y-e.y)})}}}function mh(t,e){const n=ql.canvas.getBoundingClientRect();return[ql.camera.position.x+ql.camera.left/ql.camera.zoom+(t-n.left)/ql.camera.zoom,ql.camera.position.y+ql.camera.top/ql.camera.zoom-(e-n.top)/ql.camera.zoom]}function ph(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}var yh=Object.freeze({__proto__:null,makeAlphaBuffer:function(t,e){const n=new Float32Array(t.length*e);for(let i=0;i<t.length;i++)for(let r=0;r<e;r++)n[i*e+r]=t[i];return n},addBufferedHatchedRect:function(t,e,n,i,r,s,o,a){const l=r/3,h=e+(r/=2),c=n-(s/=2);for(let e=1;e<=3;e++)t.push([h-l*e,c,i],[h-l*e+1,c,i],[h,c+l*e+1,i],[h,c+l*e+1,i],[h,c+l*e,i],[h-l*e,c,i]),o.push([a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]])},addBufferedRect:Wl,addBufferedCirlce:Xl,addBufferedDiamond:function(t,e,n,i,r,s,o,a){r/=2,s/=2,t.push([e-r,n,i],[e,n-s,i],[e+r,n,i],[e+r,n,i],[e,n+s,i],[e-r,n,i]),o.push([a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]],[a[0],a[1],a[2],a[3]])},createRectFrame:function(t,e,n,i){t/=2,e/=2;const r=new l.Geometry;r.vertices=[new l.Vector3(-t,-e,0),new l.Vector3(-t,e,0),new l.Vector3(t,e,0),new l.Vector3(t,-e,0),new l.Vector3(-t,-e,0)];const s=new l.LineBasicMaterial({color:n});return new l.Line(r,s)},createDiagonalCross:function(t,e,n,i){t/=2,e/=2;const r=new l.Geometry;r.vertices=[new l.Vector3(-t,-e,0),new l.Vector3(-t,e,0),new l.Vector3(t,e,0),new l.Vector3(t,-e,0),new l.Vector3(-t,-e,0),new l.Vector3(t,e,0),new l.Vector3(0,0,0),new l.Vector3(-t,e,0),new l.Vector3(t,-e,0)];const s=new l.LineBasicMaterial({color:n,linewidth:i});return new l.Line(r,s)},makeBuffer3f:Vl,makeBuffer4f:Yl,updateBuffer:function(t,e,n){for(let i=0;i<e.length;i++)for(let r=0;r<n;r++)t[i*n+r]=e[i][r]},createText:function(t,e,n,i,r,s,o="normal",a="left"){const h=new l.TextGeometry(t,{size:r,height:1,curveSegments:1}),c=new l.MeshBasicMaterial({color:s}),u=new l.Mesh(h,c);if("right"==a){u.geometry.computeBoundingBox();const t=u.geometry.boundingBox;e-=t.max.x-t.min.x}return u.position.set(e,n,i),u},getMousePos:function(t,e,n){const i=t.getBoundingClientRect();return{x:e-i.left,y:n-i.top}},WebGL:$l,initWebGL:function(t,e,n,i){var r;ql=new $l(i),ql.camera=new l.OrthographicCamera(e/-2,e/2,n/2,n/-2,0,1e3),ql.scene=new l.Scene,ql.scene.add(ql.camera),ql.camera.position.z=100,ql.renderer=new l.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0}),ql.renderer.setSize(e,n),ql.renderer.setClearColor(16777215,1),ql.canvas=ql.renderer.domElement,null===(r=document.getElementById(t))||void 0===r||r.append(ql.canvas),ql.interactor=new gh(ql.scene,ql.canvas,ql.camera);const s=new l.PointLight(0,1,100);return s.position.set(0,0,1e3),ql.scene.add(s),ql},setWebGL:function(t,e,n,i){ql=new $l,ql.camera=e,ql.scene=t,ql.renderer=n},selectAll:Kl,WebGLElementQuery:Zl,setStyle:Jl,setText:th,setX1:eh,setY1:nh,setX2:ih,setY2:rh,createG:function(t,e){const n=[];for(let e=0;e<t.length;e++)n.push(new sh);return n},GroupElement:sh,createCirclesNoShader:function(t,e){let n,i;const r=[];let s;for(let o=0;o<t.length;o++)n=new l.MeshBasicMaterial({color:0,transparent:!0}),i=new l.CircleGeometry(1,10),i.dynamic=!0,s=new l.Mesh(i,n),r.push(s),s.position.set(0,0,1),s.scale.set(10,10,1),e.add(s);return r},createCirclesWithBuffers:oh,createRectangles:ah,createPaths:lh,createPolygons:hh,createLines:ch,createWebGLText:uh,createPath:dh,createPolygon:fh,WebGLInteractor:gh,mouseToWorldCoordinates:mh,curve:function(t){const e=[];for(let n=0;n<t.length;n++)isNaN(t[n].x)||e.push([t[n].x,t[n].y]);const n=new jl(e,3),i=[];for(let t=0;t<=1;t+=.01){const e=n.calcAt(t);i.push({x:e[0],y:e[1]})}return i},CheckBox:class{constructor(){this.selected=!1,this.changeCallBack=()=>null,this.frame=Kl().data([0]).append("circle").attr("r",5).style("fill","#fff").style("stroke","#000000").on("click",(()=>{this.selected=!this.selected,this.circle.style("opacity",this.selected?1:0),null!=this.changeCallBack&&this.changeCallBack()})),this.circle=Kl().data([0])}attr(t,e){switch(t){case"x":return this.frame.attr("x",e),this;case"y":return this.frame.attr("y",e),this}}on(t,e){if("change"===t)this.changeCallBack=e}},THREEx:class{constructor(t,e){const n=document.createElement("canvas");n.width=t,n.height=e,this.canvas=n;const i=n.getContext("2d");this.context=i;const r=new l.Texture(n);this.texture=r}clear(t){return void 0!==t?(this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)):this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.texture.needsUpdate=!0,this}drawText(t,e,n,i,r){if(void 0!==r&&(this.context.font=r),null==e){const n=this.context.measureText(t);e=(this.canvas.width-n.width)/2}return this.context.fillStyle=i,this.context.fillText(t,e,n),this.texture.needsUpdate=!0,this}drawTextCooked(t,e){const n=this.context,i=this.canvas,r={margin:void 0!==(e=e||{}).margin?e.margin:.1,lineHeight:void 0!==e.lineHeight?e.lineHeight:.1,align:void 0!==e.align?e.align:"left",fillStyle:void 0!==e.fillStyle?e.fillStyle:"black"};n.save(),n.fillStyle=r.fillStyle;let s=(r.lineHeight+r.margin)*i.height;for(;t.length>0;){const e=o(t);t=t.substr(e.length);const a=n.measureText(e);let l=!0,h=0;"left"===r.align?h=r.margin*i.width:"right"===r.align?h=(1-r.margin)*i.width-a.width:"center"===r.align?h=(i.width-a.width)/2:(l=!1,console.assert(!1)),l&&this.context.fillText(e,h,s),s+=r.lineHeight*i.height}return n.restore(),this.texture.needsUpdate=!0,this;function o(t){let e="";const s=(1-2*r.margin)*i.width;for(;e.length!==t.length;){if(n.measureText(e).width>s)break;e+=t.substr(e.length,1)}return e}}drawImage(...t){return this.context.drawImage.apply(...t),this.texture.needsUpdate=!0,this}},length:ph,normalize:function(t){const e=ph(t);return[t[0]/e,t[1]/e]},setLength:function(t,e){const n=ph(t);return[e*t[0]/n,e*t[1]/n]}});var _h=Object.freeze({__proto__:null,RangeSlider:class{constructor(t,e,n,i,r,s,o){this.BAR_WIDTH=5,this.RADIUS_HANDLE=4,this.LEFT=this.RADIUS_HANDLE,this.RIGHT=this.RADIUS_HANDLE,this.HEIGHT=10,this.TOP=0,this.isInverted=!1,this.dragEndCallBackFn=()=>null,this.dragStartXMouse=0,this.dragStartXBar=0,this.currentBarLength=0,this.x=t,this.y=e,this.width=n,this.min=i,this.max=r,this.stepWidth=s,this.hasTickmarks=null!=o&&o}setDragEndCallBack(t){this.dragEndCallBackFn=t}appendTo(t){if(this.svg=t,this.rect=this.svg._groups[0][0].getBoundingClientRect(),this.valueRange=co().domain([0,this.width]).range([this.min,this.max]),this.drag=Ni().on("start",(t=>{this.dragStart(t.sourceEvent)})).on("drag",(t=>{this.dragMove(t.sourceEvent)})),this.svg=t,this.g=t.append("g").attr("height",this.HEIGHT).attr("width",this.width).attr("transform","translate("+this.x+","+this.y+")"),this.g.append("line").attr("x1",this.LEFT).attr("y1",this.TOP).attr("x2",this.width-this.RIGHT-this.LEFT).attr("y2",this.TOP).style("stroke","#aaa"),this.hasTickmarks){this.val2spaceScale=co().domain([this.min,this.max]).range([this.LEFT,this.width-this.RIGHT-this.LEFT]);for(let t=this.min;t<=this.max;t+=this.stepWidth){const e=this.val2spaceScale(t);this.g.append("line").attr("class","rangeTick").attr("x1",e).attr("y1",this.TOP).attr("x2",e).attr("y2",this.TOP+20).style("stroke","#bbb"),this.g.append("text").attr("class","rangeTickText").attr("x",e).attr("y",this.TOP+20).text(t.toFixed(1)).style("opacity",.5).style("font-family","Helvetica").style("font-weigth","100").style("font-size","7pt")}}this.isInverted?(this.bar0=this.g.append("rect").attr("x",this.LEFT).attr("y",this.TOP).attr("height",this.BAR_WIDTH).attr("width",0).style("fill","#bbb").call(this.drag).attr("id","bar0"),this.bar1=this.g.append("rect").attr("x",this.RIGHT).attr("y",this.TOP).attr("height",this.BAR_WIDTH).attr("width",0).style("fill","#bbb").call(this.drag).attr("id","bar1")):(this.bar0=this.g.append("rect").attr("x",this.LEFT).attr("y",this.TOP).attr("height",this.BAR_WIDTH).attr("width",this.width-this.RIGHT-this.LEFT).style("fill","#bbb").call(this.drag).attr("id","bar0"),this.bar1=null),this.circleMin=this.g.append("circle").attr("id","sliderKnobMin").attr("r",this.RADIUS_HANDLE).attr("cx",this.LEFT).attr("cy",this.TOP+this.BAR_WIDTH).attr("fill","#777").attr("onchange","trace.event('vis_27',document.location.pathname,'Time Sliden Min','cx' + this.getAttribute('cx'))").attr("onmouseup","trace.event('vis_27',document.location.pathname,'Time Sliden Min','cx' + this.getAttribute('cx'))").call(this.drag),this.circleMax=this.g.append("circle").attr("id","sliderKnobMax").attr("r",this.RADIUS_HANDLE).attr("cx",this.width-this.RIGHT).attr("cy",this.TOP+this.BAR_WIDTH).attr("fill","#777").attr("onchange","trace.event('vis_28',document.location.pathname,'Time Sliden Max','cx' + this.getAttribute('cx'))").attr("onmouseup","trace.event('vis_28',document.location.pathname,'Time Sliden Max','cx' + this.getAttribute('cx'))").call(this.drag)}dragStart(t){this.dragStartXMouse=Math.max(this.LEFT,Math.min(this.width-this.RIGHT,this.getRelX(t)));const e=t;if(this.dragObj=e?e.target:void 0,this.isInverted){const t=parseInt(this.circleMin.attr("cx")),e=parseInt(this.circleMax.attr("cx"));this.dragStartXMouse<t?(this.dragStartXBar=this.LEFT,this.currentBarLength=t-this.LEFT):this.dragStartXMouse<e?(this.dragStartXBar=t,this.currentBarLength=e-t):(this.dragStartXBar=e,this.currentBarLength=this.width-this.RIGHT-e)}else this.dragStartXBar=parseInt(this.bar0.attr("x")),this.currentBarLength=parseInt(this.bar0.attr("width"))}dragMove(t){if(this.isInverted||this.dragObj.id!=this.bar0.attr("id")){if(this.isInverted&&(this.dragObj.id==this.bar0.attr("id")||this.dragObj.id==this.bar1.attr("id")))return;wi(this.dragObj).attr("cx",Math.max(this.LEFT,Math.min(this.width-this.RIGHT,this.getRelX(t)))),this.isInverted?(this.bar0.attr("x",this.LEFT).attr("width",this.circleMin.attr("cx")-this.LEFT),this.bar1.attr("x",this.circleMax.attr("cx")).attr("width",this.width-2*this.RIGHT-this.circleMax.attr("cx"))):this.bar0.attr("x",this.circleMin.attr("cx")).attr("width",this.circleMax.attr("cx")-this.circleMin.attr("cx"))}else{const e=Math.max(this.LEFT,Math.min(this.width-this.RIGHT,this.getRelX(t)))-this.dragStartXMouse,n=Math.max(this.LEFT,Math.min(this.width-this.RIGHT-this.currentBarLength,this.dragStartXBar+e));this.bar0.attr("x",n),this.circleMin.attr("cx",n),this.circleMax.attr("cx",n+this.currentBarLength)}this.dragEnd()}dragEnd(){this.min=this.valueRange(this.circleMin.attr("cx")),this.max=this.valueRange(this.circleMax.attr("cx")),this.dragEndCallBackFn(this.min,this.max)}getRelX(t){return(t?t.pageX:0)-this.LEFT-this.x-this.rect.left}set(t,e){this.circleMin.attr("cx",this.valueRange.invert(t)),this.circleMax.attr("cx",this.valueRange.invert(e)),this.isInverted?(this.bar0.attr("x",this.LEFT).attr("width",this.circleMin.attr("cx")),this.bar1.attr("x",this.circleMax.attr("cx")).attr("width",this.width-2*this.RIGHT-this.circleMax.attr("cx"))):this.bar0.attr("x",this.circleMin.attr("cx")).attr("width",this.circleMax.attr("cx")-this.circleMin.attr("cx"))}setIsInverted(t){t!=this.isInverted&&(this.isInverted=t,this.isInverted?this.bar1=this.g.insert("rect","#bar0").attr("x",this.RIGHT).attr("y",this.TOP).attr("height",this.BAR_WIDTH).attr("width",0).style("fill","#bbb").call(this.drag).attr("id","bar1"):this.bar1.remove(),this.set(this.min,this.max))}}});class wh{constructor(t,e,n,i,r,s){this.BAR_WIDTH=5,this.RADIUS_HANDLE=5,this.LEFT=this.RADIUS_HANDLE,this.RIGHT=this.RADIUS_HANDLE,this.HEIGHT=10,this.TOP=0,this.dragEndCallBackFn=t=>null,this.x=t,this.y=e,this.width=n,this.min=i,this.max=r,this.value=this.min,this.stepWidth=s}setDragEndCallBack(t){this.dragEndCallBackFn=t}appendTo(t){this.svg=t,this.rect=this.svg._groups[0][0].getBoundingClientRect(),this.valueRange=co().domain([0,this.width]).range([this.min,this.max]),this.drag=Ni().on("start",(t=>{this.dragStart(t.sourceEvent)})).on("drag",(t=>{this.dragMove(t.sourceEvent)})),this.svg=t,this.g=t.append("g").attr("height",this.HEIGHT).attr("width",this.width).attr("transform","translate("+this.x+","+this.y+")"),this.g.append("line").attr("x1",this.LEFT).attr("y1",this.TOP).attr("x2",this.width-this.RIGHT-this.LEFT).attr("y2",this.TOP).style("stroke","#aaa"),this.knob=this.g.append("circle").attr("id","#sliderKnob").attr("r",this.RADIUS_HANDLE).attr("cx",this.LEFT).attr("cy",this.TOP).attr("fill","#777").attr("onchange","trace.event('vis_4',document.location.pathname,this.parentElement.previousElementSibling.innerHTML ,'cx' + this.getAttribute('cx'))").attr("onmouseup","trace.event('vis_4',document.location.pathname,this.parentElement.previousElementSibling.innerHTML ,'cx' + this.getAttribute('cx'))").call(this.drag)}dragStart(t){this.dragStartXMouse=Math.max(this.LEFT,Math.min(this.width-this.RIGHT,this.getRelX(t))),this.dragObj=t?t.target:void 0}dragMove(t){wi(this.dragObj).attr("cx",Math.max(this.LEFT,Math.min(this.width-this.RIGHT,this.getRelX(t)))),this.dragEnd()}dragEnd(){this.value=this.valueRange(this.knob.attr("cx")),this.dragEndCallBackFn(this.value)}getRelX(t){return(t?t.pageX:0)-this.LEFT-this.x-this.rect.left}set(t){this.knob.attr("cx",this.valueRange.invert(t))}}var vh=Object.freeze({__proto__:null,Slider:wh});class bh{constructor(t,e,n,i,r,s,o){this.BAR_WIDTH=15,this.RADIUS_HANDLE=5,this.LEFT=0,this.RIGHT=0,this.HEIGHT=10,this.TOP=0,this.isInverted=!1,this.dragEndCallBackFn=()=>null,this.singleTimeStepX=0,this.dragStartXMouse=0,this.dragStartXBar=0,this.currentBarLength=0,this.x=t,this.y=e,this.width=n,this.min=i,this.max=r,this.stepWidth=s,this.hasTickmarks=null!=o&&o}setDragEndCallBack(t){this.dragEndCallBackFn=t}appendTo(t){if(this.svg=t,this.rect=this.svg._groups[0][0].getBoundingClientRect(),this.valueRange=co().domain([0,this.width]).range([this.min,this.max]),this.svg=t,this.g=t.append("g").attr("height",this.HEIGHT).attr("width",this.width).attr("transform","translate("+this.x+","+this.y+")"),this.drag=Ni().on("start",(t=>{this.dragStart(t.sourceEvent)})).on("drag",(t=>{this.dragMove(t.sourceEvent)})),this.g.append("line").attr("x1",this.LEFT).attr("y1",this.TOP).attr("x2",this.width-this.RIGHT-this.LEFT).attr("y2",this.TOP).style("stroke","#aaa"),this.hasTickmarks){this.val2spaceScale=co().domain([this.min,this.max]).range([this.LEFT,this.width-this.RIGHT-this.LEFT]);for(let t=this.min;t<=this.max;t+=this.stepWidth){const e=this.val2spaceScale(t);this.g.append("line").attr("class","rangeTick").attr("x1",e).attr("y1",this.TOP).attr("x2",e).attr("y2",this.TOP+20).style("stroke","#bbb"),this.g.append("text").attr("class","rangeTickText").attr("x",e).attr("y",this.TOP+20).text(t.toFixed(1)).style("opacity",.5).style("font-family","Helvetica").style("font-weigth","100").style("font-size","7pt")}}this.isInverted?(this.bar0=this.g.append("rect").attr("x",this.LEFT).attr("y",this.TOP).attr("height",this.BAR_WIDTH).attr("width",0).style("fill","#bbb").call(this.drag).attr("id","bar0").attr("onmouseup","trace.event('vis_43',document.location.pathname,'Time Slider','x' + this.getAttribute('x') + 'width' + this.getAttribute('width'))").attr("oninput","trace.event('vis_43',document.location.pathname,'Time Slider','x' + this.getAttribute('x') + 'width' + this.getAttribute('width'))"),this.bar1=this.g.append("rect").attr("x",this.RIGHT).attr("y",this.TOP).attr("height",this.BAR_WIDTH).attr("width",0).style("fill","#bbb").call(this.drag).attr("id","bar1").attr("onmouseup","trace.event('vis_43',document.location.pathname,'Time Slider','x' + this.getAttribute('x') + 'width' + this.getAttribute('width'))").attr("oninput","trace.event('vis_43',document.location.pathname,'Time Slider','x' + this.getAttribute('x') + 'width' + this.getAttribute('width'))")):(this.bar0=this.g.append("rect").attr("x",this.LEFT).attr("y",this.TOP).attr("height",this.BAR_WIDTH).attr("width",this.width-this.RIGHT-this.LEFT).style("fill","#bbb").call(this.drag).attr("id","bar0").attr("onmouseup","trace.event('vis_43',document.location.pathname,'Time Slider','x' + this.getAttribute('x') + 'width' + this.getAttribute('width'))").attr("oninput","trace.event('vis_43',document.location.pathname,'Time Slider','x' + this.getAttribute('x') + 'width' + this.getAttribute('width'))"),this.bar1=null),this.circleMin=this.g.append("circle").attr("id","sliderKnobMin").attr("r",this.RADIUS_HANDLE).attr("cx",this.LEFT).attr("cy",this.TOP+this.BAR_WIDTH).attr("fill","#777").attr("onchange","trace.event('vis_27',document.location.pathname,'Time Sliden Min','cx' + this.getAttribute('cx'))").attr("onmouseup","trace.event('vis_27',document.location.pathname,'Time Sliden Min','cx' + this.getAttribute('cx'))").attr("oninput","trace.event('vis_27',document.location.pathname,'Time Sliden Min','cx' + this.getAttribute('cx'))").call(this.drag),this.circleMax=this.g.append("circle").attr("id","sliderKnobMax").attr("r",this.RADIUS_HANDLE).attr("cx",this.width-this.RIGHT).attr("cy",this.TOP+this.BAR_WIDTH).attr("fill","#777").attr("onchange","trace.event('vis_28',document.location.pathname,'Time Sliden Max','cx' + this.getAttribute('cx'))").attr("onmouseup","trace.event('vis_28',document.location.pathname,'Time Sliden Max','cx' + this.getAttribute('cx'))").attr("oninput","trace.event('vis_28',document.location.pathname,'Time Sliden Max','cx' + this.getAttribute('cx'))").call(this.drag)}dragStart(t){if(this.dragStartXMouse=Math.max(this.LEFT,Math.min(this.width-this.RIGHT,this.getRelX(t))),this.dragObj=t?t.target:void 0,this.isInverted){const t=parseInt(this.circleMin.attr("cx")),e=parseInt(this.circleMax.attr("cx"));this.dragStartXMouse<t?(this.dragStartXBar=this.LEFT,this.currentBarLength=t-this.LEFT):this.dragStartXMouse<e?(this.dragStartXBar=t,this.currentBarLength=e-t):(this.dragStartXBar=e,this.currentBarLength=this.width-this.RIGHT-e)}else this.dragStartXBar=parseInt(this.bar0.attr("x")),this.currentBarLength=parseInt(this.bar0.attr("width"))}dragMove(t){if(this.isInverted||this.dragObj.id!=this.bar0.attr("id")){if(this.isInverted&&(this.dragObj.id==this.bar0.attr("id")||this.dragObj.id==this.bar1.attr("id")))return;this.dragObj==this.circleSingle?(this.singleTimeStepX=Math.max(this.LEFT,Math.min(this.width-this.RIGHT,this.getRelX(t))),wi(this.dragObj).attr("transform","translate("+this.singleTimeStepX+", 0)")):(wi(this.dragObj).attr("cx",Math.max(this.LEFT,Math.min(this.width-this.RIGHT,this.getRelX(t)))),this.isInverted?(this.bar0.attr("x",this.LEFT).attr("width",this.circleMin.attr("cx")-this.LEFT),this.bar1.attr("x",this.circleMax.attr("cx")).attr("width",this.width-2*this.RIGHT-this.circleMax.attr("cx"))):this.bar0.attr("x",this.circleMin.attr("cx")).attr("width",this.circleMax.attr("cx")-this.circleMin.attr("cx")))}else{const e=Math.max(this.LEFT,Math.min(this.width-this.RIGHT,this.getRelX(t)))-this.dragStartXMouse,n=Math.max(this.LEFT,Math.min(this.width-this.RIGHT-this.currentBarLength,this.dragStartXBar+e));this.bar0.attr("x",n),this.circleMin.attr("cx",n),this.circleMax.attr("cx",n+this.currentBarLength)}this.dragEnd()}dragEnd(){this.min=this.valueRange(this.circleMin.attr("cx")),this.max=this.valueRange(this.circleMax.attr("cx")),this.dragEndCallBackFn(this.min,this.max,this.valueRange(this.singleTimeStepX))}getRelX(t){return(t?t.pageX:0)-this.LEFT-this.x-this.rect.left}set(t,e){this.circleMin.attr("cx",this.valueRange.invert(t)),this.circleMax.attr("cx",this.valueRange.invert(e)),this.isInverted?(this.bar0.attr("x",this.LEFT).attr("width",this.circleMin.attr("cx")),this.bar1.attr("x",this.circleMax.attr("cx")).attr("width",this.width-2*this.RIGHT-this.circleMax.attr("cx"))):this.bar0.attr("x",this.circleMin.attr("cx")).attr("width",this.circleMax.attr("cx")-this.circleMin.attr("cx"))}setIsInverted(t){t!=this.isInverted&&(this.isInverted=t,this.isInverted?this.bar1=this.g.insert("rect","#bar0").attr("x",this.RIGHT).attr("y",this.TOP).attr("height",this.BAR_WIDTH).attr("width",0).style("fill","#bbb").call(this.drag).attr("id","bar1"):this.bar1.remove(),this.set(this.min,this.max))}}var xh=Object.freeze({__proto__:null,SmartSlider:bh});var Ah=Object.freeze({__proto__:null,Timeline:class{constructor(t,e,n,i,r,s){this.TICK_MIN_DIST=13,this.LABEL_MIN_DIST=13,this.timeObjects=[],this.tickmarks=new Zl,this.timeLabels=new Zl,this.tick_minGran_visible_prev=-1,this.dayOfWeek=Tt("%w"),this.x=n,this.y=i,this.WIDTH=r,this.HEIGHT=s,this.webgl=t,this.network=e,this.granules=ko,this.minGran=this.network.getMinGranularity(),this.maxGran=this.granules.length-1,this.visualize()}visualize(){const t=this.network.times().toArray(),e=t[0]?t[0].unixTime():0,n=t[t.length-1]?t[t.length-1].unixTime():0,i=xo(new Date(e),this.granules[this.minGran]),r=xo(new Date(n),this.granules[this.minGran]),s=Math.ceil(Math.abs((r.getTime()-i.getTime())/wo[this.granules[this.minGran]]));this.maxGran=Math.min(this.maxGran,this.granules.length-1);this.maxGran,this.minGran;this.HEIGHT;let o=new Date(e);const a=new Date(e-864e5);this.timeObjects.push(o);for(let t=1;t<s;t++)o=vo(o,1,this.granules[this.minGran]),this.timeObjects.push(o);let l,h,c,u,d;this.timeGranularities=[];for(let t=0;t<this.timeObjects.length;t++){l=!1,u=0==t?a:this.timeObjects[t-1],d=this.timeObjects[t];for(let t=this.maxGran;t>=this.minGran&&!l;t--)t>7?(h=To(u,7),c=To(d,7),h[h.length-4]!=c[c.length-4]?(this.timeGranularities.push(10),l=!0):h[h.length-3]!=c[c.length-3]?(this.timeGranularities.push(9),l=!0):h[h.length-2]!=c[c.length-2]&&(this.timeGranularities.push(8),l=!0)):To(u,t)!=To(d,t)&&(this.timeGranularities.push(t),l=!0)}this.position_x=co().domain([0,this.timeGranularities.length-1]).range([this.x+1,this.x+this.WIDTH-1]),this.position_y=co().domain([this.minGran-1,this.maxGran]).range([-this.HEIGHT,0]),this.label_opacity=co().domain([this.minGran-1,this.maxGran]).range([.2,1]),this.tickmarks=this.webgl.selectAll().data(this.timeGranularities).append("line").attr("x1",((t,e)=>this.position_x(e))).attr("x2",((t,e)=>this.position_x(e))).attr("y1",((t,e)=>this.position_y(t))).attr("y2",((t,e)=>-this.HEIGHT)).style("stroke","#000").style("opacity",.1),this.highlightPointer=this.webgl.selectAll().data([0]).append("line").attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",-this.HEIGHT).style("stroke","#f00").style("opacity",0),this.highlightLabel=this.webgl.selectAll().data([0]).append("text").attr("x",0).attr("y",-6).style("fill","#f00").style("font-size",10).style("opacity",0),this.updateWithIds(0,this.timeObjects.length-1)}update(t,e){let n,i,r=0;for(;r<this.timeObjects.length;r++)if(this.timeObjects[r].getTime()>t){n=r-1;break}for(r=n;r<this.timeObjects.length;r++)if(this.timeObjects[r].getTime()>e){i=r;break}null==i&&(i=this.timeObjects.length-1),this.updateWithIds(n,i)}updateWithIds(t,e){this.minTimeId=t,this.maxTimeId=e,this.position_x.domain([t,e]);const n=Math.floor(this.WIDTH/this.TICK_MIN_DIST),i=this.timeObjects[this.minTimeId],r=this.timeObjects[this.maxTimeId];let s,o,a=Number.MAX_VALUE;this.tick_minGran_visible=void 0;for(let t=this.minGran;t<this.maxGran&&null==this.tick_minGran_visible;t++){s=xo(new Date(i),this.granules[t]),o=xo(new Date(r),this.granules[t]);const e=t=>(o.getTime()-s.getTime())/wo[this.granules[t]];t<=7?a=e(t):(8==t&&(a=e(7)/10),9==t&&(a=e(7)/100),10==t&&(a=e(7)/1e3)),a<=n&&(this.tick_minGran_visible=t)}this.label_minGran_visible=this.tick_minGran_visible,this.label_opacity.domain([this.tick_minGran_visible-1,this.maxGran]),this.tick_minGran_visible_prev!=this.tick_minGran_visible&&(console.log("re-create time labels"),null!=this.timeLabels&&this.timeLabels.removeAll(),this.timeLabels=this.webgl.selectAll().data(this.timeObjects).filter(((t,e)=>this.timeGranularities[e]>=this.tick_minGran_visible)).append("text").attr("x",((t,e)=>this.position_x(this.timeObjects.indexOf(t))+8)).attr("y",((t,e)=>17-this.HEIGHT)).text(((t,e)=>this.formatTime(this.timeObjects.indexOf(t)))).attr("z",1).style("fill","#000").attr("rotation",90).style("font-size",10).style("opacity",.1),console.log("time labels created:",this.timeLabels.length)),this.tick_minGran_visible_prev=this.tick_minGran_visible,this.tickmarks.style("opacity",((t,e)=>0==e||e>=this.minTimeId&&e<=this.maxTimeId&&this.timeGranularities[e]>=this.tick_minGran_visible?this.label_opacity(this.timeGranularities[e]):0)).attr("x1",((t,e)=>this.position_x(e))).attr("x2",((t,e)=>this.position_x(e))).style("stroke-width",((t,e)=>4*this.label_opacity(this.timeGranularities[e]))),this.timeLabels.style("opacity",((t,e)=>{const n=this.timeObjects.indexOf(t);return n>=this.minTimeId&&n<=this.maxTimeId&&this.timeGranularities[n]>=this.label_minGran_visible?1:0})).attr("x",((t,e)=>{const n=this.timeObjects.indexOf(t);return this.position_x(n)+8})),null!=this.highlightId&&(this.highlightPointer.attr("x1",this.position_x(this.highlightId)).attr("x2",this.position_x(this.highlightId)),this.highlightLabel.attr("x",this.position_x(this.highlightId)+37))}formatTime(t){return Ao(this.timeObjects[t],Math.min(Math.max(this.tick_minGran_visible,this.timeGranularities[t]),7))}highlight(t){null==t&&(this.highlightPointer.style("opacity",0),this.highlightId=void 0);for(let e=0;e<this.timeObjects.length;e++)if(!t||this.timeObjects[e].getTime()>t){this.highlightId=e-1;break}null==this.highlightId&&(this.highlightId=this.timeObjects.length-1),this.highlightPointer.attr("x1",this.position_x(this.highlightId)).attr("x2",this.position_x(this.highlightId)).style("opacity",1),this.highlightLabel.style("opacity",1).attr("x",this.position_x(this.highlightId)+37).text(mo(this.timeObjects[this.highlightId]))}}});class Th{constructor(t,e){this.checked=!1,this.text="",this.RADIUS=7,this.clickHandler=()=>null,this.color=t,e&&(this.text=e)}appendTo(t,e,n){const i=n.append("g").attr("transform","translate("+t+","+e+")");this.circle=i.append("circle").attr("r",this.RADIUS).attr("fill","#ffffff").attr("stroke",this.color).attr("stroke-width",1).attr("cx",2*this.RADIUS).attr("cy",0).attr("oninput","trace.event('vis_4',document.location.pathname,this.parentElement.previousElementSibling.innerHTML ,'cx' + this.getAttribute('cx'))").attr("onmouseup","trace.event('vis_4',document.location.pathname,this.parentElement.previousElementSibling.innerHTML ,'cx' + this.getAttribute('cx'))"),this.text&&(this.label=i.append("text").attr("x",1.4*this.RADIUS).attr("y",5).style("font-family","Helvetica").style("font-size","9pt").style("user-select","none").text(this.text[0]).on("click",(()=>{this.checked=!this.checked,this.checked?(this.circle.attr("fill",this.color),this.label.attr("fill","#ffffff")):(this.circle.attr("fill","#ffffff"),this.label.attr("fill",this.color)),this.clickHandler&&this.clickHandler()})))}isChecked(){return this.checked}addClickHandler(t){this.clickHandler=t}}var Sh=Object.freeze({__proto__:null,makeSlider:function(t,e,n,i,r,s,o,a){const l=new wh(5,i-5,n,s,o,.01),h=t.append("svg").attr("width",n+20).attr("height",i);h.append("text").attr("x",10).attr("y",i-15).text(e).style("user-select","none").attr("class","sliderLabel"),l.appendTo(h),l.set(r),l.setDragEndCallBack(a)},RadioButton:Th,makeCheckBox:function(t,e,n){t.append("input").attr("type","checkbox").on("change",n),t.append("b").attr("class","sliderLabel").style("user-select","none").html(e)},makeButton:function(t,e,n){t.append("input").attr("type","button").attr("value",e).on("click",n)}});var kh=Object.freeze({__proto__:null,TimeSlider:class{constructor(t,e,n){this.MARGIN_SLIDER_RIGHT=30,this.MARGIN_SLIDER_LEFT=10,this.TICK_GAP=2,this.TICK_LABEL_GAP=40,this.SLIDER_TOP=25,this.HEIGHT=200,this.callBack=void 0,this.propagateButton=new Th("#000000"),this.dgraph=t,this.times=t.times().toArray(),this.widgetWidth=e;const i=new Vo(0,this.dgraph);this.sliderWidth=e-this.MARGIN_SLIDER_RIGHT+5-this.MARGIN_SLIDER_LEFT-5;let r=0!=this.times.length?this.times[this.times.length-1].moment():i.moment();const s=function(t){let e="milliseconds";switch(t){case 0:e="milliseconds";break;case 1:e="seconds";break;case 2:e="minutes";break;case 3:e="hours";break;case 4:e="days";break;case 5:e="weeks";break;case 6:e="months";break;case 7:e="years"}return e}(t.gran_min);r||(r=new Date(0)),r=vo(r,1,s);const o=0!=this.times.length?this.times[0].unixTime():0;this.slider=new bh(this.MARGIN_SLIDER_LEFT,this.SLIDER_TOP,this.sliderWidth,o,r.valueOf(),1),n&&(this.callBack=n),this.tickScale=function(){return Zs.apply(go(_t,wt,at,st,et,J,K,Q,L,kt).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}().range([this.MARGIN_SLIDER_LEFT,this.MARGIN_SLIDER_LEFT+this.sliderWidth]).domain([o,r.valueOf()]),this.tickHeightFunction=co().range([4,this.SLIDER_TOP-10]).domain([t.gran_min,t.gran_max])}appendTo(t,e,n){e||(e=0),n||(n=0);const i=t.append("g").attr("transform","translate("+e+","+n+")");i.append("g").attr("transform","translate(0,"+this.SLIDER_TOP+")").attr("class","x axis").call(Ke(1,this.tickScale)),this.labelStart=i.append("text").attr("y",this.SLIDER_TOP+20).style("opacity",0).style("font-family","Helvetica").style("font-weigth","100").style("font-size","8pt").style("text-anchor","end").text("").style("user-select","none").style("-webkit-user-select","none").style("-khtml-user-select","none").style("-moz-user-select","none").style("-o-user-select","none").style("user-select","none"),this.labelEnd=i.append("text").style("opacity",0).attr("y",this.SLIDER_TOP+20).style("font-family","Helvetica").style("font-weigth","100").style("font-size","8pt").style("text-anchor","start").text("").style("user-select","none").style("-webkit-user-select","none").style("-khtml-user-select","none").style("-moz-user-select","none").style("-o-user-select","none").style("user-select","none"),this.slider.appendTo(i),this.slider.setDragEndCallBack(((t,e,n)=>this.updateTime(t,e,n))),this.propagateButton=new Th("#000000","Syncronize Time"),this.propagateButton.appendTo(this.sliderWidth+15,this.SLIDER_TOP+8,i)}drawTickmarks(t,e,n){let i=1;for(;Math.floor(this.sliderWidth/this.TICK_LABEL_GAP)<e.length/i&&i<100;)i++;for(let r=0;r<e.length;r++)r%i==0&&(n.append("text").attr("x",this.tickScale(e[r].unixTime())).attr("y",this.SLIDER_TOP-this.tickHeightFunction(t)).text(Ao(e[r].time(),t)).attr("id","timelabel_"+t+"_"+r).attr("class","timelabel").style("opacity",.5).style("font-family","Helvetica").style("font-weigth","100").style("font-size","7pt"),n.append("line").attr("x1",this.tickScale(e[r].unixTime())).attr("x2",this.tickScale(e[r].unixTime())).attr("y1",this.SLIDER_TOP).attr("y2",this.SLIDER_TOP-this.tickHeightFunction(t)).style("stroke","#bbb"))}formatForGranularities(t,e,n){let i="";for(;n>=e;)i+=So(n,n>e),n--;return t.format(i.trim())}updateTime(t,e,n){const i=function(t){return t.toDateString()};n=Math.round(n),this.labelStart.attr("x",this.slider.valueRange.invert(t)+10).style("opacity",1).text(i(new Date(t))),this.labelEnd.attr("x",this.slider.valueRange.invert(e)+10).style("opacity",1).text(i(new Date(e))),null!=this.callBack?this.callBack(t,e,this.propagateButton.isChecked()):vl(t,e,this.times[n],this.propagateButton.isChecked())}set(t,e){this.slider.set(t,e)}}});t.BSpline=zl,t.analytics=Ul,t.colors=Bl,t.datamanager=w,t.dynamicgraph=fa,t.glutils=yh,t.importers=Qa,t.main=Ha,t.messenger=Gl,t.motifs=Ea,t.ordering=ka,t.rangeslider=_h,t.search=Ka,t.slider=vh,t.smartslider=xh,t.timeline=Ah,t.timeslider=kh,t.ui=Sh,t.utils=Sa,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=vistorian-core.js.map
