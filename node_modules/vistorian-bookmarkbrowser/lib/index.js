!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.bookmarkbrowser=e():t.bookmarkbrowser=e()}(window,function(){return r={},i.m=n={12:function(t,e,n){var y,r,i,s,o,a=(y=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={},o={compressToBase64:function(t){if(null==t)return"";var e=o._compress(t,6,function(t){return r.charAt(t)});switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,function(t){return l(r,e.charAt(t))})},compressToUTF16:function(t){return null==t?"":o._compress(t,15,function(t){return y(t+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(t){for(var e=o.compress(t),n=new Uint8Array(2*e.length),r=0,i=e.length;r<i;r++){var s=e.charCodeAt(r);n[2*r]=s>>>8,n[2*r+1]=s%256}return n},decompressFromUint8Array:function(t){if(null==t)return o.decompress(t);for(var e=new Array(t.length/2),n=0,r=e.length;n<r;n++)e[n]=256*t[2*n]+t[2*n+1];var i=[];return e.forEach(function(t){i.push(y(t))}),o.decompress(i.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":o._compress(t,6,function(t){return i.charAt(t)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,function(t){return l(i,e.charAt(t))}))},compress:function(t){return o._compress(t,16,function(t){return y(t)})},_compress:function(t,e,n){if(null==t)return"";for(var r,i,s,o,a={},l={},h="",u=2,c=3,f=2,d=[],g=0,p=0,m=0;m<t.length;m+=1)if(s=t.charAt(m),Object.prototype.hasOwnProperty.call(a,s)||(a[s]=c++,l[s]=!0),o=h+s,Object.prototype.hasOwnProperty.call(a,o))h=o;else{if(Object.prototype.hasOwnProperty.call(l,h)){if(h.charCodeAt(0)<256){for(r=0;r<f;r++)g<<=1,p==e-1?(p=0,d.push(n(g)),g=0):p++;for(i=h.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&i,p==e-1?(p=0,d.push(n(g)),g=0):p++,i>>=1}else{for(i=1,r=0;r<f;r++)g=g<<1|i,p==e-1?(p=0,d.push(n(g)),g=0):p++,i=0;for(i=h.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&i,p==e-1?(p=0,d.push(n(g)),g=0):p++,i>>=1}0==--u&&(u=Math.pow(2,f),f++),delete l[h]}else for(i=a[h],r=0;r<f;r++)g=g<<1|1&i,p==e-1?(p=0,d.push(n(g)),g=0):p++,i>>=1;0==--u&&(u=Math.pow(2,f),f++),a[o]=c++,h=String(s)}if(""!==h){if(Object.prototype.hasOwnProperty.call(l,h)){if(h.charCodeAt(0)<256){for(r=0;r<f;r++)g<<=1,p==e-1?(p=0,d.push(n(g)),g=0):p++;for(i=h.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&i,p==e-1?(p=0,d.push(n(g)),g=0):p++,i>>=1}else{for(i=1,r=0;r<f;r++)g=g<<1|i,p==e-1?(p=0,d.push(n(g)),g=0):p++,i=0;for(i=h.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&i,p==e-1?(p=0,d.push(n(g)),g=0):p++,i>>=1}0==--u&&(u=Math.pow(2,f),f++),delete l[h]}else for(i=a[h],r=0;r<f;r++)g=g<<1|1&i,p==e-1?(p=0,d.push(n(g)),g=0):p++,i>>=1;0==--u&&(u=Math.pow(2,f),f++)}for(i=2,r=0;r<f;r++)g=g<<1|1&i,p==e-1?(p=0,d.push(n(g)),g=0):p++,i>>=1;for(;;){if(g<<=1,p==e-1){d.push(n(g));break}p++}return d.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(t,e,n){for(var r,i,s,o,a,l,h=[],u=4,c=4,f=3,d="",g=[],p={val:n(0),position:e,index:1},m=0;m<3;m+=1)h[m]=m;for(i=0,o=Math.pow(2,2),a=1;a!=o;)s=p.val&p.position,p.position>>=1,0==p.position&&(p.position=e,p.val=n(p.index++)),i|=(0<s?1:0)*a,a<<=1;switch(i){case 0:for(i=0,o=Math.pow(2,8),a=1;a!=o;)s=p.val&p.position,p.position>>=1,0==p.position&&(p.position=e,p.val=n(p.index++)),i|=(0<s?1:0)*a,a<<=1;l=y(i);break;case 1:for(i=0,o=Math.pow(2,16),a=1;a!=o;)s=p.val&p.position,p.position>>=1,0==p.position&&(p.position=e,p.val=n(p.index++)),i|=(0<s?1:0)*a,a<<=1;l=y(i);break;case 2:return""}for(r=h[3]=l,g.push(l);;){if(p.index>t)return"";for(i=0,o=Math.pow(2,f),a=1;a!=o;)s=p.val&p.position,p.position>>=1,0==p.position&&(p.position=e,p.val=n(p.index++)),i|=(0<s?1:0)*a,a<<=1;switch(l=i){case 0:for(i=0,o=Math.pow(2,8),a=1;a!=o;)s=p.val&p.position,p.position>>=1,0==p.position&&(p.position=e,p.val=n(p.index++)),i|=(0<s?1:0)*a,a<<=1;h[c++]=y(i),l=c-1,u--;break;case 1:for(i=0,o=Math.pow(2,16),a=1;a!=o;)s=p.val&p.position,p.position>>=1,0==p.position&&(p.position=e,p.val=n(p.index++)),i|=(0<s?1:0)*a,a<<=1;h[c++]=y(i),l=c-1,u--;break;case 2:return g.join("")}if(0==u&&(u=Math.pow(2,f),f++),h[l])d=h[l];else{if(l!==c)return null;d=r+r.charAt(0)}g.push(d),h[c++]=r+d.charAt(0),r=d,0==--u&&(u=Math.pow(2,f),f++)}}});function l(t,e){if(!s[t]){s[t]={};for(var n=0;n<t.length;n++)s[t][t.charAt(n)]=n}return s[t][e]}void 0===(e=function(){return a}.call(e,n,e,t))||(t.exports=e)},98:function(t,e,n){"use strict";n.r(e),n.d(e,"bookmarkbrowser",function(){return r});var r={};n.r(r),n.d(r,"createSelectionCategory",function(){return xa}),n.d(r,"createViewOnlyCategory",function(){return ka}),n.d(r,"updateViewOnlyList",function(){return Sa}),n.d(r,"createSelection",function(){return Ta}),n.d(r,"updateLists",function(){return Ma}),n.d(r,"updateList",function(){return Na}),n.d(r,"searchResultHandler",function(){return Oa}),n.d(r,"saveSearchResultAsSelection",function(){return Ca}),n.d(r,"clearSearchSelection",function(){return Pa}),n.d(r,"getNodeShape",function(){return Da});var s={value:()=>{}};function i(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new o(r)}function o(t){this._=t}function l(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=s,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}o.prototype=i.prototype={constructor:o,on:function(t,e){var n,r,i=this._,s=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,a=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=s[o]).type)i[n]=l(i[n],t.name,e);else if(null==e)for(n in i)i[n]=l(i[n],t.name,null);return this}for(;++o<a;)if((n=(t=s[o]).type)&&(n=function(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}(i[n],t.name)))return n},copy:function(){var t,e={},n=this._;for(t in n)e[t]=n[t].slice();return new o(e)},call:function(t,e){if(0<(n=arguments.length-2))for(var n,r,i=new Array(n),s=0;s<n;++s)i[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,n=(r=this._[t]).length;s<n;++s)r[s].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};var a=i;function h(){}function d(t){return null==t?h:function(){return this.querySelector(t)}}function c(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function u(){return[]}function y(t){return null==t?u:function(){return this.querySelectorAll(t)}}function f(t){return function(){return this.matches(t)}}function g(e){return function(t){return t.matches(e)}}var p=Array.prototype.find;function m(){return this.firstElementChild}var _=Array.prototype.filter;function v(){return Array.from(this.children)}function w(t){return new Array(t.length)}function A(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}A.prototype={constructor:A,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function b(t,e,n,r,i,s){for(var o,a=0,l=e.length,h=s.length;a<h;++a)(o=e[a])?(o.__data__=s[a],r[a]=o):n[a]=new A(t,s[a]);for(;a<l;++a)(o=e[a])&&(i[a]=o)}function x(t,e,n,r,i,s,o){for(var a,l,h=new Map,u=e.length,c=s.length,f=new Array(u),d=0;d<u;++d)(a=e[d])&&(f[d]=l=o.call(a,a.__data__,d,e)+"",h.has(l)?i[d]=a:h.set(l,a));for(d=0;d<c;++d)l=o.call(t,s[d],d,s)+"",(a=h.get(l))?((r[d]=a).__data__=s[d],h.delete(l)):n[d]=new A(t,s[d]);for(d=0;d<u;++d)(a=e[d])&&h.get(f[d])===a&&(i[d]=a)}function k(t){return t.__data__}function S(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}var T="http://www.w3.org/1999/xhtml",M={svg:"http://www.w3.org/2000/svg",xhtml:T,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},N=function(t){var e=t+="",n=e.indexOf(":");return 0<=n&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),M.hasOwnProperty(e)?{space:M[e],local:t}:t};var E=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function O(t,e){return t.style.getPropertyValue(e)||E(t).getComputedStyle(t,null).getPropertyValue(e)}function C(t){return t.trim().split(/^|\s+/)}function P(t){return t.classList||new D(t)}function D(t){this._node=t,this._names=C(t.getAttribute("class")||"")}function I(t,e){for(var n=P(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function F(t,e){for(var n=P(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}D.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){t=this._names.indexOf(t);0<=t&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return 0<=this._names.indexOf(t)}};function L(){this.textContent=""}function U(){this.innerHTML=""}function q(){this.nextSibling&&this.parentNode.appendChild(this)}function R(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function j(t){return((t=N(t)).local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(n){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===T&&t.documentElement.namespaceURI===T?t.createElement(n):t.createElementNS(e,n)}})(t)}function H(){return null}function Y(){var t=this.parentNode;t&&t.removeChild(this)}function z(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function B(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function G(s){return function(){var t=this.__on;if(t){for(var e,n=0,r=-1,i=t.length;n<i;++n)e=t[n],s.type&&e.type!==s.type||e.name!==s.name?t[++r]=e:this.removeEventListener(e.type,e.listener,e.options);++r?t.length=r:delete this.__on}}}function W(o,a,l){return function(){var t,e,n=this.__on,r=(e=a,function(t){e.call(this,t,this.__data__)});if(n)for(var i=0,s=n.length;i<s;++i)if((t=n[i]).type===o.type&&t.name===o.name)return this.removeEventListener(t.type,t.listener,t.options),this.addEventListener(t.type,t.listener=r,t.options=l),void(t.value=a);this.addEventListener(o.type,r,l),t={type:o.type,name:o.name,value:a,listener:r,options:l},n?n.push(t):this.__on=[t]}}function X(t,e,n){var r=E(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}var V=[null];function $(t,e){this._groups=t,this._parents=e}function Z(){return new $([[document.documentElement]],V)}$.prototype=Z.prototype={constructor:$,select:function(t){"function"!=typeof t&&(t=d(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s,o,a=e[i],l=a.length,h=r[i]=new Array(l),u=0;u<l;++u)(s=a[u])&&(o=t.call(s,s.__data__,u,a))&&("__data__"in s&&(o.__data__=s.__data__),h[u]=o);return new $(r,this._parents)},selectAll:function(t){var e;t="function"==typeof t?(e=t,function(){return c(e.apply(this,arguments))}):y(t);for(var n=this._groups,r=n.length,i=[],s=[],o=0;o<r;++o)for(var a,l=n[o],h=l.length,u=0;u<h;++u)(a=l[u])&&(i.push(t.call(a,a.__data__,u,l)),s.push(a));return new $(i,s)},selectChild:function(t){return this.select(null==t?m:(e="function"==typeof t?t:g(t),function(){return p.call(this.children,e)}));var e},selectChildren:function(t){return this.selectAll(null==t?v:(e="function"==typeof t?t:g(t),function(){return _.call(this.children,e)}));var e},filter:function(t){"function"!=typeof t&&(t=f(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s,o=e[i],a=o.length,l=r[i]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new $(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,k);var n,r=e?x:b,i=this._parents,s=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=s.length,a=new Array(o),l=new Array(o),h=new Array(o),u=0;u<o;++u){var c=i[u],f=s[u],d=f.length,g="object"==typeof(g=t.call(c,c&&c.__data__,u,i))&&"length"in g?g:Array.from(g),p=g.length,m=l[u]=new Array(p),y=a[u]=new Array(p);r(c,f,m,y,h[u]=new Array(d),g,e);for(var _,v,w=0,A=0;w<p;++w)if(_=m[w]){for(A<=w&&(A=w+1);!(v=y[A])&&++A<p;);_._next=v||null}}return(a=new $(a,i))._enter=l,a._exit=h,a},enter:function(){return new $(this._enter||this._groups.map(w),this._parents)},exit:function(){return new $(this._exit||this._groups.map(w),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,s=this.exit(),r="function"==typeof t?(r=t(r))&&r.selection():r.append(t+"");return null!=e&&(i=(i=e(i))&&i.selection()),null==n?s.remove():n(s),r&&i?r.merge(i).order():i},merge:function(t){for(var t=t.selection?t.selection():t,e=this._groups,n=t._groups,r=e.length,t=n.length,i=Math.min(r,t),s=new Array(r),o=0;o<i;++o)for(var a,l=e[o],h=n[o],u=l.length,c=s[o]=new Array(u),f=0;f<u;++f)(a=l[f]||h[f])&&(c[f]=a);for(;o<r;++o)s[o]=e[o];return new $(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],s=i.length-1,o=i[s];0<=--s;)(r=i[s])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(n){function t(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}n=n||S;for(var e=this._groups,r=e.length,i=new Array(r),s=0;s<r;++s){for(var o,a=e[s],l=a.length,h=i[s]=new Array(l),u=0;u<l;++u)(o=a[u])&&(h[u]=o);h.sort(t)}return new $(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,s=e[n],o=0,a=s.length;o<a;++o)(i=s[o])&&t.call(i,i.__data__,o,s);return this},attr:function(t,e){var n=N(t);if(arguments.length<2){t=this.node();return n.local?t.getAttributeNS(n.space,n.local):t.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}:function(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttribute(e):this.setAttribute(e,t)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return 1<arguments.length?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(e,n,r){return function(){var t=n.apply(this,arguments);null==t?this.style.removeProperty(e):this.style.setProperty(e,t,r)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):O(this.node(),t)},property:function(t,e){return 1<arguments.length?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(e,n){return function(){var t=n.apply(this,arguments);null==t?delete this[e]:this[e]=t}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=C(t+"");if(arguments.length<2){for(var r=P(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?I:F)(this,t)}}:e?function(t){return function(){I(this,t)}}:function(t){return function(){F(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?L:("function"==typeof t?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?U:("function"==typeof t?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(q)},lower:function(){return this.each(R)},append:function(t){var e="function"==typeof t?t:j(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:j(t),r=null==e?H:"function"==typeof e?e:d(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Y)},clone:function(t){return this.select(t?B:z)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,s=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return 0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}),o=s.length;if(!(arguments.length<2)){for(a=e?W:G,r=0;r<o;++r)this.each(a(s[r],e,n));return this}var a=this.node().__on;if(a)for(var l,h=0,u=a.length;h<u;++h)for(r=0,l=a[h];r<o;++r)if((i=s[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return X(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return X(this,t,e)}})(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],s=0,o=i.length;s<o;++s)(r=i[s])&&(yield r)}};var Q=Z,J=function(t){return"string"==typeof t?new $([[document.querySelector(t)]],[document.documentElement]):new $([[t]],V)};function K(t,e,n){(t.prototype=e.prototype=n).constructor=t}function tt(t,e){var n,r=Object.create(t.prototype);for(n in e)r[n]=e[n];return r}function et(){}var nt="\\s*([+-]?\\d+)\\s*",rt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",e="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",it=/^#([0-9a-f]{3,8})$/,st=new RegExp("^rgb\\("+[nt,nt,nt]+"\\)$"),ot=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),at=new RegExp("^rgba\\("+[nt,nt,nt,rt]+"\\)$"),lt=new RegExp("^rgba\\("+[e,e,e,rt]+"\\)$"),ht=new RegExp("^hsl\\("+[rt,e,e]+"\\)$"),ut=new RegExp("^hsla\\("+[rt,e,e,rt]+"\\)$"),ct={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ft(){return this.rgb().formatHex()}function dt(){return this.rgb().formatRgb()}function gt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=it.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?pt(e):3===n?new _t(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?mt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?mt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=st.exec(t))?new _t(e[1],e[2],e[3],1):(e=ot.exec(t))?new _t(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=at.exec(t))?mt(e[1],e[2],e[3],e[4]):(e=lt.exec(t))?mt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ht.exec(t))?bt(e[1],e[2]/100,e[3]/100,1):(e=ut.exec(t))?bt(e[1],e[2]/100,e[3]/100,e[4]):ct.hasOwnProperty(t)?pt(ct[t]):"transparent"===t?new _t(NaN,NaN,NaN,0):null}function pt(t){return new _t(t>>16&255,t>>8&255,255&t,1)}function mt(t,e,n,r){return new _t(t=r<=0?e=n=NaN:t,e,n,r)}function yt(t,e,n,r){return 1===arguments.length?(i=(i=t)instanceof et?i:gt(i))?new _t((i=i.rgb()).r,i.g,i.b,i.opacity):new _t:new _t(t,e,n,null==r?1:r);var i}function _t(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function vt(){return"#"+At(this.r)+At(this.g)+At(this.b)}function wt(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function At(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function bt(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||1<=n?t=e=NaN:e<=0&&(t=NaN),new kt(t,e,n,r)}function xt(t){if(t instanceof kt)return new kt(t.h,t.s,t.l,t.opacity);if(!(t=!(t instanceof et)?gt(t):t))return new kt;if(t instanceof kt)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,l=(s+i)/2;return a?(o=e===s?(n-r)/a+6*(n<r):n===s?(r-e)/a+2:(e-n)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=0<l&&l<1?0:o,new kt(o,a,l,t.opacity)}function kt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function St(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Tt(t,e,n,r,i){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*n+(1+3*t+3*s-3*o)*r+o*i)/6}K(et,gt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:ft,formatHex:ft,formatHsl:function(){return xt(this).formatHsl()},formatRgb:dt,toString:dt}),K(_t,yt,tt(et,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new _t(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new _t(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:vt,formatHex:vt,formatRgb:wt,toString:wt})),K(kt,function(t,e,n,r){return 1===arguments.length?xt(t):new kt(t,e,n,null==r?1:r)},tt(et,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new kt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new kt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,e=n+(n<.5?n:1-n)*e,n=2*n-e;return new _t(St(240<=t?t-240:120+t,n,e),St(t,n,e),St(t<120?240+t:t-120,n,e),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Mt=t=>()=>t;function Nt(e,n){return function(t){return e+t*n}}function Et(s){return 1==(s=+s)?Ot:function(t,e){return e-t?(n=t,r=e,i=s,n=Math.pow(n,i),r=Math.pow(r,i)-n,i=1/i,function(t){return Math.pow(n+t*r,i)}):Mt(isNaN(t)?e:t);var n,r,i}}function Ot(t,e){var n=e-t;return n?Nt(t,n):Mt(isNaN(t)?e:t)}var Ct=function t(e){var o=Et(e);function n(e,t){var n=o((e=yt(e)).r,(t=yt(t)).r),r=o(e.g,t.g),i=o(e.b,t.b),s=Ot(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=r(t),e.b=i(t),e.opacity=s(t),e+""}}return n.gamma=t,n}(1);function Pt(a){return function(t){for(var e,n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),o=0;o<n;++o)e=yt(t[o]),r[o]=e.r||0,i[o]=e.g||0,s[o]=e.b||0;return r=a(r),i=a(i),s=a(s),e.opacity=1,function(t){return e.r=r(t),e.g=i(t),e.b=s(t),e+""}}}Pt(function(o){var a=o.length-1;return function(t){var e=t<=0?t=0:1<=t?a-(t=1):Math.floor(t*a),n=o[e],r=o[e+1],i=0<e?o[e-1]:2*n-r,s=e<a-1?o[e+2]:2*r-n;return Tt((t-e/a)*a,i,n,r,s)}}),Pt(function(o){var a=o.length;return function(t){var e=Math.floor(((t%=1)<0?++t:t)*a),n=o[(e+a-1)%a],r=o[e%a],i=o[(e+1)%a],s=o[(e+2)%a];return Tt((t-e/a)*a,n,r,i,s)}});var Dt=function(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}},It=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ft=new RegExp(It.source,"g");var Lt,Ut,qt=function(t,r){var e,n,i,s,o,a=It.lastIndex=Ft.lastIndex=0,l=-1,h=[],u=[];for(t+="",r+="";(e=It.exec(t))&&(n=Ft.exec(r));)(i=n.index)>a&&(i=r.slice(a,i),h[l]?h[l]+=i:h[++l]=i),(e=e[0])===(n=n[0])?h[l]?h[l]+=n:h[++l]=n:(h[++l]=null,u.push({i:l,x:Dt(e,n)})),a=Ft.lastIndex;return a<r.length&&(i=r.slice(a),h[l]?h[l]+=i:h[++l]=i),h.length<2?u[0]?(o=u[0].x,function(t){return o(t)+""}):(s=r,function(){return s}):(r=u.length,function(t){for(var e,n=0;n<r;++n)h[(e=u[n]).i]=e.x(t);return h.join("")})},Rt=0,jt=0,Ht=0,Yt=1e3,zt=0,Bt=0,Gt=0,Wt="object"==typeof performance&&performance.now?performance:Date,Xt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Vt(){return Bt||(Xt($t),Bt=Wt.now()+Gt)}function $t(){Bt=0}function Zt(){this._call=this._time=this._next=null}function Qt(t,e,n){var r=new Zt;return r.restart(t,e,n),r}function Jt(){Bt=(zt=Wt.now())+Gt,Rt=jt=0;try{!function(){Vt(),++Rt;for(var t,e=Lt;e;)0<=(t=Bt-e._time)&&e._call.call(void 0,t),e=e._next;--Rt}()}finally{Rt=0,function(){var t,e,n=Lt,r=1/0;for(;n;)n=n._call?(r>n._time&&(r=n._time),(t=n)._next):(e=n._next,n._next=null,t?t._next=e:Lt=e);Ut=t,te(r)}(),Bt=0}}function Kt(){var t=Wt.now(),e=t-zt;Yt<e&&(Gt-=e,zt=t)}function te(t){Rt||(jt=jt&&clearTimeout(jt),24<t-Bt?(t<1/0&&(jt=setTimeout(Jt,t-Wt.now()-Gt)),Ht=Ht&&clearInterval(Ht)):(Ht||(zt=Wt.now(),Ht=setInterval(Kt,Yt)),Rt=1,Xt(Jt)))}Zt.prototype=Qt.prototype={constructor:Zt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Vt():+n)+(null==e?0:+e),this._next||Ut===this||(Ut?Ut._next=this:Lt=this,Ut=this),this._call=t,this._time=n,te()},stop:function(){this._call&&(this._call=null,this._time=1/0,te())}};function ee(e,n,t){var r=new Zt;return n=null==n?0:+n,r.restart(t=>{r.stop(),e(t+n)},n,t),r}function ne(t,e,n,r,i,s){var o,a,l,h,u,c=t.__transition;if(c){if(n in c)return}else t.__transition={};function f(t){var e,n,r,i;if(l.state!==oe)return g();for(e in u)if((i=u[e]).name===l.name){if(i.state===le)return ee(f);i.state===he?(i.state=ce,i.timer.stop(),i.on.call("interrupt",o,o.__data__,i.index,i.group),delete u[e]):+e<a&&(i.state=ce,i.timer.stop(),i.on.call("cancel",o,o.__data__,i.index,i.group),delete u[e])}if(ee(function(){l.state===le&&(l.state=he,l.timer.restart(d,l.delay,l.time),d(t))}),l.state=ae,l.on.call("start",o,o.__data__,l.index,l.group),l.state===ae){for(l.state=le,h=new Array(r=l.tween.length),e=0,n=-1;e<r;++e)(i=l.tween[e].value.call(o,o.__data__,l.index,l.group))&&(h[++n]=i);h.length=n+1}}function d(t){for(var e=t<l.duration?l.ease.call(null,t/l.duration):(l.timer.restart(g),l.state=ue,1),n=-1,r=h.length;++n<r;)h[n].call(o,e);l.state===ue&&(l.on.call("end",o,o.__data__,l.index,l.group),g())}function g(){for(var t in l.state=ce,l.timer.stop(),delete u[a],u)return;delete o.__transition}o=t,a=n,l={name:e,index:r,group:i,on:re,tween:ie,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:se},((u=o.__transition)[a]=l).timer=Qt(function(t){l.state=oe,l.timer.restart(f,l.delay,l.time),l.delay<=t&&f(t-l.delay)},0,l.time)}var re=a("start","end","cancel","interrupt"),ie=[],se=0,oe=1,ae=2,le=3,he=4,ue=5,ce=6;function fe(t,e){e=ge(t,e);if(e.state>se)throw new Error("too late; already scheduled");return e}function de(t,e){e=ge(t,e);if(e.state>le)throw new Error("too late; already running");return e}function ge(t,e){t=t.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function pe(t,e,n,r,i,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*_e,skewX:Math.atan(l)*_e,scaleX:o,scaleY:a}}var me,ye=function(t,e){var n,r,i,s=t.__transition,o=!0;if(s){for(i in e=null==e?null:e+"",s)(n=s[i]).name===e?(r=n.state>ae&&n.state<ue,n.state=ce,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete s[i]):o=!1;o&&delete t.__transition}},_e=180/Math.PI,ve={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function we(c,f,d,g){function p(t){return t.length?t.pop()+" ":""}return function(t,e){var n,r,i,s,o,a,l,h=[],u=[];return t=c(t),e=c(e),i=t.translateX,s=t.translateY,l=e.translateX,a=e.translateY,o=h,n=u,i!==l||s!==a?(r=o.push("translate(",null,f,null,d),n.push({i:r-4,x:Dt(i,l)},{i:r-2,x:Dt(s,a)})):(l||a)&&o.push("translate("+l+f+a+d),n=t.rotate,i=e.rotate,r=h,s=u,n!==i?(180<n-i?i+=360:180<i-n&&(n+=360),s.push({i:r.push(p(r)+"rotate(",null,g)-2,x:Dt(n,i)})):i&&r.push(p(r)+"rotate("+i+g),o=t.skewX,l=e.skewX,a=h,s=u,o!==l?s.push({i:a.push(p(a)+"skewX(",null,g)-2,x:Dt(o,l)}):l&&a.push(p(a)+"skewX("+l+g),n=t.scaleX,r=t.scaleY,i=e.scaleX,s=e.scaleY,o=h,a=u,n!==i||r!==s?(l=o.push(p(o)+"scale(",null,",",null,")"),a.push({i:l-4,x:Dt(n,i)},{i:l-2,x:Dt(r,s)})):1===i&&1===s||o.push(p(o)+"scale("+i+","+s+")"),t=e=null,function(t){for(var e,n=-1,r=u.length;++n<r;)h[(e=u[n]).i]=e.x(t);return h.join("")}}}var Ae=we(function(t){return(t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"")).isIdentity?ve:pe(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),be=we(function(t){return null==t?ve:((me=me||document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("transform",t),(t=me.transform.baseVal.consolidate())?(t=t.matrix,pe(t.a,t.b,t.c,t.d,t.e,t.f)):ve)},", ",")",")");function xe(t,e,n){var r=t._id;return t.each(function(){var t=de(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return ge(t,r).value[e]}}function ke(t,e){var n;return("number"==typeof e?Dt:e instanceof gt?Ct:(n=gt(e))?(e=n,Ct):qt)(t,e)}function Se(r,i){var s,o;function t(){var e,n,t=i.apply(this,arguments);return s=t!==o?(o=t)&&(e=r,n=t,function(t){this.setAttributeNS(e.space,e.local,n.call(this,t))}):s}return t._value=i,t}function Te(r,i){var s,o;function t(){var e,n,t=i.apply(this,arguments);return s=t!==o?(o=t)&&(e=r,n=t,function(t){this.setAttribute(e,n.call(this,t))}):s}return t._value=i,t}var Me=Q.prototype.constructor;function Ne(t){return function(){this.style.removeProperty(t)}}function Ee(i,s,o){var a,l;function t(){var e,n,r,t=s.apply(this,arguments);return a=t!==l?(l=t)&&(e=i,n=t,r=o,function(t){this.style.setProperty(e,n.call(this,t),r)}):a}return t._value=s,t}function Oe(n){var r,i;function t(){var e,t=n.apply(this,arguments);return r=t!==i?(i=t)&&(e=t,function(t){this.textContent=e.call(this,t)}):r}return t._value=n,t}var Ce=0;function Pe(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}nt=Q.prototype;Pe.prototype={constructor:Pe,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=d(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a,l,h=r[o],u=h.length,c=s[o]=new Array(u),f=0;f<u;++f)(a=h[f])&&(l=t.call(a,a.__data__,f,h))&&("__data__"in a&&(l.__data__=a.__data__),c[f]=l,ne(c[f],e,n,f,c,ge(a,n)));return new Pe(s,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=y(t));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var l,h=r[a],u=h.length,c=0;c<u;++c)if(l=h[c]){for(var f,d=t.call(l,l.__data__,c,h),g=ge(l,n),p=0,m=d.length;p<m;++p)(f=d[p])&&ne(f,e,n,p,d,g);s.push(d),o.push(l)}return new Pe(s,o,e,n)},selectChild:nt.selectChild,selectChildren:nt.selectChildren,filter:function(t){"function"!=typeof t&&(t=f(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s,o=e[i],a=o.length,l=r[i]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new Pe(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,t=n.length,i=Math.min(r,t),s=new Array(r),o=0;o<i;++o)for(var a,l=e[o],h=n[o],u=l.length,c=s[o]=new Array(u),f=0;f<u;++f)(a=l[f]||h[f])&&(c[f]=a);for(;o<r;++o)s[o]=e[o];return new Pe(s,this._parents,this._name,this._id)},selection:function(){return new Me(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=++Ce,r=this._groups,i=r.length,s=0;s<i;++s)for(var o,a,l=r[s],h=l.length,u=0;u<h;++u)(o=l[u])&&(a=ge(o,e),ne(o,t,n,u,l,{time:a.time+a.delay+a.duration,delay:0,duration:a.duration,ease:a.ease}));return new Pe(r,this._parents,t,n)},call:nt.call,nodes:nt.nodes,node:nt.node,size:nt.size,empty:nt.empty,each:nt.each,on:function(t,e){var n,r,i,s,o,a,l=this._id;return arguments.length<2?ge(this.node(),l).on.on(t):this.each((n=l,i=e,a=((r=t)+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return!(t=0<=e?t.slice(0,e):t)||"start"===t})?fe:de,function(){var t=a(this,n),e=t.on;e!==s&&(o=(s=e).copy()).on(r,i),t.on=o}))},attr:function(t,e){var n=N(t),r="transform"===n?be:ke;return this.attrTween(t,"function"==typeof e?(n.local?function(r,i,s){var o,a,l;return function(){var t,e,n=s(this);if(null!=n)return(t=this.getAttributeNS(r.space,r.local))===(e=n+"")?null:t===o&&e===a?l:(a=e,l=i(o=t,n));this.removeAttributeNS(r.space,r.local)}}:function(r,i,s){var o,a,l;return function(){var t,e,n=s(this);if(null!=n)return(t=this.getAttribute(r))===(e=n+"")?null:t===o&&e===a?l:(a=e,l=i(o=t,n));this.removeAttribute(r)}})(n,r,xe(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(e,n,r){var i,s,o=r+"";return function(){var t=this.getAttributeNS(e.space,e.local);return t===o?null:t===i?s:s=n(i=t,r)}}:function(e,n,r){var i,s,o=r+"";return function(){var t=this.getAttribute(e);return t===o?null:t===i?s:s=n(i=t,r)}})(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;t=N(t);return this.tween(n,(t.local?Se:Te)(t,e))},style:function(t,e,n){var r,i,s,o,a,l,h,u,c,f,d,g,p,m,y,_,v,w,A,b,x,k,S,T,M,N="transform"==(t+="")?Ae:ke;return null==e?this.styleTween(t,(x=t,k=N,function(){var t=O(this,x),e=(this.style.removeProperty(x),O(this,x));return t===e?null:t===S&&e===T?M:M=k(S=t,T=e)})).on("end.style."+t,Ne(t)):"function"==typeof e?this.styleTween(t,(_=N,v=xe(this,"style."+(y=t),e),function(){var t=O(this,y),e=v(this),n=e+"";return null==e&&(this.style.removeProperty(y),n=e=O(this,y)),t===n?null:t===w&&n===A?b:(A=n,b=_(w=t,e))})).each((h=this._id,m="end."+(p="style."+(u=t)),function(){var t=de(this,h),e=t.on,n=null==t.value[p]?g=g||Ne(u):void 0;e===c&&d===n||(f=(c=e).copy()).on(m,d=n),t.on=f})):this.styleTween(t,(r=t,i=N,l=(s=e)+"",function(){var t=O(this,r);return t===l?null:t===o?a:a=i(o=t,s)}),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,Ee(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?(n=xe(this,"text",t),function(){var t=n(this);this.textContent=null==t?"":t}):(e=null==t?"":t+"",function(){this.textContent=e}));var e,n},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Oe(t))},remove:function(){return this.on("end.remove",(n=this._id,function(){var t,e=this.parentNode;for(t in this.__transition)if(+t!==n)return;e&&e.removeChild(this)}));var n},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=ge(this.node(),n).tween,s=0,o=i.length;s<o;++s)if((r=i[s]).name===t)return r.value;return null}return this.each((null==e?function(i,s){var o,a;return function(){var t=de(this,i),e=t.tween;if(e!==o)for(var n=0,r=(a=o=e).length;n<r;++n)if(a[n].name===s){(a=a.slice()).splice(n,1);break}t.tween=a}}:function(s,o,a){var l,h;if("function"!=typeof a)throw new Error;return function(){var t=de(this,s),e=t.tween;if(e!==l){h=(l=e).slice();for(var n={name:o,value:a},r=0,i=h.length;r<i;++r)if(h[r].name===o){h[r]=n;break}r===i&&h.push(n)}t.tween=h}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){fe(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){fe(this,t).delay=e}})(e,t)):ge(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){de(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){de(this,t).duration=e}})(e,t)):ge(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){de(this,t).ease=e}}(e,t)):ge(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each((e=this._id,n=t,function(){var t=n.apply(this,arguments);if("function"!=typeof t)throw new Error;de(this,e).ease=t}));var e,n},end:function(){var i,s,o=this,a=o._id,l=o.size();return new Promise(function(t,e){var n={value:e},r={value:function(){0==--l&&t()}};o.each(function(){var t=de(this,a),e=t.on;e!==i&&((s=(i=e).copy())._.cancel.push(n),s._.interrupt.push(n),s._.end.push(r)),t.on=s}),0===l&&t()})},[Symbol.iterator]:nt[Symbol.iterator]};var De={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};Q.prototype.interrupt=function(t){return this.each(function(){ye(this,t)})},Q.prototype.transition=function(t){var e,n;t=t instanceof Pe?(e=t._id,t._name):(e=++Ce,(n=De).time=Vt(),null==t?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o,a=r[s],l=a.length,h=0;h<l;++h)(o=a[h])&&ne(o,t,e,h,a,n||function(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}(o,e));return new Pe(r,this._parents,t,e)};const{}=Math;["w","e"].map(Ie),["n","s"].map(Ie),["n","w","e","s","nw","ne","sw","se"].map(Ie);function Ie(t){return{type:t}}var Fe=function(t){return"string"==typeof t?new $([document.querySelectorAll(t)],[document.documentElement]):new $([c(t)],V)};const Le=Math.PI,Ue=2*Le,qe=1e-6,Re=Ue-qe;function je(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function He(){return new je}je.prototype=He.prototype={constructor:je,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(t,e,n,r,i){var s,o,a=this._x1,l=this._y1,h=(n=+n)-(t=+t),u=(r=+r)-(e=+e),c=a-t,f=l-e,d=c*c+f*f;if((i=+i)<0)throw new Error("negative radius: "+i);null===this._x1?this._+="M"+(this._x1=t)+","+(this._y1=e):d>qe&&(Math.abs(f*h-u*c)>qe&&i?(o=h*h+u*u,a=(s=n-a)*s+(n=r-l)*n,r=Math.sqrt(o),l=Math.sqrt(d),l=(a=i*Math.tan((Le-Math.acos((o+d-a)/(2*r*l)))/2))/l,r=a/r,Math.abs(l-1)>qe&&(this._+="L"+(t+l*c)+","+(e+l*f)),this._+="A"+i+","+i+",0,0,"+ +(c*n<f*s)+","+(this._x1=t+r*h)+","+(this._y1=e+r*u)):this._+="L"+(this._x1=t)+","+(this._y1=e))},arc:function(t,e,n,r,i,s){t=+t,e=+e,s=!!s;var o=(n=+n)*Math.cos(r),a=n*Math.sin(r),l=t+o,h=e+a,u=1^s,r=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+h:(Math.abs(this._x1-l)>qe||Math.abs(this._y1-h)>qe)&&(this._+="L"+l+","+h),n&&((r=r<0?r%Ue+Ue:r)>Re?this._+="A"+n+","+n+",0,1,"+u+","+(t-o)+","+(e-a)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=h):r>qe&&(this._+="A"+n+","+n+",0,"+ +(r>=Le)+","+u+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Ye=He,ze=(Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt,Math.PI),Be=2*ze;function Ge(t){return function(){return t}}var We={draw:function(t,e){e=Math.sqrt(e/ze);t.moveTo(e,0),t.arc(0,0,e,0,Be)}},Xe={draw:function(t,e){e=Math.sqrt(e/5)/2;t.moveTo(-3*e,-e),t.lineTo(-e,-e),t.lineTo(-e,-3*e),t.lineTo(e,-3*e),t.lineTo(e,-e),t.lineTo(3*e,-e),t.lineTo(3*e,e),t.lineTo(e,e),t.lineTo(e,3*e),t.lineTo(-e,3*e),t.lineTo(-e,e),t.lineTo(-3*e,e),t.closePath()}},Ve=Math.sqrt(1/3),$e=2*Ve,Ze={draw:function(t,e){var n=Math.sqrt(e/$e),e=n*Ve;t.moveTo(0,-n),t.lineTo(e,0),t.lineTo(0,n),t.lineTo(-e,0),t.closePath()}},e=Math.sin(ze/10)/Math.sin(7*ze/10),Qe=Math.sin(Be/10)*e,Je=-Math.cos(Be/10)*e,Ke={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=Qe*n,i=Je*n;t.moveTo(0,-n),t.lineTo(r,i);for(var s=1;s<5;++s){var o=Be*s/5,a=Math.cos(o),o=Math.sin(o);t.lineTo(o*n,-a*n),t.lineTo(a*r-o*i,o*r+a*i)}t.closePath()}},tn={draw:function(t,e){var n=Math.sqrt(e),e=-n/2;t.rect(e,e,n,n)}},en=Math.sqrt(3),nn={draw:function(t,e){e=-Math.sqrt(e/(3*en));t.moveTo(0,2*e),t.lineTo(-en*e,-e),t.lineTo(en*e,-e),t.closePath()}},rn=-.5,sn=Math.sqrt(3)/2,on=1/Math.sqrt(12),an=3*(on/2+1),ln={draw:function(t,e){var n=Math.sqrt(e/an),r=n/2,i=n*on,s=r,o=n*on+n,e=-s,n=o;t.moveTo(r,i),t.lineTo(s,o),t.lineTo(e,n),t.lineTo(rn*r-sn*i,sn*r+rn*i),t.lineTo(rn*s-sn*o,sn*s+rn*o),t.lineTo(rn*e-sn*n,sn*e+rn*n),t.lineTo(rn*r+sn*i,rn*i-sn*r),t.lineTo(rn*s+sn*o,rn*o-sn*s),t.lineTo(rn*e+sn*n,rn*n-sn*e),t.closePath()}},hn=function(e,n){var r=null;function i(){var t;if(r=r||(t=Ye()),e.apply(this,arguments).draw(r,+n.apply(this,arguments)),t)return r=null,t+""||null}return e="function"==typeof e?e:Ge(e||We),n="function"==typeof n?n:Ge(void 0===n?64:+n),i.type=function(t){return arguments.length?(e="function"==typeof t?t:Ge(t),i):e},i.size=function(t){return arguments.length?(n="function"==typeof t?t:Ge(+t),i):n},i.context=function(t){return arguments.length?(r=null==t?null:t,i):r},i};function un(t){return((t=Math.exp(t))+1/t)/2}(function n(f,d,g){function t(t,e){var r,i,s,n,o=t[0],a=t[1],l=t[2],h=e[0],t=e[1],e=e[2],u=h-o,c=t-a,h=u*u+c*c;return(n=h<1e-12?(s=Math.log(e/l)/f,function(t){return[o+t*u,a+t*c,l*Math.exp(f*t*s)]}):(r=Math.sqrt(h),t=(e*e-l*l+g*h)/(2*l*d*r),n=(e*e-l*l-g*h)/(2*e*d*r),i=Math.log(Math.sqrt(t*t+1)-t),s=(Math.log(Math.sqrt(n*n+1)-n)-i)/f,function(t){var e=t*s,n=un(i),t=l/(d*r)*(n*(t=f*e+i,((t=Math.exp(2*t))-1)/(t+1))-(t=i,((t=Math.exp(i))-1/t)/2));return[o+t*u,a+t*c,l*n/un(f*e+i)]})).duration=1e3*s*f/Math.SQRT2,n}return t.rho=function(t){var e=Math.max(.001,+t),t=e*e;return n(e,t,t*t)},t})(Math.SQRT2,2,4);var cn={value:()=>{}};function fn(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new dn(r)}function dn(t){this._=t}function gn(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=cn,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}dn.prototype=fn.prototype={constructor:dn,on:function(t,e){var n,r,i=this._,s=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,a=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=s[o]).type)i[n]=gn(i[n],t.name,e);else if(null==e)for(n in i)i[n]=gn(i[n],t.name,null);return this}for(;++o<a;)if((n=(t=s[o]).type)&&(n=function(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}(i[n],t.name)))return n},copy:function(){var t,e={},n=this._;for(t in n)e[t]=n[t].slice();return new dn(e)},call:function(t,e){if(0<(n=arguments.length-2))for(var n,r,i=new Array(n),s=0;s<n;++s)i[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,n=(r=this._[t]).length;s<n;++s)r[s].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};rt=fn;function pn(){}function mn(t){return null==t?pn:function(){return this.querySelector(t)}}function yn(){return[]}function _n(t){return null==t?yn:function(){return this.querySelectorAll(t)}}function vn(e){return function(){return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t);var t}}function wn(t){return function(){return this.matches(t)}}function An(e){return function(t){return t.matches(e)}}var bn=Array.prototype.find;function xn(){return this.firstElementChild}var kn=Array.prototype.filter;function Sn(){return Array.from(this.children)}function Tn(t){return new Array(t.length)}function Mn(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Mn.prototype={constructor:Mn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Nn(t,e,n,r,i,s){for(var o,a=0,l=e.length,h=s.length;a<h;++a)(o=e[a])?(o.__data__=s[a],r[a]=o):n[a]=new Mn(t,s[a]);for(;a<l;++a)(o=e[a])&&(i[a]=o)}function En(t,e,n,r,i,s,o){for(var a,l,h=new Map,u=e.length,c=s.length,f=new Array(u),d=0;d<u;++d)(a=e[d])&&(f[d]=l=o.call(a,a.__data__,d,e)+"",h.has(l)?i[d]=a:h.set(l,a));for(d=0;d<c;++d)l=o.call(t,s[d],d,s)+"",(a=h.get(l))?((r[d]=a).__data__=s[d],h.delete(l)):n[d]=new Mn(t,s[d]);for(d=0;d<u;++d)(a=e[d])&&h.get(f[d])===a&&(i[d]=a)}function On(t){return t.__data__}function Cn(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}var Pn="http://www.w3.org/1999/xhtml",Dn={svg:"http://www.w3.org/2000/svg",xhtml:Pn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},In=function(t){var e=t+="",n=e.indexOf(":");return 0<=n&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Dn.hasOwnProperty(e)?{space:Dn[e],local:t}:t};var Fn=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function Ln(t,e){return t.style.getPropertyValue(e)||Fn(t).getComputedStyle(t,null).getPropertyValue(e)}function Un(t){return t.trim().split(/^|\s+/)}function qn(t){return t.classList||new Rn(t)}function Rn(t){this._node=t,this._names=Un(t.getAttribute("class")||"")}function jn(t,e){for(var n=qn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Hn(t,e){for(var n=qn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}Rn.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){t=this._names.indexOf(t);0<=t&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return 0<=this._names.indexOf(t)}};function Yn(){this.textContent=""}function zn(){this.innerHTML=""}function Bn(){this.nextSibling&&this.parentNode.appendChild(this)}function Gn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Wn(t){return((t=In(t)).local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(n){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===Pn&&t.documentElement.namespaceURI===Pn?t.createElement(n):t.createElementNS(e,n)}})(t)}function Xn(){return null}function Vn(){var t=this.parentNode;t&&t.removeChild(this)}function $n(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Zn(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Qn(s){return function(){var t=this.__on;if(t){for(var e,n=0,r=-1,i=t.length;n<i;++n)e=t[n],s.type&&e.type!==s.type||e.name!==s.name?t[++r]=e:this.removeEventListener(e.type,e.listener,e.options);++r?t.length=r:delete this.__on}}}function Jn(o,a,l){return function(){var t,e,n=this.__on,r=(e=a,function(t){e.call(this,t,this.__data__)});if(n)for(var i=0,s=n.length;i<s;++i)if((t=n[i]).type===o.type&&t.name===o.name)return this.removeEventListener(t.type,t.listener,t.options),this.addEventListener(t.type,t.listener=r,t.options=l),void(t.value=a);this.addEventListener(o.type,r,l),t={type:o.type,name:o.name,value:a,listener:r,options:l},n?n.push(t):this.__on=[t]}}function Kn(t,e,n){var r=Fn(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}var tr=[null];function er(t,e){this._groups=t,this._parents=e}function nr(){return new er([[document.documentElement]],tr)}er.prototype=nr.prototype={constructor:er,select:function(t){"function"!=typeof t&&(t=mn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s,o,a=e[i],l=a.length,h=r[i]=new Array(l),u=0;u<l;++u)(s=a[u])&&(o=t.call(s,s.__data__,u,a))&&("__data__"in s&&(o.__data__=s.__data__),h[u]=o);return new er(r,this._parents)},selectAll:function(t){t=("function"==typeof t?vn:_n)(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o,a=e[s],l=a.length,h=0;h<l;++h)(o=a[h])&&(r.push(t.call(o,o.__data__,h,a)),i.push(o));return new er(r,i)},selectChild:function(t){return this.select(null==t?xn:(e="function"==typeof t?t:An(t),function(){return bn.call(this.children,e)}));var e},selectChildren:function(t){return this.selectAll(null==t?Sn:(e="function"==typeof t?t:An(t),function(){return kn.call(this.children,e)}));var e},filter:function(t){"function"!=typeof t&&(t=wn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s,o=e[i],a=o.length,l=r[i]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new er(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,On);var n,r=e?En:Nn,i=this._parents,s=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=s.length,a=new Array(o),l=new Array(o),h=new Array(o),u=0;u<o;++u){var c=i[u],f=s[u],d=f.length,g="object"==typeof(g=t.call(c,c&&c.__data__,u,i))&&"length"in g?g:Array.from(g),p=g.length,m=l[u]=new Array(p),y=a[u]=new Array(p);r(c,f,m,y,h[u]=new Array(d),g,e);for(var _,v,w=0,A=0;w<p;++w)if(_=m[w]){for(A<=w&&(A=w+1);!(v=y[A])&&++A<p;);_._next=v||null}}return(a=new er(a,i))._enter=l,a._exit=h,a},enter:function(){return new er(this._enter||this._groups.map(Tn),this._parents)},exit:function(){return new er(this._exit||this._groups.map(Tn),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,s=this.exit(),r="function"==typeof t?(r=t(r))&&r.selection():r.append(t+"");return null!=e&&(i=(i=e(i))&&i.selection()),null==n?s.remove():n(s),r&&i?r.merge(i).order():i},merge:function(t){for(var t=t.selection?t.selection():t,e=this._groups,n=t._groups,r=e.length,t=n.length,i=Math.min(r,t),s=new Array(r),o=0;o<i;++o)for(var a,l=e[o],h=n[o],u=l.length,c=s[o]=new Array(u),f=0;f<u;++f)(a=l[f]||h[f])&&(c[f]=a);for(;o<r;++o)s[o]=e[o];return new er(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],s=i.length-1,o=i[s];0<=--s;)(r=i[s])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(n){function t(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}n=n||Cn;for(var e=this._groups,r=e.length,i=new Array(r),s=0;s<r;++s){for(var o,a=e[s],l=a.length,h=i[s]=new Array(l),u=0;u<l;++u)(o=a[u])&&(h[u]=o);h.sort(t)}return new er(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,s=e[n],o=0,a=s.length;o<a;++o)(i=s[o])&&t.call(i,i.__data__,o,s);return this},attr:function(t,e){var n=In(t);if(arguments.length<2){t=this.node();return n.local?t.getAttributeNS(n.space,n.local):t.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}:function(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttribute(e):this.setAttribute(e,t)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return 1<arguments.length?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(e,n,r){return function(){var t=n.apply(this,arguments);null==t?this.style.removeProperty(e):this.style.setProperty(e,t,r)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):Ln(this.node(),t)},property:function(t,e){return 1<arguments.length?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(e,n){return function(){var t=n.apply(this,arguments);null==t?delete this[e]:this[e]=t}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=Un(t+"");if(arguments.length<2){for(var r=qn(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?jn:Hn)(this,t)}}:e?function(t){return function(){jn(this,t)}}:function(t){return function(){Hn(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?Yn:("function"==typeof t?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?zn:("function"==typeof t?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(Bn)},lower:function(){return this.each(Gn)},append:function(t){var e="function"==typeof t?t:Wn(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:Wn(t),r=null==e?Xn:"function"==typeof e?e:mn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Vn)},clone:function(t){return this.select(t?Zn:$n)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,s=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return 0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}),o=s.length;if(!(arguments.length<2)){for(a=e?Jn:Qn,r=0;r<o;++r)this.each(a(s[r],e,n));return this}var a=this.node().__on;if(a)for(var l,h=0,u=a.length;h<u;++h)for(r=0,l=a[h];r<o;++r)if((i=s[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return Kn(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return Kn(this,t,e)}})(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],s=0,o=i.length;s<o;++s)(r=i[s])&&(yield r)}};var a=nr;function rr(t,e,n){(t.prototype=e.prototype=n).constructor=t}function ir(t,e){var n,r=Object.create(t.prototype);for(n in e)r[n]=e[n];return r}function sr(){}var nt="\\s*([+-]?\\d+)\\s*",Q="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",e="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",or=/^#([0-9a-f]{3,8})$/,ar=new RegExp("^rgb\\("+[nt,nt,nt]+"\\)$"),lr=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),hr=new RegExp("^rgba\\("+[nt,nt,nt,Q]+"\\)$"),ur=new RegExp("^rgba\\("+[e,e,e,Q]+"\\)$"),cr=new RegExp("^hsl\\("+[Q,e,e]+"\\)$"),fr=new RegExp("^hsla\\("+[Q,e,e,Q]+"\\)$"),dr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function gr(){return this.rgb().formatHex()}function pr(){return this.rgb().formatRgb()}function mr(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=or.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?yr(e):3===n?new wr(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?_r(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?_r(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ar.exec(t))?new wr(e[1],e[2],e[3],1):(e=lr.exec(t))?new wr(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=hr.exec(t))?_r(e[1],e[2],e[3],e[4]):(e=ur.exec(t))?_r(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=cr.exec(t))?kr(e[1],e[2]/100,e[3]/100,1):(e=fr.exec(t))?kr(e[1],e[2]/100,e[3]/100,e[4]):dr.hasOwnProperty(t)?yr(dr[t]):"transparent"===t?new wr(NaN,NaN,NaN,0):null}function yr(t){return new wr(t>>16&255,t>>8&255,255&t,1)}function _r(t,e,n,r){return new wr(t=r<=0?e=n=NaN:t,e,n,r)}function vr(t,e,n,r){return 1===arguments.length?(i=(i=t)instanceof sr?i:mr(i))?new wr((i=i.rgb()).r,i.g,i.b,i.opacity):new wr:new wr(t,e,n,null==r?1:r);var i}function wr(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Ar(){return"#"+xr(this.r)+xr(this.g)+xr(this.b)}function br(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function xr(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function kr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||1<=n?t=e=NaN:e<=0&&(t=NaN),new Tr(t,e,n,r)}function Sr(t){if(t instanceof Tr)return new Tr(t.h,t.s,t.l,t.opacity);if(!(t=!(t instanceof sr)?mr(t):t))return new Tr;if(t instanceof Tr)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,l=(s+i)/2;return a?(o=e===s?(n-r)/a+6*(n<r):n===s?(r-e)/a+2:(e-n)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=0<l&&l<1?0:o,new Tr(o,a,l,t.opacity)}function Tr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Mr(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Nr(t,e,n,r,i){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*n+(1+3*t+3*s-3*o)*r+o*i)/6}rr(sr,mr,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:gr,formatHex:gr,formatHsl:function(){return Sr(this).formatHsl()},formatRgb:pr,toString:pr}),rr(wr,vr,ir(sr,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new wr(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new wr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ar,formatHex:Ar,formatRgb:br,toString:br})),rr(Tr,function(t,e,n,r){return 1===arguments.length?Sr(t):new Tr(t,e,n,null==r?1:r)},ir(sr,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Tr(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Tr(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,e=n+(n<.5?n:1-n)*e,n=2*n-e;return new wr(Mr(240<=t?t-240:120+t,n,e),Mr(t,n,e),Mr(t<120?240+t:t-120,n,e),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Er=t=>()=>t;function Or(e,n){return function(t){return e+t*n}}function Cr(s){return 1==(s=+s)?Pr:function(t,e){return e-t?(n=t,r=e,i=s,n=Math.pow(n,i),r=Math.pow(r,i)-n,i=1/i,function(t){return Math.pow(n+t*r,i)}):Er(isNaN(t)?e:t);var n,r,i}}function Pr(t,e){var n=e-t;return n?Or(t,n):Er(isNaN(t)?e:t)}var Dr=function t(e){var o=Cr(e);function n(e,t){var n=o((e=vr(e)).r,(t=vr(t)).r),r=o(e.g,t.g),i=o(e.b,t.b),s=Pr(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=r(t),e.b=i(t),e.opacity=s(t),e+""}}return n.gamma=t,n}(1);function Ir(a){return function(t){for(var e,n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),o=0;o<n;++o)e=vr(t[o]),r[o]=e.r||0,i[o]=e.g||0,s[o]=e.b||0;return r=a(r),i=a(i),s=a(s),e.opacity=1,function(t){return e.r=r(t),e.g=i(t),e.b=s(t),e+""}}}Ir(function(o){var a=o.length-1;return function(t){var e=t<=0?t=0:1<=t?a-(t=1):Math.floor(t*a),n=o[e],r=o[e+1],i=0<e?o[e-1]:2*n-r,s=e<a-1?o[e+2]:2*r-n;return Nr((t-e/a)*a,i,n,r,s)}}),Ir(function(o){var a=o.length;return function(t){var e=Math.floor(((t%=1)<0?++t:t)*a),n=o[(e+a-1)%a],r=o[e%a],i=o[(e+1)%a],s=o[(e+2)%a];return Nr((t-e/a)*a,n,r,i,s)}});var Fr=function(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}},Lr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ur=new RegExp(Lr.source,"g");var qr,Rr,jr=function(t,r){var e,n,i,s,o,a=Lr.lastIndex=Ur.lastIndex=0,l=-1,h=[],u=[];for(t+="",r+="";(e=Lr.exec(t))&&(n=Ur.exec(r));)(i=n.index)>a&&(i=r.slice(a,i),h[l]?h[l]+=i:h[++l]=i),(e=e[0])===(n=n[0])?h[l]?h[l]+=n:h[++l]=n:(h[++l]=null,u.push({i:l,x:Fr(e,n)})),a=Ur.lastIndex;return a<r.length&&(i=r.slice(a),h[l]?h[l]+=i:h[++l]=i),h.length<2?u[0]?(o=u[0].x,function(t){return o(t)+""}):(s=r,function(){return s}):(r=u.length,function(t){for(var e,n=0;n<r;++n)h[(e=u[n]).i]=e.x(t);return h.join("")})},Hr=0,Yr=0,zr=0,Br=1e3,Gr=0,Wr=0,Xr=0,Vr="object"==typeof performance&&performance.now?performance:Date,$r="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Zr(){return Wr||($r(Qr),Wr=Vr.now()+Xr)}function Qr(){Wr=0}function Jr(){this._call=this._time=this._next=null}function Kr(t,e,n){var r=new Jr;return r.restart(t,e,n),r}function ti(){Wr=(Gr=Vr.now())+Xr,Hr=Yr=0;try{!function(){Zr(),++Hr;for(var t,e=qr;e;)0<=(t=Wr-e._time)&&e._call.call(void 0,t),e=e._next;--Hr}()}finally{Hr=0,function(){var t,e,n=qr,r=1/0;for(;n;)n=n._call?(r>n._time&&(r=n._time),(t=n)._next):(e=n._next,n._next=null,t?t._next=e:qr=e);Rr=t,ni(r)}(),Wr=0}}function ei(){var t=Vr.now(),e=t-Gr;Br<e&&(Xr-=e,Gr=t)}function ni(t){Hr||(Yr=Yr&&clearTimeout(Yr),24<t-Wr?(t<1/0&&(Yr=setTimeout(ti,t-Vr.now()-Xr)),zr=zr&&clearInterval(zr)):(zr||(Gr=Vr.now(),zr=setInterval(ei,Br)),Hr=1,$r(ti)))}Jr.prototype=Kr.prototype={constructor:Jr,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Zr():+n)+(null==e?0:+e),this._next||Rr===this||(Rr?Rr._next=this:qr=this,Rr=this),this._call=t,this._time=n,ni()},stop:function(){this._call&&(this._call=null,this._time=1/0,ni())}};function ri(e,n,t){var r=new Jr;return n=null==n?0:+n,r.restart(t=>{r.stop(),e(t+n)},n,t),r}function ii(t,e,n,r,i,s){var o,a,l,h,u,c=t.__transition;if(c){if(n in c)return}else t.__transition={};function f(t){var e,n,r,i;if(l.state!==li)return g();for(e in u)if((i=u[e]).name===l.name){if(i.state===ui)return ri(f);i.state===ci?(i.state=di,i.timer.stop(),i.on.call("interrupt",o,o.__data__,i.index,i.group),delete u[e]):+e<a&&(i.state=di,i.timer.stop(),i.on.call("cancel",o,o.__data__,i.index,i.group),delete u[e])}if(ri(function(){l.state===ui&&(l.state=ci,l.timer.restart(d,l.delay,l.time),d(t))}),l.state=hi,l.on.call("start",o,o.__data__,l.index,l.group),l.state===hi){for(l.state=ui,h=new Array(r=l.tween.length),e=0,n=-1;e<r;++e)(i=l.tween[e].value.call(o,o.__data__,l.index,l.group))&&(h[++n]=i);h.length=n+1}}function d(t){for(var e=t<l.duration?l.ease.call(null,t/l.duration):(l.timer.restart(g),l.state=fi,1),n=-1,r=h.length;++n<r;)h[n].call(o,e);l.state===fi&&(l.on.call("end",o,o.__data__,l.index,l.group),g())}function g(){for(var t in l.state=di,l.timer.stop(),delete u[a],u)return;delete o.__transition}o=t,a=n,l={name:e,index:r,group:i,on:si,tween:oi,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:ai},((u=o.__transition)[a]=l).timer=Kr(function(t){l.state=li,l.timer.restart(f,l.delay,l.time),l.delay<=t&&f(t-l.delay)},0,l.time)}var si=rt("start","end","cancel","interrupt"),oi=[],ai=0,li=1,hi=2,ui=3,ci=4,fi=5,di=6;function gi(t,e){e=mi(t,e);if(e.state>ai)throw new Error("too late; already scheduled");return e}function pi(t,e){e=mi(t,e);if(e.state>ui)throw new Error("too late; already running");return e}function mi(t,e){t=t.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function yi(t,e,n,r,i,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*wi,skewX:Math.atan(l)*wi,scaleX:o,scaleY:a}}var _i,vi=function(t,e){var n,r,i,s=t.__transition,o=!0;if(s){for(i in e=null==e?null:e+"",s)(n=s[i]).name===e?(r=n.state>hi&&n.state<fi,n.state=di,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete s[i]):o=!1;o&&delete t.__transition}},wi=180/Math.PI,Ai={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function bi(c,f,d,g){function p(t){return t.length?t.pop()+" ":""}return function(t,e){var n,r,i,s,o,a,l,h=[],u=[];return t=c(t),e=c(e),i=t.translateX,s=t.translateY,l=e.translateX,a=e.translateY,o=h,n=u,i!==l||s!==a?(r=o.push("translate(",null,f,null,d),n.push({i:r-4,x:Fr(i,l)},{i:r-2,x:Fr(s,a)})):(l||a)&&o.push("translate("+l+f+a+d),n=t.rotate,i=e.rotate,r=h,s=u,n!==i?(180<n-i?i+=360:180<i-n&&(n+=360),s.push({i:r.push(p(r)+"rotate(",null,g)-2,x:Fr(n,i)})):i&&r.push(p(r)+"rotate("+i+g),o=t.skewX,l=e.skewX,a=h,s=u,o!==l?s.push({i:a.push(p(a)+"skewX(",null,g)-2,x:Fr(o,l)}):l&&a.push(p(a)+"skewX("+l+g),n=t.scaleX,r=t.scaleY,i=e.scaleX,s=e.scaleY,o=h,a=u,n!==i||r!==s?(l=o.push(p(o)+"scale(",null,",",null,")"),a.push({i:l-4,x:Fr(n,i)},{i:l-2,x:Fr(r,s)})):1===i&&1===s||o.push(p(o)+"scale("+i+","+s+")"),t=e=null,function(t){for(var e,n=-1,r=u.length;++n<r;)h[(e=u[n]).i]=e.x(t);return h.join("")}}}var xi=bi(function(t){return(t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"")).isIdentity?Ai:yi(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),ki=bi(function(t){return null==t?Ai:((_i=_i||document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("transform",t),(t=_i.transform.baseVal.consolidate())?(t=t.matrix,yi(t.a,t.b,t.c,t.d,t.e,t.f)):Ai)},", ",")",")");function Si(t,e,n){var r=t._id;return t.each(function(){var t=pi(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return mi(t,r).value[e]}}function Ti(t,e){var n;return("number"==typeof e?Fr:e instanceof mr?Dr:(n=mr(e))?(e=n,Dr):jr)(t,e)}function Mi(r,i){var s,o;function t(){var e,n,t=i.apply(this,arguments);return s=t!==o?(o=t)&&(e=r,n=t,function(t){this.setAttributeNS(e.space,e.local,n.call(this,t))}):s}return t._value=i,t}function Ni(r,i){var s,o;function t(){var e,n,t=i.apply(this,arguments);return s=t!==o?(o=t)&&(e=r,n=t,function(t){this.setAttribute(e,n.call(this,t))}):s}return t._value=i,t}var Ei=a.prototype.constructor;function Oi(t){return function(){this.style.removeProperty(t)}}function Ci(i,s,o){var a,l;function t(){var e,n,r,t=s.apply(this,arguments);return a=t!==l?(l=t)&&(e=i,n=t,r=o,function(t){this.style.setProperty(e,n.call(this,t),r)}):a}return t._value=s,t}function Pi(n){var r,i;function t(){var e,t=n.apply(this,arguments);return r=t!==i?(i=t)&&(e=t,function(t){this.textContent=e.call(this,t)}):r}return t._value=n,t}var Di=0;function Ii(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}e=a.prototype;Ii.prototype={constructor:Ii,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=mn(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a,l,h=r[o],u=h.length,c=s[o]=new Array(u),f=0;f<u;++f)(a=h[f])&&(l=t.call(a,a.__data__,f,h))&&("__data__"in a&&(l.__data__=a.__data__),c[f]=l,ii(c[f],e,n,f,c,mi(a,n)));return new Ii(s,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=_n(t));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var l,h=r[a],u=h.length,c=0;c<u;++c)if(l=h[c]){for(var f,d=t.call(l,l.__data__,c,h),g=mi(l,n),p=0,m=d.length;p<m;++p)(f=d[p])&&ii(f,e,n,p,d,g);s.push(d),o.push(l)}return new Ii(s,o,e,n)},selectChild:e.selectChild,selectChildren:e.selectChildren,filter:function(t){"function"!=typeof t&&(t=wn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s,o=e[i],a=o.length,l=r[i]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new Ii(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,t=n.length,i=Math.min(r,t),s=new Array(r),o=0;o<i;++o)for(var a,l=e[o],h=n[o],u=l.length,c=s[o]=new Array(u),f=0;f<u;++f)(a=l[f]||h[f])&&(c[f]=a);for(;o<r;++o)s[o]=e[o];return new Ii(s,this._parents,this._name,this._id)},selection:function(){return new Ei(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=++Di,r=this._groups,i=r.length,s=0;s<i;++s)for(var o,a,l=r[s],h=l.length,u=0;u<h;++u)(o=l[u])&&(a=mi(o,e),ii(o,t,n,u,l,{time:a.time+a.delay+a.duration,delay:0,duration:a.duration,ease:a.ease}));return new Ii(r,this._parents,t,n)},call:e.call,nodes:e.nodes,node:e.node,size:e.size,empty:e.empty,each:e.each,on:function(t,e){var n,r,i,s,o,a,l=this._id;return arguments.length<2?mi(this.node(),l).on.on(t):this.each((n=l,i=e,a=((r=t)+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return!(t=0<=e?t.slice(0,e):t)||"start"===t})?gi:pi,function(){var t=a(this,n),e=t.on;e!==s&&(o=(s=e).copy()).on(r,i),t.on=o}))},attr:function(t,e){var n=In(t),r="transform"===n?ki:Ti;return this.attrTween(t,"function"==typeof e?(n.local?function(r,i,s){var o,a,l;return function(){var t,e,n=s(this);if(null!=n)return(t=this.getAttributeNS(r.space,r.local))===(e=n+"")?null:t===o&&e===a?l:(a=e,l=i(o=t,n));this.removeAttributeNS(r.space,r.local)}}:function(r,i,s){var o,a,l;return function(){var t,e,n=s(this);if(null!=n)return(t=this.getAttribute(r))===(e=n+"")?null:t===o&&e===a?l:(a=e,l=i(o=t,n));this.removeAttribute(r)}})(n,r,Si(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(e,n,r){var i,s,o=r+"";return function(){var t=this.getAttributeNS(e.space,e.local);return t===o?null:t===i?s:s=n(i=t,r)}}:function(e,n,r){var i,s,o=r+"";return function(){var t=this.getAttribute(e);return t===o?null:t===i?s:s=n(i=t,r)}})(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;t=In(t);return this.tween(n,(t.local?Mi:Ni)(t,e))},style:function(t,e,n){var r,i,s,o,a,l,h,u,c,f,d,g,p,m,y,_,v,w,A,b,x,k,S,T,M,N="transform"==(t+="")?xi:Ti;return null==e?this.styleTween(t,(x=t,k=N,function(){var t=Ln(this,x),e=(this.style.removeProperty(x),Ln(this,x));return t===e?null:t===S&&e===T?M:M=k(S=t,T=e)})).on("end.style."+t,Oi(t)):"function"==typeof e?this.styleTween(t,(_=N,v=Si(this,"style."+(y=t),e),function(){var t=Ln(this,y),e=v(this),n=e+"";return null==e&&(this.style.removeProperty(y),n=e=Ln(this,y)),t===n?null:t===w&&n===A?b:(A=n,b=_(w=t,e))})).each((h=this._id,m="end."+(p="style."+(u=t)),function(){var t=pi(this,h),e=t.on,n=null==t.value[p]?g=g||Oi(u):void 0;e===c&&d===n||(f=(c=e).copy()).on(m,d=n),t.on=f})):this.styleTween(t,(r=t,i=N,l=(s=e)+"",function(){var t=Ln(this,r);return t===l?null:t===o?a:a=i(o=t,s)}),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,Ci(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?(n=Si(this,"text",t),function(){var t=n(this);this.textContent=null==t?"":t}):(e=null==t?"":t+"",function(){this.textContent=e}));var e,n},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Pi(t))},remove:function(){return this.on("end.remove",(n=this._id,function(){var t,e=this.parentNode;for(t in this.__transition)if(+t!==n)return;e&&e.removeChild(this)}));var n},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=mi(this.node(),n).tween,s=0,o=i.length;s<o;++s)if((r=i[s]).name===t)return r.value;return null}return this.each((null==e?function(i,s){var o,a;return function(){var t=pi(this,i),e=t.tween;if(e!==o)for(var n=0,r=(a=o=e).length;n<r;++n)if(a[n].name===s){(a=a.slice()).splice(n,1);break}t.tween=a}}:function(s,o,a){var l,h;if("function"!=typeof a)throw new Error;return function(){var t=pi(this,s),e=t.tween;if(e!==l){h=(l=e).slice();for(var n={name:o,value:a},r=0,i=h.length;r<i;++r)if(h[r].name===o){h[r]=n;break}r===i&&h.push(n)}t.tween=h}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){gi(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){gi(this,t).delay=e}})(e,t)):mi(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){pi(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){pi(this,t).duration=e}})(e,t)):mi(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){pi(this,t).ease=e}}(e,t)):mi(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each((e=this._id,n=t,function(){var t=n.apply(this,arguments);if("function"!=typeof t)throw new Error;pi(this,e).ease=t}));var e,n},end:function(){var i,s,o=this,a=o._id,l=o.size();return new Promise(function(t,e){var n={value:e},r={value:function(){0==--l&&t()}};o.each(function(){var t=pi(this,a),e=t.on;e!==i&&((s=(i=e).copy())._.cancel.push(n),s._.interrupt.push(n),s._.end.push(r)),t.on=s}),0===l&&t()})},[Symbol.iterator]:e[Symbol.iterator]};var Fi={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};a.prototype.interrupt=function(t){return this.each(function(){vi(this,t)})},a.prototype.transition=function(t){var e,n;t=t instanceof Ii?(e=t._id,t._name):(e=++Di,(n=Fi).time=Zr(),null==t?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o,a=r[s],l=a.length,h=0;h<l;++h)(o=a[h])&&ii(o,t,e,h,a,n||function(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}(o,e));return new Ii(r,this._parents,t,e)};const{}=Math;["w","e"].map(Li),["n","s"].map(Li),["n","w","e","s","nw","ne","sw","se"].map(Li);function Li(t){return{type:t}}var Ui=new Date,qi=new Date;function Ri(s,o,n,r){function a(t){return s(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return s(t=new Date(+t)),t},a.ceil=function(t){return s(t=new Date(t-1)),o(t,1),s(t),t},a.round=function(t){var e=a(t),n=a.ceil(t);return t-e<n-t?e:n},a.offset=function(t,e){return o(t=new Date(+t),null==e?1:Math.floor(e)),t},a.range=function(t,e,n){var r,i=[];if(t=a.ceil(t),n=null==n?1:Math.floor(n),!(t<e&&0<n))return i;for(;i.push(r=new Date(+t)),o(t,n),s(t),r<t&&t<e;);return i},a.filter=function(n){return Ri(function(t){if(t<=t)for(;s(t),!n(t);)t.setTime(t-1)},function(t,e){if(t<=t)if(e<0)for(;++e<=0;)for(;o(t,-1),!n(t););else for(;0<=--e;)for(;o(t,1),!n(t););})},n&&(a.count=function(t,e){return Ui.setTime(+t),qi.setTime(+e),s(Ui),s(qi),Math.floor(n(Ui,qi))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&0<e?1<e?a.filter(r?function(t){return r(t)%e==0}:function(t){return a.count(0,t)%e==0}):a:null}),a}const ji=864e5;ji;ji,ji;function Hi(e){return Ri(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/6048e5})}var Yi=Hi(0),zi=Hi(1),Q=Hi(2),rt=Hi(3),Bi=Hi(4),e=Hi(5),a=Hi(6),Q=(Yi.range,zi.range,Q.range,rt.range,Bi.range,e.range,a.range,Ri(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/ji},function(t){return t.getUTCDate()-1})),Gi=Q;Q.range;function Wi(e){return Ri(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5})}var Xi=Wi(0),Vi=Wi(1),rt=Wi(2),e=Wi(3),$i=Wi(4),a=Wi(5),Q=Wi(6),a=(Xi.range,Vi.range,rt.range,e.range,$i.range,a.range,Q.range,Ri(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/ji,t=>t.getDate()-1)),Zi=a,Q=(a.range,Ri(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()}));Q.every=function(n){return isFinite(n=Math.floor(n))&&0<n?Ri(function(t){t.setFullYear(Math.floor(t.getFullYear()/n)*n),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e*n)}):null};var Qi=Q,a=(Q.range,Ri(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()}));a.every=function(n){return isFinite(n=Math.floor(n))&&0<n?Ri(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/n)*n),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e*n)}):null};var Ji=a;a.range;function Ki(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function ts(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function es(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function ns(t){var r=t.dateTime,i=t.date,s=t.time,e=t.periods,n=t.days,o=t.shortDays,a=t.months,l=t.shortMonths,h=hs(e),u=us(e),c=hs(n),f=us(n),d=hs(o),g=us(o),p=hs(a),m=us(a),y=hs(l),_=us(l),v={a:function(t){return o[t.getDay()]},A:function(t){return n[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:Cs,e:Cs,f:Ls,g:Xs,G:$s,H:Ps,I:Ds,j:Is,L:Fs,m:Us,M:qs,p:function(t){return e[+(12<=t.getHours())]},q:function(t){return 1+~~(t.getMonth()/3)},Q:vo,s:wo,S:Rs,u:js,U:Hs,V:zs,w:Bs,W:Gs,x:null,X:null,y:Ws,Y:Vs,Z:Zs,"%":_o},w={a:function(t){return o[t.getUTCDay()]},A:function(t){return n[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:Qs,e:Qs,f:no,g:go,G:mo,H:Js,I:Ks,j:to,L:eo,m:ro,M:io,p:function(t){return e[+(12<=t.getUTCHours())]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:vo,s:wo,S:so,u:oo,U:ao,V:ho,w:uo,W:co,x:null,X:null,y:fo,Y:po,Z:yo,"%":_o},A={a:function(t,e,n){e=d.exec(e.slice(n));return e?(t.w=g.get(e[0].toLowerCase()),n+e[0].length):-1},A:function(t,e,n){e=c.exec(e.slice(n));return e?(t.w=f.get(e[0].toLowerCase()),n+e[0].length):-1},b:function(t,e,n){e=y.exec(e.slice(n));return e?(t.m=_.get(e[0].toLowerCase()),n+e[0].length):-1},B:function(t,e,n){e=p.exec(e.slice(n));return e?(t.m=m.get(e[0].toLowerCase()),n+e[0].length):-1},c:function(t,e,n){return k(t,r,e,n)},d:As,e:As,f:Ms,g:ys,G:ms,H:xs,I:xs,j:bs,L:Ts,m:ws,M:ks,p:function(t,e,n){e=h.exec(e.slice(n));return e?(t.p=u.get(e[0].toLowerCase()),n+e[0].length):-1},q:vs,Q:Es,s:Os,S:Ss,u:fs,U:ds,V:gs,w:cs,W:ps,x:function(t,e,n){return k(t,i,e,n)},X:function(t,e,n){return k(t,s,e,n)},y:ys,Y:ms,Z:_s,"%":Ns};function b(l,h){return function(t){var e,n,r,i=[],s=-1,o=0,a=l.length;for(t instanceof Date||(t=new Date(+t));++s<a;)37===l.charCodeAt(s)&&(i.push(l.slice(o,s)),null!=(n=rs[e=l.charAt(++s)])?e=l.charAt(++s):n="e"===e?" ":"0",(r=h[e])&&(e=r(t,n)),i.push(e),o=s+1);return i.push(l.slice(o,s)),i.join("")}}function x(i,s){return function(t){var e,n,r=es(1900,void 0,1);if(k(r,i,t+="",0)!=t.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(1e3*r.s+("L"in r?r.L:0));if(!s||"Z"in r||(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"V"in r){if(r.V<1||53<r.V)return null;"w"in r||(r.w=1),"Z"in r?(e=4<(n=(e=ts(es(r.y,0,1))).getUTCDay())||0===n?zi.ceil(e):zi(e),e=Gi.offset(e,7*(r.V-1)),r.y=e.getUTCFullYear(),r.m=e.getUTCMonth(),r.d=e.getUTCDate()+(r.w+6)%7):(e=4<(n=(e=Ki(es(r.y,0,1))).getDay())||0===n?Vi.ceil(e):Vi(e),e=Zi.offset(e,7*(r.V-1)),r.y=e.getFullYear(),r.m=e.getMonth(),r.d=e.getDate()+(r.w+6)%7)}else("W"in r||"U"in r)&&("w"in r||(r.w="u"in r?r.u%7:"W"in r?1:0),n="Z"in r?ts(es(r.y,0,1)).getUTCDay():Ki(es(r.y,0,1)).getDay(),r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(n+5)%7:r.w+7*r.U-(n+6)%7);return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,ts(r)):Ki(r)}}function k(t,e,n,r){for(var i,s,o=0,a=e.length,l=n.length;o<a;){if(l<=r)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(s=A[i in rs?e.charAt(o++):i])||(r=s(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=b(i,v),v.X=b(s,v),v.c=b(r,v),w.x=b(i,w),w.X=b(s,w),w.c=b(r,w),{format:function(t){var e=b(t+="",v);return e.toString=function(){return t},e},parse:function(t){var e=x(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=b(t+="",w);return e.toString=function(){return t},e},utcParse:function(t){var e=x(t+="",!0);return e.toString=function(){return t},e}}}var rs={"-":"",_:" ",0:"0"},is=/^\s*\d+/,ss=/^%/,os=/[\\^$*+?|[\]().{}]/g;function as(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",t=i.length;return r+(t<n?new Array(n-t+1).join(e)+i:i)}function ls(t){return t.replace(os,"\\$&")}function hs(t){return new RegExp("^(?:"+t.map(ls).join("|")+")","i")}function us(t){return new Map(t.map((t,e)=>[t.toLowerCase(),e]))}function cs(t,e,n){e=is.exec(e.slice(n,n+1));return e?(t.w=+e[0],n+e[0].length):-1}function fs(t,e,n){e=is.exec(e.slice(n,n+1));return e?(t.u=+e[0],n+e[0].length):-1}function ds(t,e,n){e=is.exec(e.slice(n,n+2));return e?(t.U=+e[0],n+e[0].length):-1}function gs(t,e,n){e=is.exec(e.slice(n,n+2));return e?(t.V=+e[0],n+e[0].length):-1}function ps(t,e,n){e=is.exec(e.slice(n,n+2));return e?(t.W=+e[0],n+e[0].length):-1}function ms(t,e,n){e=is.exec(e.slice(n,n+4));return e?(t.y=+e[0],n+e[0].length):-1}function ys(t,e,n){e=is.exec(e.slice(n,n+2));return e?(t.y=+e[0]+(68<+e[0]?1900:2e3),n+e[0].length):-1}function _s(t,e,n){e=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return e?(t.Z=e[1]?0:-(e[2]+(e[3]||"00")),n+e[0].length):-1}function vs(t,e,n){e=is.exec(e.slice(n,n+1));return e?(t.q=3*e[0]-3,n+e[0].length):-1}function ws(t,e,n){e=is.exec(e.slice(n,n+2));return e?(t.m=e[0]-1,n+e[0].length):-1}function As(t,e,n){e=is.exec(e.slice(n,n+2));return e?(t.d=+e[0],n+e[0].length):-1}function bs(t,e,n){e=is.exec(e.slice(n,n+3));return e?(t.m=0,t.d=+e[0],n+e[0].length):-1}function xs(t,e,n){e=is.exec(e.slice(n,n+2));return e?(t.H=+e[0],n+e[0].length):-1}function ks(t,e,n){e=is.exec(e.slice(n,n+2));return e?(t.M=+e[0],n+e[0].length):-1}function Ss(t,e,n){e=is.exec(e.slice(n,n+2));return e?(t.S=+e[0],n+e[0].length):-1}function Ts(t,e,n){e=is.exec(e.slice(n,n+3));return e?(t.L=+e[0],n+e[0].length):-1}function Ms(t,e,n){e=is.exec(e.slice(n,n+6));return e?(t.L=Math.floor(e[0]/1e3),n+e[0].length):-1}function Ns(t,e,n){e=ss.exec(e.slice(n,n+1));return e?n+e[0].length:-1}function Es(t,e,n){e=is.exec(e.slice(n));return e?(t.Q=+e[0],n+e[0].length):-1}function Os(t,e,n){e=is.exec(e.slice(n));return e?(t.s=+e[0],n+e[0].length):-1}function Cs(t,e){return as(t.getDate(),e,2)}function Ps(t,e){return as(t.getHours(),e,2)}function Ds(t,e){return as(t.getHours()%12||12,e,2)}function Is(t,e){return as(1+Zi.count(Qi(t),t),e,3)}function Fs(t,e){return as(t.getMilliseconds(),e,3)}function Ls(t,e){return Fs(t,e)+"000"}function Us(t,e){return as(t.getMonth()+1,e,2)}function qs(t,e){return as(t.getMinutes(),e,2)}function Rs(t,e){return as(t.getSeconds(),e,2)}function js(t){t=t.getDay();return 0===t?7:t}function Hs(t,e){return as(Xi.count(Qi(t)-1,t),e,2)}function Ys(t){var e=t.getDay();return 4<=e||0===e?$i(t):$i.ceil(t)}function zs(t,e){return t=Ys(t),as($i.count(Qi(t),t)+(4===Qi(t).getDay()),e,2)}function Bs(t){return t.getDay()}function Gs(t,e){return as(Vi.count(Qi(t)-1,t),e,2)}function Ws(t,e){return as(t.getFullYear()%100,e,2)}function Xs(t,e){return as((t=Ys(t)).getFullYear()%100,e,2)}function Vs(t,e){return as(t.getFullYear()%1e4,e,4)}function $s(t,e){var n=t.getDay();return as((t=4<=n||0===n?$i(t):$i.ceil(t)).getFullYear()%1e4,e,4)}function Zs(t){t=t.getTimezoneOffset();return(0<t?"-":(t*=-1,"+"))+as(t/60|0,"0",2)+as(t%60,"0",2)}function Qs(t,e){return as(t.getUTCDate(),e,2)}function Js(t,e){return as(t.getUTCHours(),e,2)}function Ks(t,e){return as(t.getUTCHours()%12||12,e,2)}function to(t,e){return as(1+Gi.count(Ji(t),t),e,3)}function eo(t,e){return as(t.getUTCMilliseconds(),e,3)}function no(t,e){return eo(t,e)+"000"}function ro(t,e){return as(t.getUTCMonth()+1,e,2)}function io(t,e){return as(t.getUTCMinutes(),e,2)}function so(t,e){return as(t.getUTCSeconds(),e,2)}function oo(t){t=t.getUTCDay();return 0===t?7:t}function ao(t,e){return as(Yi.count(Ji(t)-1,t),e,2)}function lo(t){var e=t.getUTCDay();return 4<=e||0===e?Bi(t):Bi.ceil(t)}function ho(t,e){return t=lo(t),as(Bi.count(Ji(t),t)+(4===Ji(t).getUTCDay()),e,2)}function uo(t){return t.getUTCDay()}function co(t,e){return as(zi.count(Ji(t)-1,t),e,2)}function fo(t,e){return as(t.getUTCFullYear()%100,e,2)}function go(t,e){return as((t=lo(t)).getUTCFullYear()%100,e,2)}function po(t,e){return as(t.getUTCFullYear()%1e4,e,4)}function mo(t,e){var n=t.getUTCDay();return as((t=4<=n||0===n?Bi(t):Bi.ceil(t)).getUTCFullYear()%1e4,e,4)}function yo(){return"+0000"}function _o(){return"%"}function vo(t){return+t}function wo(t){return Math.floor(+t/1e3)}var Ao=(Q=ns({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})).format,a=Q.parse;Q.utcFormat,Q.utcParse;function bo(t){return((t=Math.exp(t))+1/t)/2}(function n(f,d,g){function t(t,e){var r,i,s,n,o=t[0],a=t[1],l=t[2],h=e[0],t=e[1],e=e[2],u=h-o,c=t-a,h=u*u+c*c;return(n=h<1e-12?(s=Math.log(e/l)/f,function(t){return[o+t*u,a+t*c,l*Math.exp(f*t*s)]}):(r=Math.sqrt(h),t=(e*e-l*l+g*h)/(2*l*d*r),n=(e*e-l*l-g*h)/(2*e*d*r),i=Math.log(Math.sqrt(t*t+1)-t),s=(Math.log(Math.sqrt(n*n+1)-n)-i)/f,function(t){var e=t*s,n=bo(i),t=l/(d*r)*(n*(t=f*e+i,((t=Math.exp(2*t))-1)/(t+1))-(t=i,((t=Math.exp(i))-1/t)/2));return[o+t*u,a+t*c,l*n/bo(f*e+i)]})).duration=1e3*s*f/Math.SQRT2,n}return t.rho=function(t){var e=Math.max(.001,+t),t=e*e;return n(e,t,t*t)},t})(Math.SQRT2,2,4);function xo(t){return null!=t&&-1<t}class ko{constructor(t,e){this.color="#3366cc",this.showColor=!0,this.filter=!1,this.priority=0,this.id=t,this.name="Selection-"+this.id,this.elementIds=[],this.acceptedType=e,this.priority=t}acceptsType(t){return this.acceptedType==t}}Ao("%m/%d/%Y"),Ao("%d/%m/%Y");const So="%Y-%m-%d %H:%M:%S",To=a(So),Mo=Ao(So);Ao("%w");const No=["millisecond","second","minute","hour","day","week","month","year","decade","century","millenium"],Eo="[*dgraph*]";class Oo{constructor(){this.BOOKMARK_COLORS=this.default_colors,this.selectionColor_pointer=0,this.name="",this.gran_min=0,this.gran_max=Number.MAX_VALUE,this.minWeight=1e7,this.maxWeight=-1e7,this._nodes=[],this._links=[],this.directed=!1,this._nodePairs=[],this._locations=[],this._times=[],this.timeObjects=[],this.nodeOrders=[],this.matrix=[],this.selections=[],this.nodeArrays=new Po,this.linkArrays=new Do,this.nodePairArrays=new Io,this.timeArrays=new Fo,this.linkTypeArrays=new Lo,this.nodeTypeArrays=new Uo,this.locationArrays=new qo,this.attributeArrays={node:this.nodeArrays,link:this.linkArrays,time:this.timeArrays,nodePair:this.nodePairArrays,linkType:this.linkTypeArrays,nodeType:this.nodeTypeArrays,location:this.locationArrays},this.highlightArrays=new ia,this.highlightFreezeArrays=new ia,this.currentSelection_id=0,this.defaultLinkSelection=this.createSelection("link"),this.defaultNodeSelection=this.createSelection("node"),this.gran_min_NAME="gran_min",this.gran_max_NAME="gran_max_NAME",this.directed_NAME="directed_NAME",this.minWeight_NAME="minWeight_NAME",this.maxWeight_NAME="maxWeight_NAME",this.matrix_NAME="matrix_NAME",this.nodeArrays_NAME="nodeArrays_NAME",this.linkArrays_NAME="linkArrays_NAME",this.nodePairArrays_NAME="nodePairArrays_NAME",this.timeArrays_NAME="timeArrays_NAME",this.linkTypeArrays_NAME="linkTypeArrays_NAME",this.nodeTypeArrays_NAME="nodeTypeArrays_NAME",this.locationArrays_NAME="locationArrays_NAME"}default_colors(t){var e=["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac"];return e[t%e.length]}attr(t,e,n){let r;try{r=this.attributeArrays[n][t][e]}catch(t){r=void 0}return r}standardArrayReplacer(t,e){return e instanceof Oo?(console.log("standardReplacer found a DynamicGraph property",t),Eo):"selections"!=t?e:void 0}static timeReviver(t,e,n){return""==t?sa(e,new Wo(e.id,n)):(n=n,(e=e)==Eo?n:e)}static nodeArrayReviver(t,e,n){switch(t){case"":return sa(e,new Po);case"outLinks":case"inLinks":case"links":return oa(e,function(){return new Bo});case"outNeighbors":case"inNeighbors":case"neighbors":return oa(e,function(){return new Bo});case"locations":return oa(e,function(){return new zo});default:return e}}static linkArrayReviver(t,e,n){switch(t){case"":return sa(e,new Do);case"weights":return oa(e,function(){return new zo});default:return e}}static nodePairArrayReviver(t,e,n){return""!==t?e:sa(e,new Io)}static timeArrayReviver(t,e,n){switch(t){case"":return sa(e,new Fo);case"time":return e.map(function(t,e){return new Date(t)});default:return e}}static linkTypeArrayReviver(t,e,n){return""!==t?e:sa(e,new Lo)}static nodeTypeArrayReviver(t,e,n){return""!==t?e:sa(e,new Uo)}static locationArrayReviver(t,e,n){return""!==t?e:sa(e,new qo)}loadDynamicGraph(t,e){this.clearSelections(),this.name=e;e=t.getFromStorage(this.name,this.gran_min_NAME);null!=e&&(this.gran_min=e);e=t.getFromStorage(this.name,this.gran_max_NAME);null!=e&&(this.gran_max=e);e=t.getFromStorage(this.name,this.directed_NAME);null!=e&&(this.directed=e);e=t.getFromStorage(this.name,this.minWeight_NAME);null!=e&&(this.minWeight=e);e=t.getFromStorage(this.name,this.maxWeight_NAME);null!=e&&(this.maxWeight=e);e=t.getFromStorage(this.name,this.matrix_NAME);null!=e&&(this.matrix=e);e=t.getFromStorage(this.name,this.nodeArrays_NAME,Oo.nodeArrayReviver);null!=e&&(this.nodeArrays=e);e=t.getFromStorage(this.name,this.linkArrays_NAME,Oo.linkArrayReviver);null!=e&&(this.linkArrays=e);e=t.getFromStorage(this.name,this.nodePairArrays_NAME,Oo.nodePairArrayReviver);null!=e&&(this.nodePairArrays=e);e=t.getFromStorage(this.name,this.timeArrays_NAME,Oo.timeArrayReviver);if(null!=e&&(this.timeArrays=e),"timeArrays"in this&&this.timeArrays)if("momentTime"in this.timeArrays&&"unixTime"in this.timeArrays){const n=this.timeArrays.momentTime;for(let t=0;t<n.length;t++)n[t]=new Date(this.timeArrays.unixTime[t])}else"unixTime"in this.timeArrays?(console.log("No time in timeArrays"),this.timeArrays.momentTime=this.timeArrays.unixTime.map(new Date)):(console.log("No time or unixTime in timeArrays"),this.timeArrays.momentTime=[]);else console.log("No timeArrays"),this.timeArrays=new Fo;e=t.getFromStorage(this.name,this.linkTypeArrays_NAME,Oo.linkTypeArrayReviver);null!=e&&(this.linkTypeArrays=e);e=t.getFromStorage(this.name,this.nodeTypeArrays_NAME,Oo.nodeTypeArrayReviver);null!=e&&(this.nodeTypeArrays=e);t=t.getFromStorage(this.name,this.locationArrays_NAME,Oo.locationArrayReviver);null!=t&&(this.locationArrays=t),this.attributeArrays={node:this.nodeArrays,link:this.linkArrays,time:this.timeArrays,nodePair:this.nodePairArrays,linkType:this.linkTypeArrays,nodeType:this.nodeTypeArrays,location:this.locationArrays},this.createGraphObjects(!0,!0),this.createSelections(!0)}saveDynamicGraph(t){t.saveToStorage(this.name,this.gran_min_NAME,this.gran_min),t.saveToStorage(this.name,this.gran_max_NAME,this.gran_max),t.saveToStorage(this.name,this.directed_NAME,this.directed),t.saveToStorage(this.name,this.minWeight_NAME,this.minWeight),t.saveToStorage(this.name,this.maxWeight_NAME,this.maxWeight),t.saveToStorage(this.name,this.matrix_NAME,this.matrix),t.saveToStorage(this.name,this.nodeArrays_NAME,this.nodeArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.linkArrays_NAME,this.linkArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.nodePairArrays_NAME,this.nodePairArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.timeArrays_NAME,this.timeArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.linkTypeArrays_NAME,this.linkTypeArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.nodeTypeArrays_NAME,this.nodeTypeArrays,this.standardArrayReplacer),t.saveToStorage(this.name,this.locationArrays_NAME,this.locationArrays,this.standardArrayReplacer)}delete(t){t.removeFromStorage(this.name,this.gran_min_NAME),t.removeFromStorage(this.name,this.gran_max_NAME),t.removeFromStorage(this.name,this.directed_NAME),t.removeFromStorage(this.name,this.minWeight_NAME),t.removeFromStorage(this.name,this.maxWeight_NAME),t.removeFromStorage(this.name,this.matrix_NAME),t.removeFromStorage(this.name,this.nodeArrays_NAME),t.removeFromStorage(this.name,this.linkArrays_NAME),t.removeFromStorage(this.name,this.nodePairArrays_NAME),t.removeFromStorage(this.name,this.timeArrays_NAME),t.removeFromStorage(this.name,this.linkTypeArrays_NAME),t.removeFromStorage(this.name,this.nodeTypeArrays_NAME),t.removeFromStorage(this.name,this.locationArrays_NAME)}debugCompareTo(t){let e=!0;return this.name!=t.name&&(console.log("name different"),e=!1),this.gran_min!=t.gran_min&&(console.log("gran_min different",this.gran_min,t.gran_min),e=!1),this.gran_max!=t.gran_max&&(console.log("gran_max different",this.gran_max,t.gran_max),e=!1),this.directed!=t.directed&&(console.log("directed different",this.directed,t.directed),e=!1),this._nodes.length==t._nodes.length&&aa(this._nodes,t._nodes,2)||(console.log("nodes different"),e=!1),this._links.length==t._links.length&&aa(this._links,t._links,2)||(console.log("links different"),e=!1),this._nodePairs.length==t._nodePairs.length&&aa(this._nodePairs,t._nodePairs,2)||(console.log("nodePairs different"),e=!1),this._locations.length==t._locations.length&&aa(this._locations,t._locations,2)||(console.log("locations different"),e=!1),this._times.length==t._times.length&&aa(this._times,t._times,2)||(console.log("times different"),e=!1),(this.nodeOrders&&this.nodeOrders.length!=t.nodeOrders.length||!aa(this.nodeOrders,t.nodeOrders,2))&&(console.log("nodeOrders different",this.nodeOrders,t.nodeOrders),e=!1),this.matrix.length==t.matrix.length&&aa(this.matrix,t.matrix,2)||(console.log("matrix different",this.matrix,t.matrix),e=!1),this.nodeArrays.length==t.nodeArrays.length&&aa(this.nodeArrays,t.nodeArrays,2)||(console.log("nodeArrays different",this.nodeArrays,t.nodeArrays),e=!1),this.linkArrays.length==t.linkArrays.length&&aa(this.linkArrays,t.linkArrays,2)||(console.log("linkArrays different",this.linkArrays,t.linkArrays),e=!1),this.nodePairArrays.length==t.nodePairArrays.length&&aa(this.nodePairArrays,t.nodePairArrays,2)||(console.log("nodePairArrays different",this.nodePairArrays,t.nodePairArrays),e=!1),this.timeArrays.length==t.timeArrays.length&&aa(this.timeArrays,t.timeArrays,2)||(console.log("timeArrays different",this.timeArrays,t.timeArrays),e=!1),this.linkTypeArrays.length==t.linkTypeArrays.length&&aa(this.linkTypeArrays,t.linkTypeArrays,2)||(console.log("linkTypeArrays different",this.linkTypeArrays,t.linkTypeArrays),e=!1),this.nodeTypeArrays.length==t.nodeTypeArrays.length&&aa(this.nodeTypeArrays,t.nodeTypeArrays,2)||(console.log("nodeTypeArrays different",this.nodeTypeArrays,t.nodeTypeArrays),e=!1),this.locationArrays.length==t.locationArrays.length&&aa(this.locationArrays,t.locationArrays,2)||(console.log("locationArrays different",this.locationArrays,t.locationArrays),e=!1),this.defaultLinkSelection.elementIds.length==t.defaultLinkSelection.elementIds.length&&aa(this.defaultLinkSelection,t.defaultLinkSelection,2)||(console.log("defaultLinkSelection different",this.defaultLinkSelection,t.defaultLinkSelection),e=!1),this.defaultNodeSelection.elementIds.length==t.defaultNodeSelection.elementIds.length&&aa(this.defaultNodeSelection,t.defaultNodeSelection,2)||(console.log("defaultNodeSelection different",this.defaultNodeSelection,t.defaultNodeSelection),e=!1),this.selections.length==t.selections.length&&aa(this.selections,t.selections,2)||(console.log("selections different",this.selections,t.selections),e=!1),e}initDynamicGraph(n){var r,e,i,s,o,a;this.clearSelections(),console.log("[dynamicgraph.ts] Create dynamic graph for ",n.name,n),this.name=n.name,this.directed=n.directed,this.gran_min=0,this.gran_max=0;let l;const h=[];let u;if(xo(n.linkSchema.time)){console.log("GEtting unix times for all times - linktable"),console.log(n.linkTable);for(let t=0;t<n.linkTable.length;t++)l=n.linkTable[t][n.linkSchema.time],console.log(n.linkTable[t]),u=null===(r=To(l))||void 0===r?void 0:r.getTime(),null!=u&&-1==h.indexOf(u)&&h.push(u);h.sort(la);let e=99999999999999;for(let t=0;t<h.length-2;t++)e=Math.min(e,h[t+1]-h[t]);1e3<=e&&(this.gran_min=1),6e4<=e&&(this.gran_min=2),36e5<=e&&(this.gran_min=3),864e5<=e&&(this.gran_min=4),6048e5<=e&&(this.gran_min=5),2592e6<=e&&(this.gran_min=6),31104e6<=e&&(this.gran_min=7),31104e7<=e&&(this.gran_min=8),31104e8<=e&&(this.gran_min=9),31104e9<=e&&(this.gran_min=10),e=h[h.length-1]-h[0],this.gran_max=0,1e3<=e&&(this.gran_max=1),6e4<=e&&(this.gran_max=2),36e5<=e&&(this.gran_max=3),864e5<=e&&(this.gran_max=4),6048e5<=e&&(this.gran_max=5),2592e6<=e&&(this.gran_max=6),31104e6<=e&&(this.gran_max=7),31104e7<=e&&(this.gran_max=8),31104e8<=e&&(this.gran_max=9),31104e9<=e&&(this.gran_max=10),console.log("[Dynamic Graph] Minimal granularity",No[this.gran_min]),console.log("[Dynamic Graph] Maximal granularity",No[this.gran_max]);for(let t=0;t<h.length;t++)this.timeArrays.id.push(t),this.timeArrays.momentTime.push(new Date(h[t])),this.timeArrays.label.push(Mo(this.timeArrays.momentTime[t])),this.timeArrays.unixTime.push(h[t]),this.timeArrays.selections.push([]),this.timeArrays.filter.push(!1),this.timeArrays.links.push([]),this._times.push(new Wo(t,this));for(let t=0;t<=No.length;t++)this.timeObjects.push([])}if(0==this.timeArrays.length&&(this.timeArrays.id.push(0),this.timeArrays.momentTime.push(new Date(0)),this.timeArrays.unixTime.push(0),this.timeArrays.selections.push([]),this.timeArrays.filter.push(!1),this.timeArrays.links.push([]),this._times.push(new Wo(0,this))),console.assert(!n.locationTable||xo(n.locationSchema.id)),n.locationTable)for(let t=0;t<n.locationTable.length;t++)this.locationArrays.id.push(n.locationTable[t][n.locationSchema.id]),this.locationArrays.label.push(n.locationTable[t][n.locationSchema.label]),this.locationArrays.longitude.push(n.locationTable[t][n.locationSchema.longitude]),this.locationArrays.latitude.push(n.locationTable[t][n.locationSchema.latitude]),this.locationArrays.x.push(n.locationTable[t][n.locationSchema.x]),this.locationArrays.y.push(n.locationTable[t][n.locationSchema.y]),this.locationArrays.z.push(n.locationTable[t][n.locationSchema.z]),this.locationArrays.radius.push(n.locationTable[t][n.locationSchema.radius]);"id"in this.locationArrays&&console.log("locations",this.locationArrays.id.length);let c,f,d;console.assert(0==n.nodeTable.length||xo(n.nodeSchema.id),"either there is no nodeTable data, or we have a schema for the nodetable");let g,p;const m=[];for(const t in n.nodeSchema)Object.prototype.hasOwnProperty.call(n.nodeSchema,t)&&"id"!=t&&"label"!=t&&"time"!=t&&"name"!=t&&"nodeType"!=t&&"location"!=t&&"constructor"!=t&&(m.push(t),this.nodeArrays[t]=[]);for(let t=0;t<n.nodeTable.length;t++){if(c=n.nodeTable[t],e=c[n.nodeSchema.id],f=this.nodeArrays.id.indexOf(e),-1==f&&(f=this.nodeArrays.id.length,this.nodeArrays.id.push(e),this.nodeArrays.nodeType.push(""),this.nodeArrays.outLinks.push(new Bo),this.nodeArrays.inLinks.push(new Bo),this.nodeArrays.links.push(new Bo),this.nodeArrays.outNeighbors.push(new Bo),this.nodeArrays.inNeighbors.push(new Bo),this.nodeArrays.neighbors.push(new Bo),this.nodeArrays.selections.push([]),this.nodeArrays.filter.push(!1),this.nodeArrays.locations.push(new zo),this.nodeArrays.attributes.push(new Object),this.nodeArrays.color.push(""),this.nodeArrays.shape.push(""),xo(n.nodeSchema.label)?this.nodeArrays.label.push(c[n.nodeSchema.label]):this.nodeArrays.label.push(c[n.nodeSchema.id])),d=xo(n.nodeSchema.time)?(l=c[n.nodeSchema.time],console.log("params"),console.log(l),console.log(So),console.log(null===(i=To(l))||void 0===i?void 0:i.toUTCString()),console.log(null===(i=To(l))||void 0===i?void 0:i.getTime()),i=this.getTimeIdForUnixTime(null===(i=To(l))||void 0===i?void 0:i.getTime()),null==l||null==i?this._times[0]:this._times[i]):this._times[0],null==d&&(d=this._times[0]),xo(n.nodeSchema.location)){var y=c[n.nodeSchema.location];if(null==y)continue;this.nodeArrays.locations[e].set(d,y)}xo(n.nodeSchema.shape)&&(y=c[n.nodeSchema.shape],this.nodeArrays.shape.push(y)),xo(n.nodeSchema.nodeType)&&(g=n.nodeTable[t][n.nodeSchema.nodeType],p=this.nodeTypeArrays.name.indexOf(g),p<0&&(p=this.nodeTypeArrays.length,this.nodeTypeArrays.id.push(p),this.nodeTypeArrays.name.push(g)),this.nodeArrays.nodeType[f]=g,n.nodeTable[t][n.nodeSchema.nodeType]=p);for(let t=0;t<m.length;t++){var _=m[t];this.nodeArrays[_].push(c[n.nodeSchema[_]])}}if("id"in this.nodeArrays)for(let t=0;t<this.nodeArrays.id.length;t++)this.matrix.push(function(t,e){const n=[];for(;e--;)n[e]=t;return n}(void 0,this.nodeArrays.id.length));let v,w;const A=[];for(const M in n.linkSchema)Object.prototype.hasOwnProperty.call(n.linkSchema,M)&&"id"!=M&&"linkType"!=M&&"time"!=M&&"name"!=M&&"source"!=M&&"target"!=M&&"weight"!=M&&"directed"!=M&&(A.push(M),this.linkArrays[M]=[]);console.log("linkUserProperties",A),console.assert(0==n.linkTable.length||xo(n.linkSchema.id)&&xo(n.linkSchema.source)&&xo(n.linkSchema.target),"either there are no links, or the linkschema is defined");for(let t=0;t<n.linkTable.length;t++){c=n.linkTable[t],o=c[n.linkSchema.id],this.linkArrays.directed.push(!1),-1==this.linkArrays.id.indexOf(o)&&(this.linkArrays.id[o]=o,this.linkArrays.source[o]=c[n.linkSchema.source],this.linkArrays.target[o]=c[n.linkSchema.target],this.linkArrays.linkType[o]=c[n.linkSchema.linkType],this.linkArrays.directed[o]=c[n.linkSchema.directed],this.linkArrays.weights[o]=new zo,this.linkArrays.presence[o]=[],this.linkArrays.selections.push([]),this.linkArrays.nodePair.push(void 0),this.linkArrays.filter.push(!1)),v=xo(n.linkSchema.time)?(l=n.linkTable[t][n.linkSchema.time],u=null===(s=To(l))||void 0===s?void 0:s.getTime(),null!=(a=u?this.getTimeIdForUnixTime(u):void 0)?a:0):0,d=this._times[v],this.linkArrays.presence[o].push(v),xo(n.linkSchema.weight)&&null!=n.linkTable[t][n.linkSchema.weight]?(this.linkArrays.weights[o].set(d,n.linkTable[t][n.linkSchema.weight]),this.minWeight=Math.min(this.minWeight,n.linkTable[t][n.linkSchema.weight]),this.maxWeight=Math.max(this.maxWeight,n.linkTable[t][n.linkSchema.weight])):(this.minWeight=0,this.maxWeight=1,this.linkArrays.weights[o].set(d,1)),s=this.nodeArrays.id.indexOf(c[n.linkSchema.source]),a=this.nodeArrays.id.indexOf(c[n.linkSchema.target]),this.nodeArrays.neighbors[s].add(d,a),this.nodeArrays.neighbors[a].add(d,s),this.nodeArrays.links[s].add(d,o),this.nodeArrays.links[a].add(d,o),this.linkArrays.directed[t]&&(this.nodeArrays.outNeighbors[s].add(d,a),this.nodeArrays.inNeighbors[a].add(d,s),this.nodeArrays.outLinks[s].add(d,o),this.nodeArrays.inLinks[a].add(d,o)),w=this.matrix[s][a],xo(w)||(w=this.nodePairArrays.length,this.matrix[s][a]=w,this.nodePairArrays.id.push(w),this.nodePairArrays.source.push(s),this.nodePairArrays.target.push(a),this.nodePairArrays.links.push([]),this.nodePairArrays.selections.push([]),this.nodePairArrays.filter.push(!1)),-1==this.nodePairArrays.links[w].indexOf(o)&&(this.nodePairArrays.links[w].push(o),this.linkArrays.nodePair[o]=w),xo(n.linkSchema.linkType)&&(g=n.linkTable[t][n.linkSchema.linkType],p=this.linkTypeArrays.name.indexOf(g),p<0&&(p=this.linkTypeArrays.length,this.linkTypeArrays.id.push(p),this.linkTypeArrays.name.push(g)),n.linkTable[t][n.linkSchema.linkType]=p);for(let t=0;t<A.length;t++){var b=A[t];this.linkArrays[b].push(c[n.linkSchema[b]])}}for(let e=0;e<this.linkArrays.length;e++)for(let t=0;t<this.timeArrays.length;t++)this.linkArrays.weights[e]&&Object.prototype.hasOwnProperty.call(this.linkArrays.weights[e].toArray(),this.timeArrays.id[t].toString())&&this.timeArrays.links[t].push(this.linkArrays.id[e]);const x=new Set(["#e4549b","#a33a36","#bd6221","#dfba47","#b5b867","#479b7f","#335b8e","#78387d"]),k={};this.nodeArrays.color.forEach(function(t){var e;k[t]||(e=(e=Array.from(x))[Math.floor(Math.random()*e.length)],k[t]=e,x.delete(e))});const S=new Set(["cross","diamond","square","triangle"]),T={};this.nodeArrays.shape.forEach(function(t){var e;T[t]||(e=(e=Array.from(S))[Math.floor(Math.random()*e.length)],T[t]=e,S.delete(e))}),console.log("[Dynamic Graph] Dynamic Graph created: ",this.nodeArrays.length),console.log("[Dynamic Graph]    - Nodes: ",this.nodeArrays.length),console.log("[Dynamic Graph]    - Edges: ",this.linkArrays.length),console.log("[Dynamic Graph]    - Times: ",this.timeArrays.length),console.log("[Dynamic Graph]    - Link types: ",this.linkTypeArrays.length),console.log("[Dynamic Graph]    - Node Pairs: ",this.nodePairArrays.length),console.log('>>>this.nodeArrays["neighbors"][0]',this.nodeArrays.neighbors[0]),this.createGraphObjects(!0,!0),this.createSelections(!1)}createSelections(t){if(t){"nodeArrays"in this&&this.nodeArrays||(this.nodeArrays=new Po,this.linkArrays=new Do,this.timeArrays=new Fo,this.nodePairArrays=new Io),this.nodeArrays.selections=new Array(this.nodeArrays.length);for(let t=0;t<this.nodeArrays.selections.length;t++)this.nodeArrays.selections[t]=[];this.linkArrays.selections=new Array(this.linkArrays.length);for(let t=0;t<this.linkArrays.selections.length;t++)this.linkArrays.selections[t]=[];this.timeArrays.selections=new Array(this.timeArrays.length);for(let t=0;t<this.timeArrays.selections.length;t++)this.timeArrays.selections[t]=[];this.nodePairArrays.selections=new Array(this.nodePairArrays.length);for(let t=0;t<this.nodePairArrays.selections.length;t++)this.nodePairArrays.selections[t]=[]}this.defaultNodeSelection=this.createSelection("node"),this.defaultNodeSelection.name="Unselected";for(let t=0;t<this._nodes.length;t++)this.defaultNodeSelection.elementIds.push(t),this.addToAttributeArraysSelection(this.defaultNodeSelection,"node",this._nodes[t].id());this.defaultNodeSelection.color="#000000",this.defaultNodeSelection.showColor=!1,this.defaultNodeSelection.priority=1e4,this.selectionColor_pointer--,this.defaultLinkSelection=this.createSelection("link"),this.defaultLinkSelection.name="Unselected";for(let t=0;t<this._links.length;t++)this.defaultLinkSelection.elementIds.push(t),this.addToAttributeArraysSelection(this.defaultLinkSelection,"link",this._links[t].id());this.defaultLinkSelection.color="#000000",this.defaultLinkSelection.showColor=!1,this.defaultLinkSelection.priority=1e4,this.selectionColor_pointer--;let e=[],n,r,i;const s=[];for(let t=0;t<this.nodeArrays.nodeType.length;t++)n=this.nodeArrays.nodeType[t],null!=n&&0!=n.length&&"undefined"!=n&&(r=e.indexOf(n),-1==r?(i=this.createSelection("node"),i.name=n,s.push(i),e.push(n)):i=s[r],this.addElementToSelection(i,this._nodes[t]));1==s.length&&(console.log("nodeSelections[0]:",s[0]),s[0].color="#444"),e=[];const o=[];for(let t=0;t<this.linkArrays.linkType.length;t++)n=this.linkArrays.linkType[t],n&&"undefined"!=n&&(r=e.indexOf(n),-1==r?(i=this.createSelection("link"),i.name=n,o.push(i),e.push(n)):i=o[r],this.addElementToSelection(i,this._links[t]));1==o.length&&(o[0].color="#444"),this.currentSelection_id=0}createGraphObjects(t,e){console.log("[DynamicNetwork:createGraph()] >>> ");var n,r=Date.now();if(this.locationArrays&&"id"in this.locationArrays)for(let t=0;t<this.locationArrays.id.length;t++)this._locations.push(new $o(this.locationArrays.id[t],this));else this.locationArrays=new qo;const i=[];if("nodeArrays"in this&&this.nodeArrays)for(let t=0;t<this.nodeArrays.id.length;t++)i.push(new ea(t,this));const s=[];if("linkArrays"in this&&this.linkArrays)for(let t=0;t<this.linkArrays.source.length;t++)n=new ra(t,this),s.push(n);if("nodePairArrays"in this&&this.nodePairArrays)for(let t=0;t<this.nodePairArrays.length;t++)this.nodePairArrays.links[t],this._nodePairs.push(new Qo(t,this));if(this._nodes=i,this._links=s,t){this._times=[];for(let t=0;t<this.timeArrays.length;t++)this._times.push(new Wo(t,this))}console.log("[DynamicNetwork:getGraph()] <<< ",Date.now()-r,"msec")}nodeAttr(t,e){return this.attr(t,e,"node")}linkAttr(t,e){return this.attr(t,e,"link")}pairAttr(t,e){return this.attr(t,e,"nodePair")}timeAttr(t,e){return this.attr(t,e,"time")}get startTime(){return this._times[0]}get endTime(){return this._times[this._times.length-1]}highlight(t,e){if("freeze"==t)return this.highlight("resetFreeze"),void this.highlight("addFreeze",e);if("resetFreeze"==t)return this.highlightFreezeArrays.nodeIds=[],this.highlightFreezeArrays.linkIds=[],this.highlightFreezeArrays.nodePairIds=[],void(this.highlightFreezeArrays.timeIds=[]);if("reset"==t)return this.highlightArrays.nodeIds=[],this.highlightArrays.linkIds=[],this.highlightArrays.nodePairIds=[],void(this.highlightArrays.timeIds=[]);if(e){if("set"==t)return this.highlight("reset"),void this.highlight("add",e);if("add"==t)for(const i in e)for(let t=0;t<e[i].length;t++)this.highlightArrays[i].push(e[i][t]);else if("remove"==t){var n;for(const s in e)for(let t=0;t<e[s].length;t++)0<=(n=this.highlightArrays[s].indexOf(e[s][t]))&&this.highlightArrays[s].splice(n,1)}if("addFreeze"==t)for(const o in e)for(let t=0;t<e[o].length;t++)this.highlightFreezeArrays[o].push(e[o][t]);else if("removeFreeze"==t){var r;for(const a in e)for(let t=0;t<e[a].length;t++)0<=(r=this.highlightFreezeArrays[a].indexOf(e[a][t]))&&this.highlightFreezeArrays[a].splice(r,1)}}else console.error("[DynamicGraph] highlight: idCompound not set!")}selection(t,e,n){null==n&&(n=this.currentSelection_id);const r=this.getSelection(n);if(r)if("set"==t){const i=new ia;i[r.acceptedType+"s"]=r.elementIds,this.selection("remove",i,n),this.selection("add",e,n)}else"add"==t?(e.linkIds.forEach(t=>this.addToSelectionByTypeAndId(r,"link",t)),e.nodeIds.forEach(t=>this.addToSelectionByTypeAndId(r,"node",t)),e.timeIds.forEach(t=>this.addToSelectionByTypeAndId(r,"time",t)),e.nodePairIds.forEach(t=>this.addToSelectionByTypeAndId(r,"nodePair",t))):"remove"==t&&(e.linkIds.forEach(t=>this.removeFromSelectionByTypeAndId(r,"link",t)),e.nodeIds.forEach(t=>this.removeFromSelectionByTypeAndId(r,"node",t)),e.timeIds.forEach(t=>this.removeFromSelectionByTypeAndId(r,"time",t)),e.nodePairIds.forEach(t=>this.removeFromSelectionByTypeAndId(r,"nodePair",t)));else console.error("[DynamicGraph] Selection with ",n,"not found in ",this.selections)}addToAttributeArraysSelection(e,n,r){var i=this.attributeArrays[n].selections[r];for(let t=0;t<i.length;t++)if(i[t].priority>e.priority)return void this.attributeArrays[n].selections[r].splice(t,0,e);this.attributeArrays[n].selections[r].push(e)}removeFromAttributeArraysSelection(e,n,r){var i=this.attributeArrays[n].selections[r];for(let t=0;t<i.length;t++)i[t]==e&&this.attributeArrays[n].selections[r].splice(t,1)}addElementToSelection(t,e){this.addToSelectionByTypeAndId(t,e.type,e.id())}addToSelectionByTypeAndId(e,n,r){if(n==e.acceptedType){e.elementIds.push(r),this.addToAttributeArraysSelection(e,n,r);let t;"node"==n?(t=this.defaultNodeSelection.elementIds.indexOf(r),-1<t&&(this.removeFromAttributeArraysSelection(this.defaultNodeSelection,n,r),this.defaultNodeSelection.elementIds.splice(t,1))):"link"==n&&(t=this.defaultLinkSelection.elementIds.indexOf(r),-1<t&&(this.removeFromAttributeArraysSelection(this.defaultLinkSelection,n,r),this.defaultLinkSelection.elementIds.splice(t,1)))}else console.log("attempting to put object of the wrong type into a selection. "+n+" !="+e.acceptedType)}removeElementFromSelection(t,e){this.removeFromSelectionByTypeAndId(t,e.type,e.id())}removeFromSelectionByTypeAndId(t,e,n){var r=t.elementIds.indexOf(n);-1!=r&&(t.elementIds.splice(r,1),this.removeFromAttributeArraysSelection(t,e,n),0==this.getSelectionsByTypeAndId(e,n).length&&("node"==e?(this.defaultNodeSelection.elementIds.push(n),this.addToAttributeArraysSelection(this.defaultNodeSelection,e,n)):"link"==e&&(this.defaultLinkSelection.elementIds.push(n),this.addToAttributeArraysSelection(this.defaultLinkSelection,e,n))))}getSelectionsByTypeAndId(t,e){return this.attributeArrays[t].selections[e]}filterSelection(t,e){const n=this.getSelection(t);null!=n&&(n.filter=e)}isFiltered(t,e){return this.attributeArrays[e+"s"].filter}isHighlighted(t,e){return-1<this.highlightArrays[e+"Ids"].indexOf(t)||-1<this.highlightFreezeArrays[e+"Ids"].indexOf(t)}isFrozen(t,e){return-1<this.highlightFreezeArrays[e+"Ids"].indexOf(t)}getHighlightedIds(t){return this.highlightArrays[t+"Ids"]}setCurrentSelection(t){console.log("[DynamicGraph] setCurrentSelectionId ",t),this.currentSelection_id=t}getCurrentSelection(){return this.getSelection(this.currentSelection_id)}addSelection(t,e,n,r){const i=this.createSelection(n);i.id=t,i.color=e,i.priority=r}createSelection(t){const e=new ko(this.selections.length,t);return e.color=this.BOOKMARK_COLORS(this.selectionColor_pointer%10),this.selectionColor_pointer++,this.selections.push(e),e}deleteSelection(t){const e=this.getSelection(t);if(null!=e){const n=new ia;n[e.acceptedType+"Ids"]=e.elementIds.slice(0),console.log("Delete selection->remove elemeents",e.elementIds.slice(0)),this.selection("remove",n,e.id),this.selections.splice(this.selections.indexOf(e),1)}}setSelectionColor(t,e){const n=this.getSelection(t);n&&(n.color=e)}getSelections(e){const n=[];if(e){for(let t=0;t<this.selections.length;t++)this.selections[t].acceptsType(e)&&n.push(this.selections[t]);return n}return this.selections}getSelection(e){for(let t=0;t<this.selections.length;t++)if(e==this.selections[t].id)return this.selections[t];console.error("[DynamicGraph] No selection with id ",e,"found!")}clearSelections(){this.selections=[]}getTimeIdForUnixTime(t){let e;for(console.log("unixTime: "),console.log(t),e=0;e<this.timeArrays.length;e++)if(t==this.timeArrays.unixTime[e])return e;console.error("Time object for unix time",t,"not found!")}addNodeOrdering(e,t){for(let t=0;t<this.nodeOrders.length;t++)if(this.nodeOrders[t].name==e)return void console.error("Ordering",e,"already exists");t=new Ro(e,t);this.nodeOrders.push(t)}setNodeOrdering(e,n){for(let t=0;t<this.nodeOrders.length;t++)if(this.nodeOrders[t].name==e)return void(this.nodeOrders[t].order=n);console.error("Ordering",e,"does not exist")}removeNodeOrdering(e,t){for(let t=0;t<this.nodeOrders.length;t++)this.nodeOrders[t].name==e&&this.nodeOrders.splice(t,1)}getNodeOrder(e){for(let t=0;t<this.nodeOrders.length;t++)if(this.nodeOrders[t].name==e)return this.nodeOrders[t];console.error("Ordering",e,"not found!")}nodes(){return new ta(this.nodeArrays.id,this)}links(){return new na(this.linkArrays.id,this)}times(){return new Go(this.timeArrays.id,this)}locations(){return new Xo(this.locationArrays.id,this)}nodePairs(){return new Zo(this.nodePairArrays.id,this)}linksBetween(t,e){let n=this.matrix[t.id()][e.id()];if(null==n&&(n=this.matrix[e.id()][t.id()]),null==n)return new na([],this);const r=this.nodePair(n);return null!=r?new na(r.links().toArray(),this):new na([],this)}get(t,e){return-1<t.indexOf("nodePair")?this.nodePair(e):-1<t.indexOf("node")?this.node(e):-1<t.indexOf("link")?this.link(e):-1<t.indexOf("time")?this.time(e):-1<t.indexOf("locations")?this.location(e):void 0}getAll(t){return"nodes"==t?this.nodes():"links"==t?this.links():"times"==t?this.times():"nodePairs"==t?this.nodePairs():this.locations()}node(e){for(let t=0;t<this._nodes.length;t++)if(this._nodes[t].id()==e)return this._nodes[t]}link(e){for(let t=0;t<this._links.length;t++)if(this._links[t].id()==e)return this._links[t]}time(e){for(let t=0;t<this._times.length;t++)if(this._times[t].id()==e)return this._times[t]}location(e){for(let t=0;t<this._locations.length;t++)if(this._locations[t].id()==e)return this._locations[t]}nodePair(e){for(let t=0;t<this._nodePairs.length;t++)if(this._nodePairs[t].id()==e)return this._nodePairs[t]}getMinGranularity(){return this.gran_min}getMaxGranularity(){return this.gran_max}}class Co{constructor(){this.id=[]}get length(){return this.id.length}}class Po extends Co{constructor(){super(...arguments),this.id=[],this.label=[],this.outLinks=[],this.inLinks=[],this.links=[],this.outNeighbors=[],this.inNeighbors=[],this.neighbors=[],this.selections=[],this.attributes=[],this.locations=[],this.filter=[],this.nodeType=[],this.color=[],this.shape=[]}}class Do extends Co{constructor(){super(...arguments),this.source=[],this.target=[],this.linkType=[],this.directed=[],this.nodePair=[],this.presence=[],this.weights=[],this.selections=[],this.filter=[],this.attributes=new Object}}class Io extends Co{constructor(){super(...arguments),this.source=[],this.target=[],this.links=[],this.selections=[],this.filter=[]}}class Fo extends Co{constructor(){super(...arguments),this.id=[],this.momentTime=[],this.label=[],this.unixTime=[],this.selections=[],this.filter=[],this.links=[]}}class Lo extends Co{constructor(){super(...arguments),this.name=[],this.count=[],this.color=[],this.filter=[]}}class Uo extends Co{constructor(){super(...arguments),this.name=[],this.count=[],this.color=[],this.filter=[]}}class qo extends Co{constructor(){super(...arguments),this.id=[],this.label=[],this.longitude=[],this.latitude=[],this.x=[],this.y=[],this.z=[],this.radius=[]}}class Ro{constructor(t,e){this.order=[],this.name=t,this.order=e}}class jo{constructor(e){if(this._elements=[],e)for(let t=0;t<e.length;t++)null!=e[t]&&this._elements.push(e[t])}addUnique(t){-1==this._elements.indexOf(t)&&this._elements.push(t)}add(t){this._elements.push(t)}addAll(e){for(let t=0;t<e.length;t++)null!=e[t]&&this._elements.push(e[t])}addAllUnique(e){for(let t=0;t<e.length;t++)this.addUnique(e[t])}get length(){return this._elements.length}size(){return this._elements.length}ids(){return this._elements}removeDuplicates(){var e=this._elements.slice(0);this._elements=[];for(let t=0;t<e.length;t++)-1==this._elements.indexOf(e[t])&&this._elements.push(e[t]);return this}generic_intersection(n){const r=[];for(let e=0;e<this._elements.length;e++)for(let t=0;t<n._elements.length;t++)this._elements[e]==n._elements[t]&&r.push(this._elements[e]);return new jo(r)}}class Ho extends jo{constructor(t,e,n){super(t),this.g=e,this.elementType=n}generic_filter(e){const n=[];for(let t=0;t<this._elements.length;t++)try{e(this.g.get(this.elementType,this._elements[t]))&&n.push(this._elements[t])}catch(t){}return n}generic_selected(){const e=[];for(let t=0;t<this._elements.length;t++){const n=this.g.get(this.elementType,this._elements[t]);null!=n&&n.isSelected()&&e.push(this._elements[t])}return e}generic_visible(){const e=[];for(let t=0;t<this._elements.length;t++){const n=this.g.get(this.elementType,this._elements[t]);null!=n&&n.isVisible()&&e.push(this._elements[t])}return e}generic_highlighted(){const e=[];for(let t=0;t<this._elements.length;t++){const n=this.g.get(this.elementType,this._elements[t]);null!=n&&n.isHighlighted()&&e.push(this._elements[t])}return e}generic_presentIn(e,n){const r=[];for(let t=0;t<this._elements.length;t++){const i=this.g.get(this.elementType,this._elements[t]);null!=i&&i.presentIn(e,n)&&r.push(this._elements[t])}return r}generic_sort(n,r){if(0==this._elements.length)return this;const t=this._elements.slice(0);return t.sort((t,e)=>{t=this.g.get(this.elementType,t),e=this.g.get(this.elementType,e);return null!=t&&null!=e?function(t,e,n,r){var i=t.attr(n);let s;s="string"==typeof i?t.attr(n).localeCompare(e.attr(n)):"number"==typeof i?e.attr(n)-t.attr(n):0;0==r&&(s=-s);return s}(t,e,n,r):null==t&&null==e?0:null==t?1:-1}),this._elements=t,this}generic_removeDuplicates(){const e=[];for(let t=0;t<this._elements.length;t++)-1==e.indexOf(this._elements[t])&&e.push(this._elements[t]);return this._elements=e,this}}class Yo{constructor(t,e,n){this._id=t,this.type=e,this.g=n}id(){return this._id}attr(t){return this.g.attr(t,this._id,this.type)}getSelections(){return this.g.attributeArrays[this.type].selections[this._id]}addToSelection(t){this.g.attributeArrays[this.type].selections[this._id].push(t)}removeFromSelection(e){var n=this.g.attributeArrays[this.type].selections[this._id];for(let t=0;t<n.length;t++)n[t]==e&&this.g.attributeArrays[this.type].selections[this._id].splice(t,1)}inSelection(t){return-1<this.getSelections().indexOf(t)}isSelected(e){if(!e)return 0<this.getSelections().length;var n=this.g.attributeArrays[this.type].selections[this._id];for(let t=0;t<n.length;t++)if(n[t]!=this.g.defaultNodeSelection&&n[t]!=this.g.defaultLinkSelection&&n[t]==e)return!0;return!1}isHighlighted(){return this.g.isHighlighted(this._id,this.type)}isFrozen(){return this.g.isFrozen(this._id,this.type)}isFiltered(){return this.g.isFiltered(this._id,this.type)}isVisible(){var e=this.getSelections();if(0==e.length)return!0;for(let t=0;t<e.length;t++)if(e[t].filter)return!1;return!0}presentIn(e,n){const r=this.attr("presence");n=n||e;for(let t=e._id;t<=n._id;t++)if(-1<r.indexOf(t))return!0;return!1}}class zo{constructor(){this.serie={}}period(t,e){var n=t.id(),r=e.id();const i=new zo;for(const s in this.serie)parseInt(s)>=n&&parseInt(s)<=r&&(i.serie[s]=this.serie[s]);return i}set(t,e){this.serie[t.id()]=e}get(t){if(null!=this.serie[t.id()])return this.serie[t.id()]}size(){return this.toArray().length}getSerie(){return this.serie}toArray(t){const e=[];if(t=null==t?!1:t)for(const n in this.serie)e.push(this.serie[n]);else for(const r in this.serie)-1==e.indexOf(this.serie[r])&&e.push(this.serie[r]);return e}}class Bo{constructor(){this.serie={}}period(t,e){var n=t.id();t.id();const r=new Bo;for(const i in this.serie)parseInt(i)>=n&&parseInt(i)<=n&&(r.serie[i]=this.serie[i]);return r}add(t,e){null!=t&&(this.serie[t._id]||(this.serie[t._id]=[]),this.serie[t._id].push(e))}get(t){return this.serie[t._id]}toArray(){const t=[];for(const e in this.serie)t.push(this.serie[e]);return t}toFlatArray(e){null==e&&(e=!1);const n=[];for(const r in this.serie)for(let t=0;t<this.serie[r].length;t++)e&&-1!=n.indexOf(this.serie[r])||n.push(this.serie[r][t]);return n}}class Go extends Ho{constructor(e,t){if(super(e,t,"time"),0<e.length&&e[0]instanceof Wo){this._elements=[];for(let t=0;t<e.length;t++)this._elements.push(e[t].id())}if(0<e.length&&"number"==typeof e[0]){this._elements=[];for(let t=0;t<e.length;t++)this._elements.push(e[t])}}contains(t){return-1<this._elements.indexOf(t.id())}highlighted(){return new Go(super.generic_highlighted(),this.g)}visible(){return new Go(super.generic_visible(),this.g)}selected(){return new Go(super.generic_selected(),this.g)}filter(t){return new Go(super.generic_filter(t),this.g)}presentIn(t,e){return new Go(super.generic_presentIn(t,e),this.g)}sort(t){return super.generic_sort(t)}links(){let e=[];for(let t=0;t<this._elements.length;t++)e=e.concat(this.g.attr("links",this._elements[t],"time"));return new na(e,this.g)}get(t){return this.g._times[this._elements[t]]}last(){return this.g._times[this._elements[this._elements.length-1]]}toArray(){const e=[];var n=this.g._times;for(let t=0;t<this._elements.length;t++)e.push(n[this._elements[t]]);return e}createAttribute(e,n){if(null==this.g.timeArrays[e]){this.g.timeArrays[e]=[];for(let t=0;t<this.g._times.length;t++)this.g.timeArrays[e].push()}for(let t=0;t<this._elements.length;t++)this.g.timeArrays[e][this._elements[t]]=n(this.g._times[this._elements[t]]);return this}unixTimes(){const e=[];for(let t=0;t<this._elements.length;t++){const n=this.g.time(this._elements[t]);null!=n&&e.push(n.unixTime())}return e}intersection(t){return new Go(this.generic_intersection(t)._elements,this.g)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this.g.time(this._elements[t]),t);return this}}class Wo extends Yo{constructor(t,e){super(t,"time",e),this.getWeek=Ao("%V")}time(){return this.attr("momentTime")}moment(){return this.attr("momentTime")}label(){return this.attr("label")}unixTime(){return this.attr("unixTime")}links(){return new na(this.attr("links"),this.g)}year(){return this.time().getUTCFullYear()}month(){return this.time().getUTCMonth()}week(){return parseInt(this.getWeek(this.time()))}day(){return this.time().getUTCDay()}hour(){return this.time().getUTCHours()}minute(){return this.time().getUTCMinutes()}second(){return this.time().getUTCSeconds()}millisecond(){return this.time().getMilliseconds()}format(t){const e=Ao(t);return e(this.time())}}class Xo extends Ho{constructor(e,t){if(super(e,t,"location"),0<e.length&&e[0]instanceof $o){this._elements=[];for(let t=0;t<e.length;t++)this._elements=e[t].id()}if(0<e.length&&"number"==typeof e[0]){this._elements=[];for(let t=0;t<e.length;t++)this._elements.push(e[t])}}contains(t){return-1<this._elements.indexOf(t.id())}highlighted(){return new Xo(super.generic_highlighted(),this.g)}visible(){return new Xo(super.generic_visible(),this.g)}selected(){return new Xo(super.generic_selected(),this.g)}filter(t){return new Xo(super.generic_filter(t),this.g)}presentIn(t,e){return new Xo(super.generic_presentIn(t,e),this.g)}sort(t){return super.generic_sort(t)}get(t){return this.g._locations[this._elements[t]]}last(){return this.g._locations[this._elements[this._elements.length-1]]}toArray(){const e=[];for(let t=0;t<this._elements.length;t++)e.push(this.g._locations[this._elements[t]]);return e}createAttribute(e,n){if(null==this.g.locationArrays[e]){this.g.locationArrays[e]=[];for(let t=0;t<this.g._locations.length;t++)this.g.locationArrays[e].push()}for(let t=0;t<this._elements.length;t++)this.g.locationArrays[e][this._elements[t]]=n(this.g._locations[this._elements[t]]);return this}intersection(t){return new Xo(this.generic_intersection(t)._elements,this.g)}removeDuplicates(){return new Xo(this.generic_removeDuplicates()._elements,this.g)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this.g.location(this._elements[t]),t);return this}}class Vo extends jo{clone(){return this._elements.slice(0)}min(){this._elements=this.makeNumbers(this._elements);let e=parseInt(this._elements[0]+"");for(let t=1;t<this._elements.length;t++)null!=this._elements[t]&&(e=Math.min(e,parseInt(this._elements[t]+"")));return e}max(){let e=parseInt(this._elements[0]+"");for(let t=1;t<this._elements.length;t++)null!=this._elements[t]&&(e=Math.max(e,parseInt(this._elements[t]+"")));return e}mean(){this._elements=this.makeNumbers(this._elements);let e=0,n=0;for(let t=0;t<this._elements.length;t++)"number"==typeof this._elements[t]&&(e+=parseInt(this._elements[t]+""),n++);return e/n}sum(){let e=0;for(let t=0;t<this._elements.length;t++)"number"==typeof this._elements[t]&&(e+=parseInt(this._elements[t]+""));return e}toArray(){return this._elements.slice(0)}get(t){return this._elements[t]}forEach(e){for(let t=0;t<this._elements.length;t++)e(this._elements[t],t);return this}makeNumbers(e){if(e&&0<e.length&&"string"==typeof e[0]){const n=[];for(let t=0;t<e.length;t++)n.push(parseFloat(e[t]+""));return console.log("string array converted",n),n}return e}}class $o extends Yo{constructor(t,e){super(t,"location",e)}label(){return this.attr("label")+""}longitude(){return this.attr("longitude")}latitude(){return this.attr("latitude")}x(){return this.attr("x")}y(){return this.attr("y")}z(){return this.attr("z")}radius(){return this.attr("radius")}}class Zo extends Ho{constructor(e,t){if(super(e,t,"nodePair"),0<e.length&&e[0]instanceof Qo){this._elements=[];for(let t=0;t<e.length;t++)this._elements.push(e[t].id())}if(0<e.length&&"number"==typeof e[0]){this._elements=[];for(let t=0;t<e.length;t++)this._elements.push(e[t])}}contains(t){return-1<this._elements.indexOf(t.id())}highlighted(){return new Zo(super.generic_highlighted(),this.g)}visible(){return new Zo(super.generic_visible(),this.g)}selected(){return new Zo(super.generic_selected(),this.g)}filter(t){return new Zo(super.generic_filter(t),this.g)}presentIn(t,e){return new Zo(super.generic_presentIn(t,e),this.g)}sort(t){return super.generic_sort(t)}get(t){return this.g._nodePairs[this._elements[t]]}last(){return this.g._links[this._elements[this._elements.length-1]]}toArray(){const e=[];for(let t=0;t<this._elements.length;t++)e.push(this.g._nodePairs[this._elements[t]]);return e}createAttribute(e,n){if(null==this.g.nodePairArrays[e]){this.g.nodePairArrays[e]=[];for(let t=0;t<this.g._nodePairs.length;t++)this.g.nodePairArrays[e].push()}for(let t=0;t<this._elements.length;t++)this.g.nodePairArrays[e][this._elements[t]]=n(this.g._nodePairs[this._elements[t]]);return this}intersection(t){return new Zo(this.generic_intersection(t)._elements,this.g)}removeDuplicates(){return new Zo(this.generic_removeDuplicates()._elements,this.g)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this.g.nodePair(this._elements[t]),t);return this}}class Qo extends Yo{constructor(t,e){super(t,"nodePair",e)}get source(){return this.g._nodes[this.attr("source")]}get target(){return this.g._nodes[this.attr("target")]}links(){return new na(this.attr("links"),this.g)}nodeType(){return this.attr("nodeType")}presentIn(e,n){for(let t=0;t<this.links.length;t++)if(this.links[t].presentIn(e,n))return!0;return!1}}class Jo{constructor(t){this._elements=t?t.slice(0):[]}contains(t){return-1<this._elements.indexOf(t)}addUnique(t){-1==this._elements.indexOf(t)&&this._elements.push(t)}add(t){this._elements.push(t)}addAll(e){for(let t=0;t<e.length;t++)null!=e[t]&&this._elements.push(e[t])}addAllUnique(e){for(let t=0;t<e.length;t++)this.addUnique(e[t])}get length(){return this._elements.length}size(){return this._elements.length}toArray(){return this._elements.slice(0)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this._elements[t],t);return this}}function Ko(e,n,r,i,s,o){let a=[],l;for(let t=0;t<n.length;t++){l=null!=o&&null!=s?i.attr(e,n[t],r).period(s,o).toArray():null!=s?[i.attr(e,n[t],r).get(s)]:i.attr(e,n[t],r).toArray();for(let t=0;t<l.length;t++)l[t]instanceof Array?a=a.concat(l[t]):-1==a.indexOf(l[t])&&a.push(l[t])}return a}class ta extends Ho{constructor(e,t){if(super(e,t,"node"),0<e.length&&e[0]instanceof ea){this._elements=[];for(let t=0;t<e.length;t++)this._elements.push(e[t].id())}else if(0<e.length&&"number"==typeof e[0]){this._elements=[];for(let t=0;t<e.length;t++)this._elements.push(e[t])}}contains(t){return-1<this._elements.indexOf(t.id())}highlighted(){return new ta(super.generic_highlighted(),this.g)}visible(){return new ta(super.generic_visible(),this.g)}selected(){return new ta(super.generic_selected(),this.g)}filter(t){return new ta(super.generic_filter(t),this.g)}presentIn(t,e){return new ta(super.generic_presentIn(t,e),this.g)}sort(t,e){return super.generic_sort(t,e)}label(){const e=new Jo;for(let t=0;t<this._elements.length;t++)e.add(""+this.g.attr("label",this._elements[t],"node"));return e}neighbors(t,e){return new ta(Ko("neighbors",this._elements,"node",this.g,t,e),this.g)}links(t,e){return new na(Ko("links",this._elements,"node",this.g,t,e),this.g)}locations(t,e){return new Xo(Ko("locations",this._elements,"node",this.g,t,e),this.g)}nodeTypes(){const e=new Jo;for(let t=0;t<this._elements.length;t++)e.add(this.g.attr("nodeType",this._elements[t],"node"));return e}get(t){return this.g._nodes[this._elements[t]]}last(){return this.g._nodes[this._elements[this._elements.length-1]]}toArray(){const e=[];for(let t=0;t<this._elements.length;t++)e.push(this.g._nodes[this._elements[t]]);return e}createAttribute(e,n){if(null==this.g.nodeArrays[e]){this.g.nodeArrays[e]=[];for(let t=0;t<this.g._nodes.length;t++)this.g.nodeArrays[e].push()}for(let t=0;t<this._elements.length;t++)this.g.nodeArrays[e][this._elements[t]]=n(this.g._nodes[this._elements[t]]);return this}intersection(t){return new ta(this.generic_intersection(t)._elements,this.g)}removeDuplicates(){return new ta(this.generic_removeDuplicates()._elements,this.g)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this.g.node(this._elements[t]),t);return this}}class ea extends Yo{constructor(t,e){super(t,"node",e)}label(){return""+this.attr("label")}shape(){return""+this.attr("shape")}color(){return""+this.attr("color")}nodeType(){return this.attr("nodeType")}neighbors(t,e){return null!=e&&null!=t?new ta(this.attr("neighbors").period(t,e).toFlatArray(!0),this.g):null!=t?new ta(this.attr("neighbors").get(t),this.g):new ta(this.attr("neighbors").toFlatArray(),this.g)}inNeighbors(t,e){return null!=e&&null!=t?new ta(this.attr("inNeighbors").period(t,e).toFlatArray(!0),this.g):null!=t?new ta(this.attr("inNeighbors").get(t),this.g):new ta(this.attr("inNeighbors").toFlatArray(!0),this.g)}outNeighbors(t,e){return null!=e&&null!=t?new ta(this.attr("outNeighbors").period(t,e).toFlatArray(!0),this.g):null!=t?new ta(this.attr("outNeighbors").get(t),this.g):new ta(this.attr("outNeighbors").toFlatArray(),this.g)}links(t,e){return null!=e&&null!=t?new na(this.attr("links").period(t,e).toFlatArray(!0),this.g):null!=t?new na(this.attr("links").get(t),this.g):new na(this.attr("links").toFlatArray(!0),this.g)}inLinks(t,e){return null!=e&&null!=t?new na(this.attr("inLinks").period(t,e).toFlatArray(!0),this.g):null!=t?new na(this.attr("inLinks").get(t),this.g):new na(this.attr("inLinks").toFlatArray(!0),this.g)}outLinks(t,e){return null!=e&&null!=t?new na(this.attr("outLinks").period(t,e).toFlatArray(!0),this.g):null!=t?new na(this.attr("outLinks").get(t),this.g):new na(this.attr("outLinks").toFlatArray(!0),this.g)}locations(t,e){return null!=e&&null!=t?new Xo(this.attr("locations").period(t,e).toArray(),this.g):null!=t?new Xo([this.attr("locations").get(t)],this.g):new Xo(this.attr("locations").toArray(),this.g)}locationSerie(t,e){let n;n=null!=e&&null!=t?this.attr("locations").period(t,e):null!=t?this.attr("locations").get(t):this.attr("locations");var r=n.getSerie();const i=new zo;for(const a in r){var s=this.g.time(parseInt(a)),o=this.g.location(r[a]);null!=s&&null!=o&&i.set(s,o)}return i}linksBetween(e){var n,r=this.links().toArray();const i=[];for(let t=0;t<r.length;t++)(n=r[t]).source!=e&&n.target!=e||i.push(n);return new na(i,this.g)}}class na extends Ho{constructor(e,t){if(super(e,t,"link"),0<e.length&&e[0]instanceof ra){this._elements=[];for(let t=0;t<e.length;t++)this._elements.push(e[t].id())}if(0<e.length&&"number"==typeof e[0]){this._elements=[];for(let t=0;t<e.length;t++)this._elements.push(e[t])}}contains(t){return-1<this._elements.indexOf(t.id())}highlighted(){return new na(super.generic_highlighted(),this.g)}visible(){return new na(super.generic_visible(),this.g)}selected(){return new na(super.generic_selected(),this.g)}filter(t){return new na(super.generic_filter(t),this.g)}presentIn(t,e){return new na(super.generic_presentIn(t,e),this.g)}sort(t){return super.generic_sort(t)}get(t){return this.g._links[this._elements[t]]}last(){return this.g._links[this._elements[this._elements.length-1]]}toArray(){const e=[];for(let t=0;t<this._elements.length;t++)e.push(this.g._links[this._elements[t]]);return e}weights(e,n){const r=new Vo;for(let t=0;t<this._elements.length;t++){const i=this.g.link(t);null!=i&&r.addAll(i.weights(e,n).toArray())}return r}createAttribute(e,n){if(null==this.g.linkArrays[e]){this.g.linkArrays[e]=[];for(let t=0;t<this.g._links.length;t++)this.g.linkArrays[e].push()}for(let t=0;t<this._elements.length;t++)this.g.linkArrays[e][this._elements[t]]=n(this.g._links[this._elements[t]]);return this}linkTypes(){const e=[];var n;for(let t=0;t<this._elements.length;t++){const r=this.g.link(this._elements[t]);null!=r&&(n=r.linkType(),-1==e.indexOf(n)&&e.push(n))}return e}sources(){const e=[];let n;for(let t=0;t<this._elements.length;t++)n=this.g.link(this._elements[t]),null!=n&&-1==e.indexOf(n.source.id())&&e.push(n.source.id());return new ta(e,this.g)}targets(){const e=[];let n;for(let t=0;t<this._elements.length;t++)n=this.g.link(this._elements[t]),null!=n&&-1==e.indexOf(n.target.id())&&e.push(n.target.id());return new ta(e,this.g)}intersection(t){return new na(this.generic_intersection(t)._elements,this.g)}removeDuplicates(){return new na(this.generic_removeDuplicates()._elements,this.g)}forEach(e){for(let t=0;t<this._elements.length;t++)e(this.g.link(this._elements[t]),t);return this}}class ra extends Yo{constructor(t,e){super(t,"link",e),this.targetNPO=void 0,this.sourceNPO=void 0}linkType(){return this.attr("linkType")}get source(){return this.g._nodes[this.attr("source")]}get target(){return this.g._nodes[this.attr("target")]}nodePair(){return this.g._nodePairs[this.attr("nodePair")]}directed(){return this.attr("directed")}other(t){return this.source==t?this.target:this.source}weights(t,e){return null==t?new Vo(this.attr("weights").toArray()):null==e?new Vo([this.attr("weights").get(t)]):new Vo(this.attr("weights").period(t,e).toArray())}presentIn(t,e){return 0<this.weights(t,e).toArray().length}times(){return new Go(this.attr("presence"),this.g)}}class ia{constructor(){this.nodeIds=[],this.linkIds=[],this.timeIds=[],this.nodePairIds=[],this.locationIds=[]}}function sa(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function oa(t,e){const n=[];for(const r in t)n.push(function(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n))for(const r in t[n])Object.prototype.hasOwnProperty.call(t[n],r)&&(e[n][r]=t[n][r]);return e}(t[r],e()));return n}function aa(t,e,n){let r=!0;if(null==t||null==e)return t==e;if(typeof t==typeof e){if("object"!=typeof t)return 1;if(t.constructor===e.constructor){if(0<n)for(const i in t)i in e&&Object.prototype.hasOwnProperty.call(t,i)&&Object.prototype.hasOwnProperty.call(e,i)&&!aa(t[i],e[i],n-1)&&(console.log("compareFailed for key",i,t[i],e[i]),r=!1);return r}}}function la(t,e){return t-e}function ha(t,e){const n=new ua;return null!=t&&(t.nodeIds&&(n.nodes=t.nodeIds.map(t=>e.node(t))),t.linkIds&&(n.links=t.linkIds.map(t=>e.link(t))),t.timeIds&&(n.times=t.timeIds.map(t=>e.time(t))),t.nodePairIds&&(n.nodePairs=t.nodePairIds.map(t=>e.nodePair(t)))),n}class ua{constructor(){this.nodes=[],this.links=[],this.times=[],this.nodePairs=[],this.locations=[]}}function ca(t,e){return t.priority-e.priority}var fa=n(12);let da;"undefined"!=typeof window&&(window.dataManager||(window.dataManager=new class{constructor(t){this.keepOnlyOneSession=!1,this.session="",this.sessionDataPrefix="ncubesession",this.SEP="_",t?t.keepOnlyOneSession&&this.setOptions(t):this.keepOnlyOneSession=!1}setOptions(t){this.keepOnlyOneSession=t.keepOnlyOneSession}clearSessionData(t){var e=this.sessionDataPrefix+this.SEP+t;const n=[];for(let t=0;t<localStorage.length;t++){const i=localStorage.key(t);!i||0!=i.indexOf(e)&&0!=i.indexOf("connectoscope1")||n.push(i)}for(let t=0;t<n.length;t++){var r=n[t];localStorage.removeItem(r)}}clearAllSessionData(){this.clearSessionData("")}isSessionCached(t,e){var n=this.sessionDataPrefix+this.SEP+t+this.SEP+e;for(let t=0;t<localStorage.length;t++){const r=localStorage.key(t);if(r&&0==r.indexOf(n))return!0}return!1}importData(t,n){if(this.session=t,n.nodeTable||n.linkTable){n.nodeTable||console.log("[n3] Node table missing!"),n.linkTable||console.log("[n3] Link table missing!"),n.nodeSchema||console.log("[n3] Node schema missing!"),n.linkSchema||console.log("[n3] Link schema missing!");for(let e=0;e<n.nodeTable.length;e++)for(let t=0;t<n.nodeTable[e].length;t++)"string"==typeof n.nodeTable[e][t]&&(n.nodeTable[e][t]=n.nodeTable[e][t].trim());for(let e=0;e<n.linkTable.length;e++)for(let t=0;t<n.linkTable[e].length;t++)"string"==typeof n.linkTable[e][t]&&(n.linkTable[e][t]=n.linkTable[e][t].trim());if(this.isSchemaWellDefined(n)){console.log("data is well-schematized, caching dynamicGraph"),this.keepOnlyOneSession&&this.clearAllSessionData();const e=new Oo;e.initDynamicGraph(n),e.saveDynamicGraph(this)}else console.log("data is not well-schematized, so not caching dynamicGraph")}else console.log("Empty tables. No data imported.")}saveToStorage(e,n,r,i){if(null!=r){i=JSON.stringify(r,i);let t;t=4194304<i.length?fa.compress(i):i,localStorage[this.sessionDataPrefix+this.SEP+this.session+this.SEP+e+this.SEP+n]=t}else console.log("attempting to save undefined value. aborting",e,n)}getFromStorage(t,e,n,r){console.assert(""!=this.session);let i;i=n?function(t,e){return n(t,e,r)}:void 0;e=localStorage[this.sessionDataPrefix+this.SEP+this.session+this.SEP+t+this.SEP+e];if(e&&"undefined"!=e){let t;return t="true"==e||"false"!=e&&(0<="\"'[{0123456789".indexOf(e[0])?e:fa.decompress(e)),JSON.parse(t,i)}}removeFromStorage(t,e){localStorage.removeItem(this.sessionDataPrefix+this.SEP+this.session+this.SEP+t+this.SEP+e)}getGraph(t,e){return this.session=t,this.dynamicGraph&&this.dynamicGraph.name==e||(this.dynamicGraph=new Oo,this.dynamicGraph.loadDynamicGraph(this,e)),this.dynamicGraph}isSchemaWellDefined(t){return console.log("isSchemaWellDefined"),!(t.locationTable&&!xo(t.locationSchema.id))&&(!(0<t.nodeTable.length&&!xo(t.nodeSchema.id))&&!(0<t.linkTable.length&&!(xo(t.linkSchema.id)&&xo(t.linkSchema.source)&&xo(t.linkSchema.target))))}}),da=window.dataManager);let ga;function pa(t,e){var n=function(){const e={},t=window.location.search.replace("?","").split("&");let n,r;return t.forEach(function(t){n=t.split("="),r=decodeURIComponent(n[1]),e[n[0]]=r}),e}();return t=t||n.datasetName,ga=e||n.session,da.getGraph(ga,t)}const ma=13,ya=0,_a=13,va=3,wa=window.innerWidth,Aa=pa(),ba=window.vc.messenger;function xa(t,e){const n=J("body").append("div").attr("id","div_"+e);n.append("p").attr("id","title_"+e).html(t+":"),n.append("input").datum(e).attr("type","button").attr("value","+").attr("onclick","trace.event('vis_13',document.location.pathname,'add ' ,'"+e+"')").on("click",function(t,e){Ta(e)})}function ka(t,e){const n=J("body").append("div").attr("id","divViewOnly_"+e);n.append("p").attr("id","titleViewOnly_"+e).html(t+":")}function Sa(t,e){let n=[],r,i;if("nodeColor"==t){const o=Aa.nodeArrays.color.filter(function(t){if(void 0!==t&&t&&n.indexOf(t.toString())<0)return n.push(t.toString()),t});n=[],r=o.filter(function(t){if(null!=t[0])return t})}if("nodeShape"==t){n=[];const a=Aa.nodeArrays.shape.filter(function(t){if(void 0!==t&&t&&n.indexOf(t.toString())<0)return n.push(t.toString()),t});n=[],i=a.filter(function(t){if(null!=t[0])return t})}J("#divViewOnly_"+t).selectAll(".selectionDiv_"+t).remove();const s=J("#divViewOnly_"+t).selectAll(".selectionDiv_"+t).data(function(){return"nodeColor"==t?r:"nodeShape"==t?i:[]}).enter().append("div").attr("class","selectionDiv_"+t).attr("height",_a).append("svg").attr("class","svg_"+t).attr("height",_a).attr("width",wa).append("g").attr("transform","translate("+ya+",0)");Fe(".selectionDiv_"+t).style("background-color",function(t){return t&&Aa.currentSelection_id==t.id?"#cccccc":"#ffffff"}),"nodeColor"==t&&s.append("rect").attr("x",0).attr("y",0).attr("width",ma).attr("height",ma).style("fill",function(t){return t[1]}).on("click",function(t,e){ba.setSelectionColor(e,"#"+Math.floor(16777215*Math.random()).toString(16))}),"nodeShape"==t&&s.append("path").attr("transform",function(){return"translate(7,7)"}).attr("d",t=>hn().size(40).type(Da(t))()).style("fill","black"),s.append("text").attr("class","selectionLabel").text(function(t){return t[0]}).style("font-size",ma+"px").style("font-family","Helvetica").attr("x",ma+10).attr("y",.8*ma).on("click",function(t,e){ba.setCurrentSelection(e),Ma()})}function Ta(t){const e=Aa.createSelection(t);window.setTimeout(()=>{ba.setCurrentSelection(e),Ma()},500)}function Ma(){Na("node","Node Selections"),Na("link","Link Selections"),Sa("nodeColor"),Sa("nodeShape"),Fe(".icon_showColor").attr("xlink:href",function(t){return t.showColor?"drop-full.png":"drop-empty.png"}),Fe(".icon_eye").attr("xlink:href",function(t){return t.filter?"eye-blind.png":"eye-seeing.png"}),Fe(".selectionLabel").text(function(t){return t.name+" ("+t.elementIds.length+")"})}function Na(t,e){const n=Aa.getSelections(t),r=J("#title_"+t);r.html(e+" ("+n.length+")"),J("#div_"+t).selectAll(".selectionDiv_"+t).remove();const i=J("#div_"+t).selectAll(".selectionDiv_"+t).data(n.sort(ca)).enter().append("div").attr("class","selectionDiv_"+t).attr("height",_a).append("svg").attr("class","svg_"+t).attr("height",_a).attr("width",wa).append("g").attr("transform","translate("+ya+",0)");Fe(".selectionDiv_"+t).style("background-color",function(t){return Aa.currentSelection_id==t.id?"#cccccc":"#ffffff"}),i.append("rect").attr("x",0).attr("y",0).attr("width",ma).attr("height",ma).style("fill",function(t){return t.color}).on("click",function(t,e){ba.setSelectionColor(e,"#"+Math.floor(16777215*Math.random()).toString(16))}),i.append("text").attr("class","selectionLabel").text(function(t){return t.name}).style("font-size",ma+"px").style("font-family","Helvetica").attr("x",ma+10).attr("y",.8*ma).on("click",function(t,e){ba.setCurrentSelection(e),Ma()});t=0;i.append("svg:image").attr("class","icon_showColor icon").attr("x",130+(ma+va)*t++).on("click",function(t,e){ba.showSelectionColor(e,!e.showColor)}),i.append("svg:image").attr("id","eye_"+e).attr("class","icon_eye icon").attr("xlink:href","eye-seeing.png").attr("x",130+(ma+va)*t++).attr("onclick","trace.event('vis_14',document.location.pathname,'"+e+"' , this.getAttribute('href'))").on("click",function(t,e){ba.filterSelection(e,!e.filter)}),i.append("svg:image").filter(t=>-1==t.name.indexOf("Unselected")).attr("class","icon").attr("xlink:href","up.png").attr("x",130+(ma+va)*t++).on("click",function(t,e,n){0<n&&ba.swapPriority(e,Fe(".selectionDiv_"+e.acceptedType).data()[n-1])}),i.append("svg:image").filter(t=>-1==t.name.indexOf("Unselected")).attr("class","icon").attr("xlink:href","down.png").attr("x",130+(ma+va)*+t).on("click",function(t,e,n){Fe(".selectionDiv_"+e.acceptedType).data()[n+1]&&ba.swapPriority(e,Fe(".selectionDiv_"+e.acceptedType).data()[n+1])}),i.append("svg:image").filter(t=>-1==t.name.indexOf("Unselected")).attr("class","icon").attr("xlink:href","delete.png").attr("x",130+4*(ma+va)).on("click",function(t,e){ba.deleteSelection(e)}),i.selectAll(".icon").attr("height",ma).attr("width",ma)}ba.setDefaultEventListener(Ma),ba.addEventListener("searchResult",Oa),xa("Node Selections","node"),xa("Link Selections","link"),ka("Node Colours","nodeColor"),ka("Node Shapes","nodeShape"),Ma();let Ea;function Oa(t){Ea=t;const e=document.getElementById("searchResults");if(e){e.innerHTML="";const n=document.createElement("li");if(e.appendChild(n),t.idCompound.nodeIds){const r=document.createElement("p");n.appendChild(r),r.outerHTML='<p class="searchResult">Nodes: <b>'+t.idCompound.nodeIds.length+"</b> <u onclick=\"saveSearchResultAsSelection('node')\">(Save as selection)</u></p>"}if(t.idCompound.linkIds){const i=document.createElement("p");n.appendChild(i),i.outerHTML='<p class="searchResult">Links: <b>'+t.idCompound.linkIds.length+"</b> <u onclick=\"saveSearchResultAsSelection('link')\">(Save as selection)</u></p>"}}}function Ca(t){const e=ba.createSelection(t,Ea.searchTerm),n=new ia;n[t+"Ids"]=Ea.idCompound[t+"Ids"];ha(n,Aa);window.setTimeout(()=>{ba.highlight("reset"),window.setTimeout(()=>{ba.selection("set",ha(n,Aa),e.id)},1e3)},1e3)}function Pa(){ba.highlight("reset");const t=document.getElementById("searchResults");t&&(t.innerHTML="")}function Da(t){var e={circle:We,cross:Xe,diamond:Ze,square:tn,star:Ke,triangle:nn,wye:ln},t=t[1].split(",");if(t){t=t[t.length-1];return e[t]||We}return ln}window.saveSearchResultAsSelection=Ca}},i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=98);function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}var n,r});